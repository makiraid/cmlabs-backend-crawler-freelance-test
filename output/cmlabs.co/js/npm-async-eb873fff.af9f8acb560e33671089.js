/*! For license information please see npm-async-eb873fff.af9f8acb560e33671089.js.LICENSE.txt */
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[3975],{33195:(e,t,r)=>{"use strict";r.d(t,{N:()=>u,Z:()=>l});var n=r(51722),i=r.n(n),o=r(83623),s=r.n(o);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c={LT:"h:mm A",LTS:"h:mm:ss A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY HH:mm",LLLL:"dddd MMMM D, YYYY HH:mm",l:"M/D/YYYY",ll:"MMM D, YYYY",lll:"MMM D, YYYY h:mm A",llll:"ddd MMM D, YYYY h:mm A","LL-Y":"MMMM D"};function u(e){var t=e.toLowerCase();return t.startsWith("zh-hant")?"zh-Hant":t.split("-")[0]}i().extend(s()),i().extend((function(e,t,r){var n=t.prototype,i=n.format;r.Ls.en.formats=c,n.format=function(){var e,t,r=(e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"YYYY-MM-DDTHH:mm:ssZ",t=this.$locale().formats,e.replace(/(\[[^\]]+])|(LTS?|LL\-Y|l{1,4}|L{1,4})/g,(function(e,r,n){return r||t[n]||c[n]})));return i.call(this,r)}}));const l=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,r=[{key:"format",value:function(e,t){var r=this.getDate(e);return i()(r).format(t)}},{key:"setLocale",value:function(e){i().locale(u(e))}},{key:"setLocaleConfig",value:function(e){var t={name:e.name,months:e.months,monthsShort:e.monthsShort,weekdays:e.weekdays,weekdaysMin:e.weekdaysMin,weekdaysShort:e.weekdaysShort,formats:e.longDateFormat,meridiem:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.meridiem?t<12?n?e.meridiem.am:e.meridiem.AM:n?e.meridiem.pm:e.meridiem.PM:""}};return i().locale(e.name,t),this}},{key:"getDate",value:function(e){return"number"==typeof e?new Date(e):e}}],r&&a(t.prototype,r),n&&a(t,n),e;var t,r,n}())},92356:function(e){var t;"undefined"!=typeof self&&self,t=function(){return function(e){var t={};function r(n){var i;return(t[n]||(i=t[n]={i:n,l:!1,exports:{}},e[n].call(i.exports,i,i.exports,r),i.l=!0,i)).exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=11)}([function(e,t,r){"use strict";var n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},o=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)},s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}y(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&y(e,"error",t,{once:!0})}(e,i)}))},(a.EventEmitter=a).prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function f(e,t,r,n){var i,o;return u(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener||r),i=e._events),o=i[t]),void 0===o?(o=i[t]=r,++e._eventsCount):("function"==typeof o?o=i[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),0<(i=l(e))&&o.length>i&&!o.warned&&(o.warned=!0,(n=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",n.emitter=e,n.type=t,n.count=o.length,function(e){console&&console.warn&&console.warn(e)}(n))),e}function h(e,t,r){return t=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(e={fired:!1,wrapFn:void 0,target:e,type:t,listener:r}),t.listener=r,e.wrapFn=t}function p(e,t,r){return void 0===(e=e._events)||void 0===(e=e[t])?[]:"function"==typeof e?r?[e.listener||e]:[e]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(e):m(e,e.length)}function d(e){var t=this._events;if(void 0!==t){if("function"==typeof(t=t[e]))return 1;if(void 0!==t)return t.length}return 0}function m(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function y(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,o=this._events;if(void 0!==o)n=n&&void 0===o.error;else if(!n)return!1;if(n){if((s=0<t.length?t[0]:s)instanceof Error)throw s;throw(n=new Error("Unhandled error."+(s?" ("+s.message+")":""))).context=s,n}var s=o[e];if(void 0===s)return!1;if("function"==typeof s)i(s,this,t);else{var a=s.length,c=m(s,a);for(r=0;r<a;++r)i(c[r],this,t)}return!0},a.prototype.on=a.prototype.addListener=function(e,t){return f(this,e,t,!1)},a.prototype.prependListener=function(e,t){return f(this,e,t,!0)},a.prototype.once=function(e,t){return u(t),this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,h(this,e,t)),this},a.prototype.off=a.prototype.removeListener=function(e,t){var r,n,i,o,s;if(u(t),void 0!==(n=this._events)&&void 0!==(r=n[e]))if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;0<=o;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.removeAllListeners=function(e){var t,r=this._events;if(void 0!==r)if(void 0===r.removeListener)0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]);else if(0===arguments.length){for(var n,i=Object.keys(r),o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0}else if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;0<=o;o--)this.removeListener(e,t[o]);return this},a.prototype.listeners=function(e){return p(this,e,!0)},a.prototype.rawListeners=function(e){return p(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},a.prototype.listenerCount=d,a.prototype.eventNames=function(){return 0<this._eventsCount?o(this._events):[]}},function(e,t,r){(function(t){e.exports=function(e){"use strict";var r=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(e);var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};function i(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}var o=i((function(e,t){var i;e.exports=i=i||function(e,t){var i;if("undefined"!=typeof window&&window.crypto&&(i=window.crypto),"undefined"!=typeof self&&self.crypto&&(i=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(i=globalThis.crypto),!i&&"undefined"!=typeof window&&window.msCrypto&&(i=window.msCrypto),!i&&void 0!==n&&n.crypto&&(i=n.crypto),!i)try{i=r.default}catch(e){}var o=function(){if(i){if("function"==typeof i.getRandomValues)try{return i.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof i.randomBytes)try{return i.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),a={},c=a.lib={},u=c.Base={extend:function(e){var t=s(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=c.WordArray=u.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||h).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var s=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=s<<24-(n+o)%4*8}else for(var a=0;a<i;a+=4)t[n+a>>>2]=r[a>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=u.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(o());return new l.init(t,e)}}),f=a.enc={},h=f.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new l.init(r,t/2)}},p=f.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new l.init(r,t)}},d=f.Utf8={stringify:function(e){try{return decodeURIComponent(escape(p.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},m=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,i=n.words,o=n.sigBytes,s=this.blockSize,a=o/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,u=e.min(4*c,o);if(c){for(var f=0;f<c;f+=s)this._doProcessBlock(i,f);r=i.splice(0,c),n.sigBytes-=u}return new l.init(r,u)},clone:function(){var e=u.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});c.Hasher=m.extend({cfg:u.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new y.HMAC.init(e,r).finalize(t)}}});var y=a.algo={};return a}(Math)})),s=i((function(e,t){var r;e.exports=(r=o,function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,s=t.algo,a=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,i=0;i<64;)t(n)&&(i<8&&(a[i]=r(e.pow(n,.5))),c[i]=r(e.pow(n,1/3)),i++),n++}();var u=[],l=s.SHA256=o.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],l=r[5],f=r[6],h=r[7],p=0;p<64;p++){if(p<16)u[p]=0|e[t+p];else{var d=u[p-15],m=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,y=u[p-2],v=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;u[p]=m+u[p-7]+v+u[p-16]}var g=n&i^n&o^i&o,b=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),_=h+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&f)+c[p]+u[p];h=f,f=l,l=a,a=s+_|0,s=o,o=i,i=n,n=_+(b+g)|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+s|0,r[4]=r[4]+a|0,r[5]=r[5]+l|0,r[6]=r[6]+f|0,r[7]=r[7]+h|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(l),t.HmacSHA256=o._createHmacHelper(l)}(Math),r.SHA256)})),a=(i((function(e,t){var r,n,i;e.exports=(n=(r=o).lib.Base,i=r.enc.Utf8,void(r.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=i.parse(t));var r=e.blockSize,n=4*r;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),s=this._iKey=t.clone(),a=o.words,c=s.words,u=0;u<r;u++)a[u]^=1549556828,c[u]^=909522486;o.sigBytes=s.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})))})),i((function(e,t){e.exports=o.HmacSHA256}))),c=function(e,t){return a(t,e)},u=function(e){return s(e)},l=["authorization","content-type","content-length","user-agent","presigned-expires","expect","x-amzn-trace-id"],f=function(e){try{return encodeURIComponent(e).replace(/[^A-Za-z0-9_.~\-%]+/g,escape).replace(/[*]/g,(function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}catch(e){return""}},h=function(e){return Object.keys(e).sort().map((function(t){var r=e[t];if(null!=r){var n=f(t);if(n)return Array.isArray(r)?"".concat(n,"=").concat(r.map(f).sort().join("&".concat(n,"="))):"".concat(n,"=").concat(f(r))}})).filter((function(e){return e})).join("&")};return function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.request=t,this.request.headers=t.headers||{},this.serviceName=r,n=n||{},this.signatureCache="boolean"!=typeof n.signatureCache||n.signatureCache,this.operation=n.operation,this.signatureVersion=n.signatureVersion,this.constant=n.isVolcengine?{algorithm:"HMAC-SHA256",v4Identifier:"request",dateHeader:"X-Date",tokenHeader:"x-security-token",contentSha256Header:"X-Content-Sha256",kDatePrefix:""}:{algorithm:"AWS4-HMAC-SHA256",v4Identifier:"aws4_request",dateHeader:"X-Amz-Date",tokenHeader:"x-amz-security-token",contentSha256Header:"X-Amz-Content-Sha256",kDatePrefix:"AWS4"},this.bodySha256=n.bodySha256,this.shouldSerializeBody="boolean"!=typeof n.shouldSerializeBody||n.shouldSerializeBody}var t,r;return t=e,(r=[{key:"addAuthorization",value:function(e,t){var r=this.iso8601(t).replace(/[:\-]|\.\d{3}/g,"");this.addHeaders(e,r),this.request.headers.Authorization=this.authorization(e,r)}},{key:"addHeaders",value:function(e,t){if(this.request.headers[this.constant.dateHeader]=t,e.sessionToken&&(this.request.headers[this.constant.tokenHeader]=e.sessionToken),this.request.body){var r=this.request.body;"string"!=typeof r&&this.shouldSerializeBody&&(r=r instanceof URLSearchParams?r.toString():JSON.stringify(r)),this.request.headers[this.constant.contentSha256Header]=this.bodySha256||u(r).toString()}}},{key:"authorization",value:function(e,t){var r=[],n=this.credentialString(t);return r.push("".concat(this.constant.algorithm," Credential=").concat(e.accessKeyId,"/").concat(n)),r.push("SignedHeaders=".concat(this.signedHeaders())),r.push("Signature=".concat(this.signature(e,t))),r.join(", ")}},{key:"signature",value:function(e,t){var r=this.getSigningKey(e,t.substr(0,8),this.request.region,this.serviceName,this.signatureCache);return c(r,this.stringToSign(t))}},{key:"stringToSign",value:function(e){var t=[];return t.push(this.constant.algorithm),t.push(e),t.push(this.credentialString(e)),t.push(this.hexEncodedHash(this.canonicalString())),t.join("\n")}},{key:"canonicalString",value:function(){var e=[],t=this.request.pathname||"/";return e.push(this.request.method.toUpperCase()),e.push(t),e.push(h(this.request.params)||""),e.push("".concat(this.canonicalHeaders(),"\n")),e.push(this.signedHeaders()),e.push(this.hexEncodedBodyHash()),e.join("\n")}},{key:"canonicalHeaders",value:function(){var e=this,t=[];Object.keys(this.request.headers).forEach((function(r){t.push([r,e.request.headers[r]])})),t.sort((function(e,t){return e[0].toLowerCase()<t[0].toLowerCase()?-1:1}));var r=[];return t.forEach((function(t){var n=t[0].toLowerCase();if(e.isSignableHeader(n)){var i=t[1];if(null==i||"function"!=typeof i.toString)throw new Error("Header ".concat(n," contains invalid value"));r.push("".concat(n,":").concat(e.canonicalHeaderValues(i.toString())))}})),r.join("\n")}},{key:"canonicalHeaderValues",value:function(e){return e.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")}},{key:"signedHeaders",value:function(){var e=this,t=[];return Object.keys(this.request.headers).forEach((function(r){r=r.toLowerCase(),e.isSignableHeader(r)&&t.push(r)})),t.sort().join(";")}},{key:"credentialString",value:function(e){return this.createScope(e.substr(0,8),this.request.region,this.serviceName)}},{key:"hexEncodedHash",value:function(e){return u(e)}},{key:"hexEncodedBodyHash",value:function(){return this.request.headers[this.constant.contentSha256Header]?this.request.headers[this.constant.contentSha256Header]:this.request.body?this.hexEncodedHash(h(this.request.body)):this.hexEncodedHash("")}},{key:"isSignableHeader",value:function(e){return 0===e.toLowerCase().indexOf("x-amz-")||l.indexOf(e)<0}},{key:"iso8601",value:function(e){return void 0===e&&(e=new Date),e.toISOString().replace(/\.\d{3}Z$/,"Z")}},{key:"getSigningKey",value:function(e,t,r,n){var i=c("".concat(this.constant.kDatePrefix).concat(e.secretAccessKey),t),o=c(i,r),s=c(o,n);return c(s,this.constant.v4Identifier)}},{key:"createScope",value:function(e,t,r){return[e.substr(0,8),t,r,this.constant.v4Identifier].join("/")}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,"symbol"==typeof(i=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key))?i:String(i),n)}var i}(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()}(r(9))}).call(this,r(5))},function(e,t,r){e.exports=function(){return r(10)('!function(t){var n={};function __webpack_require__(r){var e;return(n[r]||(e=n[r]={i:r,l:!1,exports:{}},t[r].call(e.exports,e,e.exports,__webpack_require__),e.l=!0,e)).exports}__webpack_require__.m=t,__webpack_require__.c=n,__webpack_require__.d=function(r,e,t){__webpack_require__.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:t})},__webpack_require__.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},__webpack_require__.t=function(e,r){if(1&r&&(e=__webpack_require__(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(__webpack_require__.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)__webpack_require__.d(t,n,function(r){return e[r]}.bind(null,n));return t},__webpack_require__.n=function(r){var e=r&&r.__esModule?function getDefault(){return r.default}:function getModuleExports(){return r};return __webpack_require__.d(e,"a",e),e},__webpack_require__.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=9)}([function(r,e,y){!function(_){r.exports=function(){var r=r||function(u,t){var r;if(typeof window!=="undefined"&&window.crypto)r=window.crypto;if(typeof self!=="undefined"&&self.crypto)r=self.crypto;if(typeof globalThis!=="undefined"&&globalThis.crypto)r=globalThis.crypto;if(!r&&typeof window!=="undefined"&&window.msCrypto)r=window.msCrypto;if(!r&&typeof _!=="undefined"&&_.crypto)r=_.crypto;if(!r&&"function"==="function")try{r=y(11)}catch(r){}var n=function(){if(r){if(typeof r.getRandomValues==="function")try{return r.getRandomValues(new Uint32Array(1))[0]}catch(r){}if(typeof r.randomBytes==="function")try{return r.randomBytes(4).readInt32LE()}catch(r){}}throw new Error("Native crypto module could not be used to get secure random number.")};var i=Object.create||function(){function F(){}return function(r){var e;F.prototype=r;e=new F;F.prototype=null;return e}}();var e={};var a=e.lib={};var o=a.Base=function(){return{extend:function(r){var e=i(this);if(r)e.mixIn(r);if(!e.hasOwnProperty("init")||this.init===e.init)e.init=function(){e.$super.init.apply(this,arguments)};e.init.prototype=e;e.$super=this;return e},create:function(){var r=this.extend();r.init.apply(r,arguments);return r},init:function(){},mixIn:function(r){for(var e in r)if(r.hasOwnProperty(e))this[e]=r[e];if(r.hasOwnProperty("toString"))this.toString=r.toString},clone:function(){return this.init.prototype.extend(this)}}}();var h=a.WordArray=o.extend({init:function(r,e){r=this.words=r||[];if(e!=t)this.sigBytes=e;else this.sigBytes=r.length*4},toString:function(r){return(r||s).stringify(this)},concat:function(r){var e=this.words;var t=r.words;var n=this.sigBytes;var i=r.sigBytes;this.clamp();if(n%4)for(var a=0;a<i;a++){var o=t[a>>>2]>>>24-a%4*8&255;e[n+a>>>2]|=o<<24-(n+a)%4*8}else for(var c=0;c<i;c+=4)e[n+c>>>2]=t[c>>>2];this.sigBytes+=i;return this},clamp:function(){var r=this.words;var e=this.sigBytes;r[e>>>2]&=4294967295<<32-e%4*8;r.length=u.ceil(e/4)},clone:function(){var r=o.clone.call(this);r.words=this.words.slice(0);return r},random:function(r){var e=[];for(var t=0;t<r;t+=4)e.push(n());return new h.init(e,r)}});var c=e.enc={};var s=c.Hex={stringify:function(r){var e=r.words;var t=r.sigBytes;var n=[];for(var i=0;i<t;i++){var a=e[i>>>2]>>>24-i%4*8&255;n.push((a>>>4).toString(16));n.push((a&15).toString(16))}return n.join("")},parse:function(r){var e=r.length;var t=[];for(var n=0;n<e;n+=2)t[n>>>3]|=parseInt(r.substr(n,2),16)<<24-n%8*4;return new h.init(t,e/2)}};var f=c.Latin1={stringify:function(r){var e=r.words;var t=r.sigBytes;var n=[];for(var i=0;i<t;i++){var a=e[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(a))}return n.join("")},parse:function(r){var e=r.length;var t=[];for(var n=0;n<e;n++)t[n>>>2]|=(r.charCodeAt(n)&255)<<24-n%4*8;return new h.init(t,e)}};var v=c.Utf8={stringify:function(r){try{return decodeURIComponent(escape(f.stringify(r)))}catch(r){throw new Error("Malformed UTF-8 data")}},parse:function(r){return f.parse(unescape(encodeURIComponent(r)))}};var p=a.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new h.init;this._nDataBytes=0},_append:function(r){if(typeof r=="string")r=v.parse(r);this._data.concat(r);this._nDataBytes+=r.sigBytes},_process:function(r){var e;var t=this._data;var n=t.words;var i=t.sigBytes;var a=this.blockSize;var o=a*4;var c=i/o;if(r)c=u.ceil(c);else c=u.max((c|0)-this._minBufferSize,0);var s=c*a;var f=u.min(s*4,i);if(s){for(var v=0;v<s;v+=a)this._doProcessBlock(n,v);e=n.splice(0,s);t.sigBytes-=f}return new h.init(e,f)},clone:function(){var r=o.clone.call(this);r._data=this._data.clone();return r},_minBufferSize:0});var l=a.Hasher=p.extend({cfg:o.extend(),init:function(r){this.cfg=this.cfg.extend(r);this.reset()},reset:function(){p.reset.call(this);this._doReset()},update:function(r){this._append(r);this._process();return this},finalize:function(r){if(r)this._append(r);var e=this._doFinalize();return e},blockSize:512/32,_createHelper:function(t){return function(r,e){return new t.init(e).finalize(r)}},_createHmacHelper:function(t){return function(r,e){return new d.HMAC.init(t,e).finalize(r)}}});var d=e.algo={};return e}(Math);return r}()}.call(this,y(10))},function(r,e,t){r.exports=function(F){F.lib.Cipher||function(o){var r=F;var e=r.lib;var t=e.Base;var s=e.WordArray;var n=e.BufferedBlockAlgorithm;var i=r.enc;var a=i.Utf8;var c=i.Base64;var f=r.algo;var v=f.EvpKDF;var u=e.Cipher=n.extend({cfg:t.extend(),createEncryptor:function(r,e){return this.create(this._ENC_XFORM_MODE,r,e)},createDecryptor:function(r,e){return this.create(this._DEC_XFORM_MODE,r,e)},init:function(r,e,t){this.cfg=this.cfg.extend(t);this._xformMode=r;this._key=e;this.reset()},reset:function(){n.reset.call(this);this._doReset()},process:function(r){this._append(r);return this._process()},finalize:function(r){if(r)this._append(r);var e=this._doFinalize();return e},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function selectCipherStrategy(r){if(typeof r=="string")return S;else return m}return function(n){return{encrypt:function(r,e,t){return selectCipherStrategy(e).encrypt(n,r,e,t)},decrypt:function(r,e,t){return selectCipherStrategy(e).decrypt(n,r,e,t)}}}}()});var h=e.StreamCipher=u.extend({_doFinalize:function(){var r=this._process(!!"flush");return r},blockSize:1});var p=r.mode={};var l=e.BlockCipherMode=t.extend({createEncryptor:function(r,e){return this.Encryptor.create(r,e)},createDecryptor:function(r,e){return this.Decryptor.create(r,e)},init:function(r,e){this._cipher=r;this._iv=e}});var d=p.CBC=function(){var r=l.extend();r.Encryptor=r.extend({processBlock:function(r,e){var t=this._cipher;var n=t.blockSize;xorBlock.call(this,r,e,n);t.encryptBlock(r,e);this._prevBlock=r.slice(e,e+n)}});r.Decryptor=r.extend({processBlock:function(r,e){var t=this._cipher;var n=t.blockSize;var i=r.slice(e,e+n);t.decryptBlock(r,e);xorBlock.call(this,r,e,n);this._prevBlock=i}});function xorBlock(r,e,t){var n;var i=this._iv;if(i){n=i;this._iv=o}else n=this._prevBlock;for(var a=0;a<t;a++)r[e+a]^=n[a]}return r}();var _=r.pad={};var y=_.Pkcs7={pad:function(r,e){var t=e*4;var n=t-r.sigBytes%t;var i=n<<24|n<<16|n<<8|n;var a=[];for(var o=0;o<n;o+=4)a.push(i);var c=s.create(a,n);r.concat(c)},unpad:function(r){var e=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=e}};var g=e.BlockCipher=u.extend({cfg:u.cfg.extend({mode:d,padding:y}),reset:function(){var r;u.reset.call(this);var e=this.cfg;var t=e.iv;var n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)r=n.createEncryptor;else{r=n.createDecryptor;this._minBufferSize=1}if(this._mode&&this._mode.__creator==r)this._mode.init(this,t&&t.words);else{this._mode=r.call(n,this,t&&t.words);this._mode.__creator=r}},_doProcessBlock:function(r,e){this._mode.processBlock(r,e)},_doFinalize:function(){var r;var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);r=this._process(!!"flush")}else{r=this._process(!!"flush");e.unpad(r)}return r},blockSize:128/32});var w=e.CipherParams=t.extend({init:function(r){this.mixIn(r)},toString:function(r){return(r||this.formatter).stringify(this)}});var k=r.format={};var B=k.OpenSSL={stringify:function(r){var e;var t=r.ciphertext;var n=r.salt;if(n)e=s.create([1398893684,1701076831]).concat(n).concat(t);else e=t;return e.toString(c)},parse:function(r){var e;var t=c.parse(r);var n=t.words;if(n[0]==1398893684&&n[1]==1701076831){e=s.create(n.slice(2,4));n.splice(0,4);t.sigBytes-=16}return w.create({ciphertext:t,salt:e})}};var m=e.SerializableCipher=t.extend({cfg:t.extend({format:B}),encrypt:function(r,e,t,n){n=this.cfg.extend(n);var i=r.createEncryptor(t,n);var a=i.finalize(e);var o=i.cfg;return w.create({ciphertext:a,key:t,iv:o.iv,algorithm:r,mode:o.mode,padding:o.padding,blockSize:r.blockSize,formatter:n.format})},decrypt:function(r,e,t,n){n=this.cfg.extend(n);e=this._parse(e,n.format);var i=r.createDecryptor(t,n).finalize(e.ciphertext);return i},_parse:function(r,e){if(typeof r=="string")return e.parse(r,this);else return r}});var x=r.kdf={};var b=x.OpenSSL={execute:function(r,e,t,n,i){if(!n)n=s.random(64/8);if(!i)var a=v.create({keySize:e+t}).compute(r,n);else var a=v.create({keySize:e+t,hasher:i}).compute(r,n);var o=s.create(a.words.slice(e),t*4);a.sigBytes=e*4;return w.create({key:a,iv:o,salt:n})}};var S=e.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:b}),encrypt:function(r,e,t,n){n=this.cfg.extend(n);var i=n.kdf.execute(t,r.keySize,r.ivSize,n.salt,n.hasher);n.iv=i.iv;var a=m.encrypt.call(this,r,e,i.key,n);a.mixIn(i);return a},decrypt:function(r,e,t,n){n=this.cfg.extend(n);e=this._parse(e,n.format);var i=n.kdf.execute(t,r.keySize,r.ivSize,e.salt,n.hasher);n.iv=i.iv;var a=m.decrypt.call(this,r,e,i.key,n);return a}})}()}(t(0),t(5))},function(r,e,t){r.exports=function(a){return function(){var r=a;var e=r.lib;var t=e.BlockCipher;var n=r.algo;var v=[];var f=[];var u=[];var h=[];var p=[];var l=[];var d=[];var _=[];var y=[];var g=[];(function(){var r=[];for(var e=0;e<256;e++)if(e<128)r[e]=e<<1;else r[e]=e<<1^283;var t=0;var n=0;for(var e=0;e<256;e++){var i=n^n<<1^n<<2^n<<3^n<<4;i=i>>>8^i&255^99;v[t]=i;f[i]=t;var a=r[t];var o=r[a];var c=r[o];var s=r[i]*257^i*16843008;u[t]=s<<24|s>>>8;h[t]=s<<16|s>>>16;p[t]=s<<8|s>>>24;l[t]=s;var s=c*16843009^o*65537^a*257^t*16843008;d[i]=s<<24|s>>>8;_[i]=s<<16|s>>>16;y[i]=s<<8|s>>>24;g[i]=s;if(!t)t=n=1;else{t=a^r[r[r[c^a]]];n^=r[r[n]]}}})();var w=[0,1,2,4,8,16,32,64,128,27,54];var i=n.AES=t.extend({_doReset:function(){var r;if(this._nRounds&&this._keyPriorReset===this._key)return;var e=this._keyPriorReset=this._key;var t=e.words;var n=e.sigBytes/4;var i=this._nRounds=n+6;var a=(i+1)*4;var o=this._keySchedule=[];for(var c=0;c<a;c++)if(c<n)o[c]=t[c];else{r=o[c-1];if(!(c%n)){r=r<<8|r>>>24;r=v[r>>>24]<<24|v[r>>>16&255]<<16|v[r>>>8&255]<<8|v[r&255];r^=w[c/n|0]<<24}else if(n>6&&c%n==4)r=v[r>>>24]<<24|v[r>>>16&255]<<16|v[r>>>8&255]<<8|v[r&255];o[c]=o[c-n]^r}var s=this._invKeySchedule=[];for(var f=0;f<a;f++){var c=a-f;if(f%4)var r=o[c];else var r=o[c-4];if(f<4||c<=4)s[f]=r;else s[f]=d[v[r>>>24]]^_[v[r>>>16&255]]^y[v[r>>>8&255]]^g[v[r&255]]}},encryptBlock:function(r,e){this._doCryptBlock(r,e,this._keySchedule,u,h,p,l,v)},decryptBlock:function(r,e){var t=r[e+1];r[e+1]=r[e+3];r[e+3]=t;this._doCryptBlock(r,e,this._invKeySchedule,d,_,y,g,f);var t=r[e+1];r[e+1]=r[e+3];r[e+3]=t},_doCryptBlock:function(r,e,t,n,i,a,o,c){var s=this._nRounds;var f=r[e]^t[0];var v=r[e+1]^t[1];var u=r[e+2]^t[2];var h=r[e+3]^t[3];var p=4;for(var l=1;l<s;l++){var d=n[f>>>24]^i[v>>>16&255]^a[u>>>8&255]^o[h&255]^t[p++];var _=n[v>>>24]^i[u>>>16&255]^a[h>>>8&255]^o[f&255]^t[p++];var y=n[u>>>24]^i[h>>>16&255]^a[f>>>8&255]^o[v&255]^t[p++];var g=n[h>>>24]^i[f>>>16&255]^a[v>>>8&255]^o[u&255]^t[p++];f=d;v=_;u=y;h=g}var d=(c[f>>>24]<<24|c[v>>>16&255]<<16|c[u>>>8&255]<<8|c[h&255])^t[p++];var _=(c[v>>>24]<<24|c[u>>>16&255]<<16|c[h>>>8&255]<<8|c[f&255])^t[p++];var y=(c[u>>>24]<<24|c[h>>>16&255]<<16|c[f>>>8&255]<<8|c[v&255])^t[p++];var g=(c[h>>>24]<<24|c[f>>>16&255]<<16|c[v>>>8&255]<<8|c[u&255])^t[p++];r[e]=d;r[e+1]=_;r[e+2]=y;r[e+3]=g},keySize:256/32});r.AES=t._createHelper(i)}(),a.AES}(t(0),(t(12),t(13),t(5),t(1)))},function(r,e,t){r.exports=function(e){return e.mode.ECB=function(){var r=e.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(r,e){this._cipher.encryptBlock(r,e)}});r.Decryptor=r.extend({processBlock:function(r,e){this._cipher.decryptBlock(r,e)}});return r}(),e.mode.ECB}(t(0),t(1))},function(r,e,t){r.exports=function(r){return r.enc.Utf8}(t(0))},function(r,e,t){r.exports=function(o){return function(){var r=o;var e=r.lib;var t=e.Base;var v=e.WordArray;var n=r.algo;var i=n.MD5;var a=n.EvpKDF=t.extend({cfg:t.extend({keySize:128/32,hasher:i,iterations:1}),init:function(r){this.cfg=this.cfg.extend(r)},compute:function(r,e){var t;var n=this.cfg;var i=n.hasher.create();var a=v.create();var o=a.words;var c=n.keySize;var s=n.iterations;while(o.length<c){if(t)i.update(t);t=i.update(r).finalize(e);i.reset();for(var f=1;f<s;f++){t=i.finalize(t);i.reset()}a.concat(t)}a.sigBytes=c*4;return a}});r.EvpKDF=function(r,e,t){return a.create(t).compute(r,e)}}(),o.EvpKDF}(t(0),(t(14),t(15)))},function(r,e,t){r.exports=function(r){return r.pad.Pkcs7}(t(0),t(1))},function(r,e,t){r.exports=function(r){return r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding}(t(0),t(1))},function(r,e,t){r.exports=function(a){return function(){if(typeof ArrayBuffer!="function")return;var r=a;var e=r.lib;var t=e.WordArray;var i=t.init;var n=t.init=function(r){if(r instanceof ArrayBuffer)r=new Uint8Array(r);if(r instanceof Int8Array||typeof Uint8ClampedArray!=="undefined"&&r instanceof Uint8ClampedArray||r instanceof Int16Array||r instanceof Uint16Array||r instanceof Int32Array||r instanceof Uint32Array||r instanceof Float32Array||r instanceof Float64Array)r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);if(r instanceof Uint8Array){var e=r.byteLength;var t=[];for(var n=0;n<e;n++)t[n>>>2]|=r[n]<<24-n%4*8;i.call(this,t,e)}else i.apply(this,arguments)};n.prototype=t}(),a.lib.WordArray}(t(0))},function(r,e,t){"use strict";t.r(e);var e=t(2),o=t.n(e),e=t(3),c=t.n(e),e=t(6),s=t.n(e),e=t(7),f=t.n(e),e=t(8),v=t.n(e),e=t(4),u=t.n(e);function crc32(r,e){for(var t=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],n=("undefined"!=typeof Int32Array&&(t=new Int32Array(t)),-1^~~e),i=(r=new Uint8Array(r)).length,a=0;a<i;a++)n=t[255&(n^r[a])]^n>>>8;return(-1^n)>>>0}function dec2hex(r){if(void 0!==r)return function toEight(r){return r.length<8?toEight(r="0".concat(r)):r}(Number(r).toString(16))}self.onmessage=function(r){var r=r.data,e=r[0],t=r[1],n=r[2],i=r[3],a=r[4],r=r[5];i?(i=v.a.create(e),i=crc32(r=function wordArrayToUint8Array(r){for(var e=r.sigBytes,t=r.words,n=new Uint8Array(e),i=0,a=0;i!==e;){var o=t[a++];if(n[i++]=(4278190080&o)>>>24,i===e)break;if(n[i++]=(16711680&o)>>>16,i===e)break;if(n[i++]=(65280&o)>>>8,i===e)break;n[i++]=255&o}return n}((r&&e.byteLength%16!=0?o.a.encrypt(i,u.a.parse(a),{mode:c.a,padding:s.a}):o.a.encrypt(i,u.a.parse(a),{mode:c.a,padding:f.a})).ciphertext),0),postMessage([r.buffer,dec2hex(i),t,n],[r.buffer])):(a=crc32(e,0),postMessage([e,dec2hex(a),t,n],[e]))}},function(r,e){var t=function(){return this}();try{t=t||new Function("return this")()}catch(r){"object"==typeof window&&(t=window)}r.exports=t},function(r,e){},function(r,e,t){r.exports=function(i){return function(){var r=i;var e=r.lib;var f=e.WordArray;var t=r.enc;var n=t.Base64={stringify:function(r){var e=r.words;var t=r.sigBytes;var n=this._map;r.clamp();var i=[];for(var a=0;a<t;a+=3){var o=e[a>>>2]>>>24-a%4*8&255;var c=e[a+1>>>2]>>>24-(a+1)%4*8&255;var s=e[a+2>>>2]>>>24-(a+2)%4*8&255;var f=o<<16|c<<8|s;for(var v=0;v<4&&a+v*.75<t;v++)i.push(n.charAt(f>>>6*(3-v)&63))}var u=n.charAt(64);if(u)while(i.length%4)i.push(u);return i.join("")},parse:function(r){var e=r.length;var t=this._map;var n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var i=0;i<t.length;i++)n[t.charCodeAt(i)]=i}var a=t.charAt(64);if(a){var o=r.indexOf(a);if(o!==-1)e=o}return parseLoop(r,e,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function parseLoop(r,e,t){var n=[];var i=0;for(var a=0;a<e;a++)if(a%4){var o=t[r.charCodeAt(a-1)]<<a%4*2;var c=t[r.charCodeAt(a)]>>>6-a%4*2;var s=o|c;n[i>>>2]|=s<<24-i%4*8;i++}return f.create(n,i)}}(),i.enc.Base64}(t(0))},function(r,e,t){r.exports=function(o){return function(v){var r=o;var e=r.lib;var t=e.WordArray;var n=e.Hasher;var i=r.algo;var F=[];(function(){for(var r=0;r<64;r++)F[r]=v.abs(v.sin(r+1))*4294967296|0})();var a=i.MD5=n.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(r,e){for(var t=0;t<16;t++){var n=e+t;var i=r[n];r[n]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360}var a=this._hash.words;var o=r[e+0];var c=r[e+1];var s=r[e+2];var f=r[e+3];var v=r[e+4];var u=r[e+5];var h=r[e+6];var p=r[e+7];var l=r[e+8];var d=r[e+9];var _=r[e+10];var y=r[e+11];var g=r[e+12];var w=r[e+13];var k=r[e+14];var B=r[e+15];var m=a[0];var x=a[1];var b=a[2];var S=a[3];m=FF(m,x,b,S,o,7,F[0]);S=FF(S,m,x,b,c,12,F[1]);b=FF(b,S,m,x,s,17,F[2]);x=FF(x,b,S,m,f,22,F[3]);m=FF(m,x,b,S,v,7,F[4]);S=FF(S,m,x,b,u,12,F[5]);b=FF(b,S,m,x,h,17,F[6]);x=FF(x,b,S,m,p,22,F[7]);m=FF(m,x,b,S,l,7,F[8]);S=FF(S,m,x,b,d,12,F[9]);b=FF(b,S,m,x,_,17,F[10]);x=FF(x,b,S,m,y,22,F[11]);m=FF(m,x,b,S,g,7,F[12]);S=FF(S,m,x,b,w,12,F[13]);b=FF(b,S,m,x,k,17,F[14]);x=FF(x,b,S,m,B,22,F[15]);m=GG(m,x,b,S,c,5,F[16]);S=GG(S,m,x,b,h,9,F[17]);b=GG(b,S,m,x,y,14,F[18]);x=GG(x,b,S,m,o,20,F[19]);m=GG(m,x,b,S,u,5,F[20]);S=GG(S,m,x,b,_,9,F[21]);b=GG(b,S,m,x,B,14,F[22]);x=GG(x,b,S,m,v,20,F[23]);m=GG(m,x,b,S,d,5,F[24]);S=GG(S,m,x,b,k,9,F[25]);b=GG(b,S,m,x,f,14,F[26]);x=GG(x,b,S,m,l,20,F[27]);m=GG(m,x,b,S,w,5,F[28]);S=GG(S,m,x,b,s,9,F[29]);b=GG(b,S,m,x,p,14,F[30]);x=GG(x,b,S,m,g,20,F[31]);m=HH(m,x,b,S,u,4,F[32]);S=HH(S,m,x,b,l,11,F[33]);b=HH(b,S,m,x,y,16,F[34]);x=HH(x,b,S,m,k,23,F[35]);m=HH(m,x,b,S,c,4,F[36]);S=HH(S,m,x,b,v,11,F[37]);b=HH(b,S,m,x,p,16,F[38]);x=HH(x,b,S,m,_,23,F[39]);m=HH(m,x,b,S,w,4,F[40]);S=HH(S,m,x,b,o,11,F[41]);b=HH(b,S,m,x,f,16,F[42]);x=HH(x,b,S,m,h,23,F[43]);m=HH(m,x,b,S,d,4,F[44]);S=HH(S,m,x,b,g,11,F[45]);b=HH(b,S,m,x,B,16,F[46]);x=HH(x,b,S,m,s,23,F[47]);m=II(m,x,b,S,o,6,F[48]);S=II(S,m,x,b,p,10,F[49]);b=II(b,S,m,x,k,15,F[50]);x=II(x,b,S,m,u,21,F[51]);m=II(m,x,b,S,g,6,F[52]);S=II(S,m,x,b,f,10,F[53]);b=II(b,S,m,x,_,15,F[54]);x=II(x,b,S,m,c,21,F[55]);m=II(m,x,b,S,l,6,F[56]);S=II(S,m,x,b,B,10,F[57]);b=II(b,S,m,x,h,15,F[58]);x=II(x,b,S,m,w,21,F[59]);m=II(m,x,b,S,v,6,F[60]);S=II(S,m,x,b,y,10,F[61]);b=II(b,S,m,x,s,15,F[62]);x=II(x,b,S,m,d,21,F[63]);a[0]=a[0]+m|0;a[1]=a[1]+x|0;a[2]=a[2]+b|0;a[3]=a[3]+S|0},_doFinalize:function(){var r=this._data;var e=r.words;var t=this._nDataBytes*8;var n=r.sigBytes*8;e[n>>>5]|=128<<24-n%32;var i=v.floor(t/4294967296);var a=t;e[(n+64>>>9<<4)+15]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360;e[(n+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;r.sigBytes=(e.length+1)*4;this._process();var o=this._hash;var c=o.words;for(var s=0;s<4;s++){var f=c[s];c[s]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360}return o},clone:function(){var r=n.clone.call(this);r._hash=this._hash.clone();return r}});function FF(r,e,t,n,i,a,o){var c=r+(e&t|~e&n)+i+o;return(c<<a|c>>>32-a)+e}function GG(r,e,t,n,i,a,o){var c=r+(e&n|t&~n)+i+o;return(c<<a|c>>>32-a)+e}function HH(r,e,t,n,i,a,o){var c=r+(e^t^n)+i+o;return(c<<a|c>>>32-a)+e}function II(r,e,t,n,i,a,o){var c=r+(t^(e|~n))+i+o;return(c<<a|c>>>32-a)+e}r.MD5=n._createHelper(a);r.HmacMD5=n._createHmacHelper(a)}(Math),o.MD5}(t(0))},function(r,e,t){r.exports=function(o){return function(){var r=o;var e=r.lib;var t=e.WordArray;var n=e.Hasher;var i=r.algo;var u=[];var a=i.SHA1=n.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(r,e){var t=this._hash.words;var n=t[0];var i=t[1];var a=t[2];var o=t[3];var c=t[4];for(var s=0;s<80;s++){if(s<16)u[s]=r[e+s]|0;else{var f=u[s-3]^u[s-8]^u[s-14]^u[s-16];u[s]=f<<1|f>>>31}var v=(n<<5|n>>>27)+c+u[s];if(s<20)v+=(i&a|~i&o)+1518500249;else if(s<40)v+=(i^a^o)+1859775393;else if(s<60)v+=(i&a|i&o|a&o)-1894007588;else v+=(i^a^o)-899497514;c=o;o=a;a=i<<30|i>>>2;i=n;n=v}t[0]=t[0]+n|0;t[1]=t[1]+i|0;t[2]=t[2]+a|0;t[3]=t[3]+o|0;t[4]=t[4]+c|0},_doFinalize:function(){var r=this._data;var e=r.words;var t=this._nDataBytes*8;var n=r.sigBytes*8;e[n>>>5]|=128<<24-n%32;e[(n+64>>>9<<4)+14]=Math.floor(t/4294967296);e[(n+64>>>9<<4)+15]=t;r.sigBytes=e.length*4;this._process();return this._hash},clone:function(){var r=n.clone.call(this);r._hash=this._hash.clone();return r}});r.SHA1=n._createHelper(a);r.HmacSHA1=n._createHmacHelper(a)}(),o.SHA1}(t(0))},function(r,e,t){r.exports=function(o){(function(){var r=o;var e=r.lib;var t=e.Base;var n=r.enc;var f=n.Utf8;var i=r.algo;var a=i.HMAC=t.extend({init:function(r,e){r=this._hasher=new r.init;if(typeof e=="string")e=f.parse(e);var t=r.blockSize;var n=t*4;if(e.sigBytes>n)e=r.finalize(e);e.clamp();var i=this._oKey=e.clone();var a=this._iKey=e.clone();var o=i.words;var c=a.words;for(var s=0;s<t;s++){o[s]^=1549556828;c[s]^=909522486}i.sigBytes=a.sigBytes=n;this.reset()},reset:function(){var r=this._hasher;r.reset();r.update(this._iKey)},update:function(r){this._hasher.update(r);return this},finalize:function(r){var e=this._hasher;var t=e.finalize(r);e.reset();var n=e.finalize(this._oKey.clone().concat(t));return n}})})()}(t(0))}]);',null)}},function(e,t,r){(function(t){e.exports=function(){var e=e||function(e,n){var i;if("undefined"!=typeof window&&window.crypto&&(i=window.crypto),"undefined"!=typeof self&&self.crypto&&(i=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(i=globalThis.crypto),!i&&"undefined"!=typeof window&&window.msCrypto&&(i=window.msCrypto),!i&&void 0!==t&&t.crypto&&(i=t.crypto),!i)try{i=r(7)}catch(i){}var o=function(){if(i){if("function"==typeof i.getRandomValues)try{return i.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof i.randomBytes)try{return i.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),a={},c=a.lib={},u=c.Base={extend:function(e){var t=s(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=c.WordArray=u.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||h).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var s=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=s<<24-(n+o)%4*8}else for(var a=0;a<i;a+=4)t[n+a>>>2]=r[a>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=u.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(o());return new l.init(t,e)}}),f=a.enc={},h=f.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new l.init(r,t/2)}},p=f.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new l.init(r,t)}},d=f.Utf8={stringify:function(e){try{return decodeURIComponent(escape(p.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},m=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,i=n.words,o=n.sigBytes,s=this.blockSize,a=o/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,u=e.min(4*c,o);if(c){for(var f=0;f<c;f+=s)this._doProcessBlock(i,f);r=i.splice(0,c),n.sigBytes-=u}return new l.init(r,u)},clone:function(){var e=u.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),y=(c.Hasher=m.extend({cfg:u.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new y.HMAC.init(e,r).finalize(t)}}}),a.algo={});return a}(Math);return e}()}).call(this,r(5))},function(e,t,r){var n;e.exports=(n=r(3),function(e){var t=n,r=t.lib,i=r.WordArray,o=r.Hasher,s=t.algo,a=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,i=0;i<64;)t(n)&&(i<8&&(a[i]=r(e.pow(n,.5))),c[i]=r(e.pow(n,1/3)),i++),n++}();var u=[],l=s.SHA256=o.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],l=r[5],f=r[6],h=r[7],p=0;p<64;p++){if(p<16)u[p]=0|e[t+p];else{var d=u[p-15],m=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,y=u[p-2],v=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;u[p]=m+u[p-7]+v+u[p-16]}var g=n&i^n&o^i&o,b=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),_=h+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&f)+c[p]+u[p];h=f,f=l,l=a,a=s+_|0,s=o,o=i,i=n,n=_+(b+g)|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+s|0,r[4]=r[4]+a|0,r[5]=r[5]+l|0,r[6]=r[6]+f|0,r[7]=r[7]+h|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(l),t.HmacSHA256=o._createHmacHelper(l)}(Math),n.SHA256)},function(e,t){var r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){e.exports=function(e){return e.HmacSHA256}(r(3),(r(4),r(8)))},function(e,t){},function(e,t,r){var n;e.exports=(n=r(3),void function(){var e=n,t=e.lib.Base,r=e.enc.Utf8;e.algo.HMAC=t.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var n=e.blockSize,i=4*n;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),s=this._iKey=t.clone(),a=o.words,c=s.words,u=0;u<n;u++)a[u]^=1549556828,c[u]^=909522486;o.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})}())},function(e,t){},function(e,t,r){"use strict";var n=window.URL||window.webkitURL;e.exports=function(e,t){try{try{var r;try{(r=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(e),r=r.getBlob()}catch(t){r=new Blob([e])}return new Worker(n.createObjectURL(r))}catch(t){return new Worker("data:application/javascript,"+encodeURIComponent(e))}}catch(e){if(t)return new Worker(t);throw Error("Inline worker is not supported")}}},function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return Mr})),t=r(0);var n=r.n(t),i="{tosDomain}/upload/v1/{oid}?uploadid={uploadId}&part_number={part_number}&phase=transfer",o="{tosDomain}/upload/v1/{oid}",s={debug:!1,region:"us-east-1",external:{},getSliceFunc:null,uploadSliceCount:3,retryUploadTime:2,retryProcess:!0,retryProcessTime:3,retryTaskTime:2,progressMonitorTime:10,progressMonitorSpeed:50,schema:"https",enableDiskBreakpoint:!0,replace:{}},a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}(arguments[t]));return e}function u(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)}function l(e){return function(e){if("string"==typeof e){for(var t=[],r=String.fromCharCode(122),n=e.split(r),i=0;i<n.length;i++){var o=64^+parseInt(n[i],25);o=String.fromCharCode(o),t.push(o)}return t.join("")}}(e)}function f(e){var t=document.createElement("a");return t.href=e,t}function h(e){var t={};try{f(e).search.slice(1).split("&").forEach((function(e){var r,n,i=e.split("=");i.length&&(r=i[0],n=i[1]);try{t[r]=decodeURIComponent(void 0===n?"":n)}catch(e){t[r]=n}}))}catch(e){}return t}function p(e,t){try{return S.get(e)}catch(e){return""}}function d(e,t,r,n){try{var i=n||document.domain,o=+new Date+(r||6048e5);S.set(e,t,{expires:new Date(o),path:"/",domain:i})}catch(e){}}function m(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}().replace(/-/g,"").slice(0,19)}function y(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var v,g,b,_=function(){function e(){this._hooks={},this._cache=[],this._hooksCache={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var r=this;e&&t&&"function"==typeof t&&this.on(e,(function n(i){t(i),r.off(e,n)}))},e.prototype.off=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&(t?-1!==(t=this._hooks[e].indexOf(t))&&this._hooks[e].splice(t,1):this._hooks[e]=[])},e.prototype.emit=function(e,t,r){r?e&&(-1!==this._cache.indexOf(r)?this._emit(e,t):(this._hooksCache.hasOwnProperty(r)||(this._hooksCache[r]={}),this._hooksCache[r].hasOwnProperty(e)||(this._hooksCache[r][e]=[]),this._hooksCache[r][e].push(t))):this._emit(e,t)},e.prototype._emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&c(this._hooks[e]).forEach((function(e){try{e(t)}catch(e){}}))},e.prototype.set=function(e){e&&-1===this._cache.indexOf(e)&&this._cache.push(e)},e}(),S=(v=+Date.now()+Number((""+Math.random()).slice(2,8)),function(e){e.exports=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function r(n){function i(){}function o(t,r,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},i.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var s=JSON.stringify(r);/^[\{\[]/.test(s)&&(r=s)}catch(e){}r=n.write?n.write(r,t):encodeURIComponent(String(r)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in o)o[c]&&(a+="; "+c,!0!==o[c]&&(a+="="+o[c].split(";")[0]));return document.cookie=t+"="+r+a}}function s(e,r){if("undefined"!=typeof document){for(var i={},o=document.cookie?document.cookie.split("; "):[],s=0;s<o.length;s++){var a=o[s].split("="),c=a.slice(1).join("=");r||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=t(a[0]);if(c=(n.read||n)(c,u)||t(c),r)try{c=JSON.parse(c)}catch(e){}if(i[u]=c,e===u)break}catch(e){}}return e?i[e]:i}}return i.set=o,i.get=function(e){return s(e,!1)},i.getJSON=function(e){return s(e,!0)},i.remove=function(t,r){o(t,"",e(r,{expires:-1}))},i.defaults={},i.withConverter=r,i}((function(){}))}()}(b={exports:{}}),b.exports),M=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e.prototype.getCookie=function(e,t){return p(e)},e.prototype.setCookie=function(e,t,r,n){d(e,t,r,n)},e}(),k={getItem:function(e){try{var t=localStorage.getItem(e),r=t;try{t&&"string"==typeof t&&(r=JSON.parse(t))}catch(e){}return r||{}}catch(e){}return{}},setItem:function(e,t){try{var r="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,r)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return p(e)},setCookie:function(e,t,r,n){d(e,t,r,n)},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},w={getItem:function(e){try{var t=sessionStorage.getItem(e),r=t;try{t&&"string"==typeof t&&(r=JSON.parse(t))}catch(e){}return r||{}}catch(e){}return{}},setItem:function(e,t){try{var r="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,r)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return p(e)},setCookie:function(e,t,r,n){d(e,t,r,n)},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},x=function(){function e(e,t){this._storage=t&&"session"===t?w:!e&&k.isSupportLS?k:new M}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,r,n){this._storage.setCookie(e,t,r,n)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),Y=function(){function e(e,t,r){this.appid=e,this.domain=t,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=r}return e.prototype.init=function(){var e=window.navigator.userAgent,t=window.navigator.language,r=document.referrer,n=r?f(r).hostname:"",i=h(window.location.href),o=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web",s=(this.utm=function(e,t){var r=new x(!1,"session"),n=e?"_$utm_from_url_"+e:"_$utm_from_url",i={},o=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],s={ad_id:Number(t.ad_id)||void 0,campaign_id:Number(t.campaign_id)||void 0,creative_id:Number(t.creative_id)||void 0,utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var a,c=!1;for(a in s)s[a]&&(-1!==o.indexOf(a)?(i.hasOwnProperty("tracer_data")||(i.tracer_data={}),i.tracer_data[a]=s[a]):i[a]=s[a],c=!0);c&&r.setItem(n,"1"),r.getItem(n)&&(i.hasOwnProperty("tracer_data")||(i.tracer_data={}),i.tracer_data.$utm_from_url=1)}catch(e){return s}return i}(this.appid,i,(this.domain,this.cookie_expire)),i=this.browser(),this.os());return{browser:i.browser,browser_version:i.browser_version,platform:o,os_name:s.os_name,os_version:s.os_version,userAgent:e,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(s.os_name),language:t,referrer:r,referrer_host:n,utm:this.utm,latest_data:this.last(r,n)}},e.prototype.last=function(e,t){var r="",n="",i="",o=location.hostname,s=!1;return e&&t&&o!==t&&(n=t,s=!0,(o=h(r=e)).keyword)&&(i=o.keyword),{$latest_referrer:r,$latest_referrer_host:n,$latest_search_keyword:i,isLast:s}},e.prototype.browser=function(){var e,t="",r=""+parseFloat(this.appVersion),n=this.userAgent;return-1!==n.indexOf("Edge")||-1!==n.indexOf("Edg")?(t="Microsoft Edge",r=-1!==n.indexOf("Edge")?(e=n.indexOf("Edge"),n.substring(e+5)):(e=n.indexOf("Edg"),n.substring(e+4))):-1!==(e=n.indexOf("MSIE"))?(t="Microsoft Internet Explorer",r=n.substring(e+5)):-1!==(e=n.indexOf("Lark"))?(t="Lark",r=n.substring(e+5,e+11)):-1!==n.indexOf("Chrome")?-1!==(e=n.indexOf("TTWebView"))?(t="TTWebView",r=n.substring(e+10,e+23)):-1===(e=n.indexOf("Chrome"))&&-1===(e=n.indexOf("Chrome"))||(t="Chrome",r=n.substring(e+7)):-1!==n.indexOf("Safari")?-1!==(e=n.indexOf("Safari"))&&(t="Safari",r=n.substring(e+7),-1!==(e=n.indexOf("Version")))&&(r=n.substring(e+8)):-1!==(e=n.indexOf("Firefox"))&&(t="Firefox",r=n.substring(e+8)),{browser:t,browser_version:r=-1!==(n=(r=-1!==(n=(r=-1!==(n=r.indexOf(";"))?r.substring(0,n):r).indexOf(" "))?r.substring(0,n):r).indexOf(")"))?r.substring(0,n):r}},e.prototype.os=function(){for(var e="",t="",r=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"ChromeOS",r:/CrOS/},{s:"Linux",r:/(Linux|X11)/},{s:"Sun OS",r:/SunOS/}],n=0;n<r.length;n++){var i=r[n];if(i.r.test(this.userAgent)){"Mac OS X"===(e=i.s)&&this.isNewIpad()&&(e="iOS");break}}function o(e,t){return(e=e.exec(t))&&e[1]?e[1]:""}function s(e,t){return(e=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+e+")","i").exec(t))?e.slice(1)[0]:""}switch(/Windows/.test(e)&&(t=o(/Windows (.*)/,e),e="windows"),e){case"Mac OS X":t=s("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),e="mac";break;case"Android":t=o(/Android ([\.\_\d]+)/,a=this.userAgent)||o(/Android\/([\.\_\d]+)/,a),e="android";break;case"iOS":t=this.isNewIpad()?s("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(t=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?t[1]+"."+t[2]+"."+(0|t[3]):"",e="ios";break;case"chromeOS":var a=this.userAgent.indexOf("x86_64");t=this.userAgent.substring(a+7,a+16)}return{os_name:e,os_version:t}},e.prototype.getDeviceModel=function(e){var t,r,n="";try{"android"===e?navigator.userAgent.split(";").forEach((function(e){-1<e.indexOf("Build/")&&(n=e.slice(0,e.indexOf("Build/")))})):"ios"!==e&&"mac"!==e&&"windows"!==e||(n=this.isNewIpad()?"iPad":(r=(t=navigator.userAgent.replace("Mozilla/5.0 (","")).indexOf(";"),t.slice(0,r)))}catch(e){}return n.trim()},e.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&1<navigator.maxTouchPoints},e}(),D={sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},O={va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},E={sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z21z1ez4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z49z23z21z1cz18z21z22z4ez18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",ie2:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z1gz1cz4ez4az22z1gz1iz22z1mz1iz25z4az1cz23"},T={sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az22z1gz1iz22z1mz1iz25z4az23z21",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az22z1gz1iz22z1mz1iz24z4az23z21",ie:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z1gz1cz4az22z1gz1iz22z1mz1iz25z4az1cz23",ie2:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z1gz1cz4ez4az22z1gz1iz22z1mz1iz25z4az1cz23"},R=(function(e){e.Init="init",e.Config="config",e.Start="start",e.Ready="ready",e.TokenComplete="token-complete",e.TokenStorage="token-storage",e.TokenFetch="token-fetch",e.TokenError="token-error",e.ConfigUuid="config-uuid",e.ConfigWebId="config-webid",e.ConfigDomain="config-domain",e.CustomWebId="custom-webid",e.TokenChange="token-change",e.TokenReset="token-reset",e.ConfigTransform="config-transform",e.EnvTransform="env-transform",e.SessionReset="session-reset",e.SessionResetTime="session-reset-time",e.Event="event",e.Events="events",e.EventNow="event-now",e.CleanEvents="clean-events",e.BeconEvent="becon-event",e.SubmitBefore="submit-before",e.SubmitScuess="submit-scuess",e.SubmitAfter="submit-after",e.SubmitError="submit-error",e.SubmitVerify="submit-verify",e.DestoryInstance="destory-instance",e.Stay="stay",e.ResetStay="reset-stay",e.StayReady="stay-ready",e.SetStay="set-stay",e.RouteChange="route-change",e.RouteReady="route-ready",e.Ab="ab",e.AbVar="ab-var",e.AbAllVars="ab-all-vars",e.AbConfig="ab-config",e.AbExternalVersion="ab-external-version",e.AbVersionChangeOn="ab-version-change-on",e.AbVersionChangeOff="ab-version-change-off",e.AbOpenLayer="ab-open-layer",e.AbCloseLayer="ab-close-layer",e.AbReady="ab-ready",e.AbComplete="ab-complete",e.AbTimeout="ab-timeout",e.Profile="profile",e.ProfileSet="profile-set",e.ProfileSetOnce="profile-set-once",e.ProfileUnset="profile-unset",e.ProfileIncrement="profile-increment",e.ProfileAppend="profile-append",e.ProfileClear="profile-clear",e.Autotrack="autotrack",e.AutotrackReady="autotrack-ready",e.CepReady="cep-ready",e.TracerReady="tracer-ready",e.sessionRecord="session-record",e.SessionRecordStart="session-record-start",e.SessionRecordPause="session-record-pause",e.SessionRecordEnd="session-record-end",e.SessionRecordReport="session-record-report",e.VisualCollectReady="visual-collect-ready",e.VisualApiReady="visual-api-ready",e.VisualApiUpdate="visual-api-update"}(K=K||{}),function(e){e.DEBUGGER_MESSAGE="debugger-message",e.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",e.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",e.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",e.DEBUGGER_MESSAGE_EVENT="debugger-message-event",e.DEVTOOL_WEB_READY="devtool-web-ready"}(g=g||{}),K),L=void 0,C=(t=(new Date).getTimezoneOffset(),parseInt(""+-t/60,10)),P=60*t,A=function(){function e(e,t){this.is_first_time=!0,this.configPersist=!1,this.initConfig=t,this.collect=e,e=new Y(t.app_id,t.cookie_domain||"",t.cookie_expire||6048e5).init();var r="__tea_cache_first_"+t.app_id;this.configKey="__tea_cache_config_"+t.app_id,this.sessionStorage=new x(!1,"session"),this.localStorage=new x(!1,"local"),this.channelUrl="tcpy"===t.channel_type||"ttp"===t.channel_type?{WEBID_URL:"/v1/user/webid",TOB_URL:"",REPORT_URL:"/v1/list"}:{WEBID_URL:"/webid",TOB_URL:"/tobid",REPORT_URL:"/list"},t.configPersist&&(this.configPersist=!0,this.storage=1===t.configPersist?this.sessionStorage:this.localStorage),(t=this.localStorage.getItem(r))&&1==t?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(r,"1")),this.envInfo={user:{user_unique_id:L,user_type:L,user_id:L,user_is_auth:L,user_is_login:L,device_id:L,web_id:L,ip_addr_id:L,user_unique_id_type:L},header:{app_id:L,app_name:L,app_install_id:L,install_id:L,app_package:L,app_channel:L,app_version:L,ab_version:L,os_name:e.os_name,os_version:e.os_version,device_model:e.device_model,ab_client:L,traffic_type:L,client_ip:L,device_brand:L,os_api:L,access:L,language:e.language,region:L,app_language:L,app_region:L,creative_id:e.utm.creative_id,ad_id:e.utm.ad_id,campaign_id:e.utm.campaign_id,log_type:L,rnd:L,platform:e.platform,sdk_version:"5.2.0_oversea",sdk_lib:"js",province:L,city:L,timezone:C,tz_offset:P,tz_name:L,sim_region:L,carrier:L,resolution:e.screen_width+"x"+e.screen_height,browser:e.browser,browser_version:e.browser_version,referrer:e.referrer,referrer_host:e.referrer_host,width:e.screen_width,height:e.screen_height,screen_width:e.screen_width,screen_height:e.screen_height,utm_term:e.utm.utm_term,utm_content:e.utm.utm_content,utm_source:e.utm.utm_source,utm_medium:e.utm.utm_medium,utm_campaign:e.utm.utm_campaign,tracer_data:JSON.stringify(e.utm.tracer_data),custom:{}}},this.ab_version="",this.ab_uuid_cache={},this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(e),this.initDomain(),this.initABData()}return e.prototype.initDomain=function(e){var t=this.initConfig.channel_domain;t?this.domain=t:(t=e||this.initConfig.channel,(e=(this.initConfig&&this.initConfig.channel_type?"tcpy"===this.initConfig.channel_type?E:T:D)[t])||(console.warn("current channel: "+t+" is not exist, use va instead, please check!!!!"),e=D.sg),this.domain=l(e))},e.prototype.setDomain=function(e){this.customDomain=!0,this.domain=e},e.prototype.getDomain=function(e){return this.customDomain||e&&this.initDomain(e),this.domain},e.prototype.initABData=function(){var e="__tea_sdk_ab_version_"+this.initConfig.app_id;e=this.localStorage.getItem(e),this.setAbCache(e)},e.prototype.setAbCache=function(e){this.ab_cache=e},e.prototype.getAbCache=function(){return this.ab_cache},e.prototype.clearAbCache=function(){this.ab_cache={},this.ab_version=""},e.prototype.setAbVersion=function(e){this.ab_version=e},e.prototype.getAbVersion=function(){return this.ab_version},e.prototype.setAbUuidCache=function(e,t){t=t||this.envInfo.user.user_unique_id,this.ab_uuid_cache[""+t]||(this.ab_uuid_cache[""+t]=[]),-1===this.ab_uuid_cache[""+t].indexOf(e)&&this.ab_uuid_cache[""+t].push(e)},e.prototype.getAbUuidCache=function(e){return this.ab_uuid_cache[""+e]},e.prototype.getUrl=function(e){var t="";switch(e){case"event":t=this.channelUrl.REPORT_URL;break;case"webid":t=this.channelUrl.WEBID_URL;break;case"tobid":t=this.channelUrl.TOB_URL}return e="",this.initConfig.caller&&(e="?sdk_version=5.2.0_oversea&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+t+e},e.prototype.setCustom=function(e){if(e&&e.latest_data&&e.latest_data.isLast)for(var t in delete e.latest_data.isLast,this.isLast=!0,e.latest_data)this.envInfo.header.custom[t]=e.latest_data[t]},e.prototype.setAppid=function(e){this.envInfo.header.app_id=e},e.prototype.set=function(e){var t=this;Object.keys(e).forEach((function(r){var n,i,o;void 0!==e[r]&&null!==e[r]||t.delete(r),"traffic_type"===r&&t.isLast&&(t.envInfo.header.custom.$latest_traffic_source_type=e[r]),"evtParams"===r?t.evtParams=a(a({},t.evtParams||{}),e.evtParams||{}):"_staging_flag"===r?t.evtParams=a(a({},t.evtParams||{}),{_staging_flag:e._staging_flag}):"reportErrorCallback"===r&&"function"==typeof e[r]?t.reportErrorCallback=e[r]:(o=i="",-1<r.indexOf(".")&&(i=(n=r.split("."))[0],o=n[1]),i?"user"===i||"header"===i?t.envInfo[i][o]=e[r]:t.envInfo.header.custom[o]=e[r]:Object.hasOwnProperty.call(t.envInfo.user,r)?-1<["user_type","ip_addr_id"].indexOf(r)?t.envInfo.user[r]=e[r]&&Number(e[r]):-1<["user_id","web_id","user_unique_id","user_unique_id_type"].indexOf(r)?t.envInfo.user[r]=e[r]&&String(e[r]):-1<["user_is_auth","user_is_login"].indexOf(r)?t.envInfo.user[r]=Boolean(e[r]):"device_id"===r&&(t.envInfo.user[r]=e[r]):Object.hasOwnProperty.call(t.envInfo.header,r)?t.envInfo.header[r]=e[r]:t.envInfo.header.custom[r]=e[r])}))},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:Object.hasOwnProperty.call(this.envInfo.user,e)?this.envInfo.user[e]:Object.hasOwnProperty.call(this.envInfo.header,e)?this.envInfo.header[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){console.log("get config stringify error "),this.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:e.message})}},e.prototype.setStore=function(e){try{var t,r;this.configPersist&&(t=this.storage.getItem(this.configKey)||{})&&Object.keys(e).length&&(r=Object.assign(e,t),this.storage.setItem(this.configKey,r))}catch(e){console.log("setStore error"),this.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:e.message})}},e.prototype.getStore=function(){try{var e;return this.configPersist&&(e=this.storage.getItem(this.configKey)||{})&&Object.keys(e).length?e:null}catch(e){return this.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:e.message}),null}},e.prototype.delete=function(e){try{var t;this.configPersist&&(t=this.storage.getItem(this.configKey)||{})&&Object.hasOwnProperty.call(t,e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){this.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:e.message}),console.log("delete error")}},e}(),z=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}return e.prototype.info=function(e){this.isLog&&console.log("%c %s","color: yellow; background-color: black;","[Tea instance: "+this.name+"] "+e)},e.prototype.warn=function(e){this.isLog&&console.warn("%c %s","color: #4D1B00; background-color: #FF7D00;","[Tea instance: "+this.name+"] "+e)},e.prototype.error=function(e){this.isLog&&console.error("%c %s","color: #FFF; background-color: #F53F3F;","[Tea instance: "+this.name+"] "+e)},e.prototype.throw=function(e){throw this.error(this.name),new Error(e)},e}(),B=function(){function e(){this.spiderBot=["Baiduspider","googlebot","360Spider","haosouspider","YoudaoBot","Yisouspider","Googlebot","Headless","Applebot","Bingbot","PetalBot"]}return e.prototype.checkSpider=function(e){var t,r;return!!e.enable_spider&&(!(t=window.navigator.userAgent)||(r=!1,this.spiderBot.forEach((function(e){-1!==t.indexOf(e)&&(r=!0)})),r))},e}(),I=function(){function e(e,t){this.collect=e,this.native=t}var t=e.prototype;return t.bridgeInject=function(){try{return!!this.native&&(AppLogBridge?(console.log("AppLogBridge is injected"),!0):(console.log("AppLogBridge is not inject"),!1))}catch(e){return console.log("AppLogBridge is not inject"),!1}},t.bridgeReady=function(){var e=this;return new Promise((function(t,r){try{e.bridgeInject()?AppLogBridge.hasStarted((function(e){console.log("AppLogBridge is started? : "+e),e?t(!0):r(!1)})):r(!1)}catch(e){console.log("AppLogBridge, error:"+JSON.stringify(e.stack)),r(!1)}}))},t.setNativeAppId=function(e){try{AppLogBridge.setNativeAppId(JSON.stringify(e)),console.log("change bridge appid, event report with appid: "+e)}catch(e){console.error("setNativeAppId error")}},t.setConfig=function(e){var t=this;try{Object.keys(e).forEach((function(r){"user_unique_id"===r?t.setUserUniqueId(e[r]):e[r]?t.addHeaderInfo(r,e[r]):t.removeHeaderInfo(r)}))}catch(e){console.error("setConfig error")}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){console.error("setUserUniqueId error")}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){console.error("addHeaderInfo error")}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){console.error("setHeaderInfo error")}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){console.error("removeHeaderInfo error")}},t.reportPv=function(e){this.onEventV3("predefine_pageview",e)},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t),this.collect.emit(DebuggerMesssge.DEBUGGER_MESSAGE,{type:DebuggerMesssge.DEBUGGER_MESSAGE_EVENT,info:"bridge",time:Date.now(),data:[{events:[{event:e,params:t}]}],code:200,status:"success"})}catch(e){console.error("onEventV3 error")}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){console.error("profileSet error")}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){console.error("profileSetOnce error")}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){console.error("profileIncrement error")}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){console.error("profileUnset error")}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){console.error("profileAppend error")}},e}(),j=function(){function e(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return e.prototype.apply=function(e,t){var r=this;this.collect=e,this.config=t,this.configManager=e.configManager,this.cacheStorgae=new x(!0),this.localStorage=new x(!1),this.maxReport=t.max_report||10,this.reportTime=t.reportTime||30,this.timeout=t.timeout||1e5,this.enable_ttwebid=t.enable_ttwebid,this.reportUrl=t.report_url||this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.refer_key="__tea_cache_refer_"+this.configManager.get("app_id"),this.collect.on(R.Ready,(function(){r.reportAll(!1)})),this.collect.on(R.ConfigDomain,(function(){r.reportUrl=r.configManager.getUrl("event")})),this.collect.on(R.Event,(function(e){r.event(e)})),this.collect.on(R.BeconEvent,(function(e){r.beconEvent(e)})),this.collect.on(R.CleanEvents,(function(){r.reportAll(!1)})),this.linster()},e.prototype.linster=function(){var e,t=this;window.addEventListener("unload",(function(){t.reportAll(!0)}),!1),e=function(){t.reportAll(!0)},navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&t.reportAll(!0)}),!1)},e.prototype.reportAll=function(e){this.report(e),this.reportBecon()},e.prototype.event=function(e){var t=this;try{var r,n=c(e,this.cacheStorgae.getItem(this.eventKey)||[]);this.cacheStorgae.setItem(this.eventKey,n),this.reportTimeout&&clearTimeout(this.reportTimeout),n.length>=this.maxReport?this.report(!1):(r=this.reportTime,this.reportTimeout=setTimeout((function(){t.report(!1),t.reportTimeout=null}),r))}catch(e){this.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e){e=c(e,this.cacheStorgae.getItem(this.beconKey)||[]),this.cacheStorgae.setItem(this.beconKey,e),this.collect.destroy||this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))},e.prototype.reportBecon=function(){var e;!this.collect.destroy&&this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(e=this.cacheStorgae.getItem(this.beconKey)||[])&&e.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))},e.prototype.report=function(e){var t;!this.collect.destroy&&this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(t=this.cacheStorgae.getItem(this.eventKey)||[]).length&&(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(t,e))},e.prototype.sliceEvent=function(e,t){if(e.length>this.eventLimit)for(var r=0;r<e.length;r+=this.eventLimit){var n=e.slice(r,r+this.eventLimit),i=this.split(this.merge(n));this.send(i,t)}else i=this.split(this.merge(e)),this.send(i,t)},e.prototype.handleRefer=function(){var e,t="";try{t=(this.config.spa||this.config.autotrack)&&(e=this.localStorage.getItem(this.refer_key)||{}).routeChange?e.refer_key:this.configManager.get("referrer")}catch(e){t=document.referrer}return t},e.prototype.merge=function(e,t){var r=this,n=(c=this.configManager.get()).header,i=c.user,o=(n.custom=JSON.stringify(n.custom),n.referrer=this.handleRefer(),this.configManager.get("evtParams")),s=this.configManager.get("user_unique_id_type"),c=e.map((function(e){try{Object.keys(o).length&&!t&&(e.params=a(a({},o),e.params)),s&&(e.params.$user_unique_id_type=s);var n,c,u=r.configManager.getAbCache(),l=i[r.config.ab_user_mode]||i.user_unique_id,f=r.configManager.getAbUuidCache(l);return u&&u.uuid&&u.uuid===l&&(n=r.configManager.getAbVersion(),r.config.enable_ab_uuid?f&&f.length&&(c=f.join(","),n)&&n.includes(c)&&(e.ab_sdk_version=n):n&&(e.ab_sdk_version=n)),e.session_id=r.collect.sessionManager.getSessionId(),e.params=JSON.stringify(e.params),e}catch(n){return r.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:n.message}),e}}));return((e=JSON.parse(JSON.stringify({events:c,user:i,header:n}))).local_time=Math.floor(Date.now()/1e3),e.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,e.verbose=1,c=[]).push(e),c},e.prototype.split=function(e){return e.map((function(e){var t=[];return t.push(e),t}))},e.prototype.send=function(e,t){var r=this;e.length&&!this.config.disable_track_event&&e.forEach((function(e){try{var n,i=JSON.parse(JSON.stringify(e)),o=(r.config.filter&&!(i=r.config.filter(i))&&console.warn("filter must return data !!"),r.collect.eventFilter&&i&&((i=r.collect.eventFilter(i))||console.warn("filterEvent api must return data !!")),i||e),s=JSON.parse(JSON.stringify(o));o.length&&(n=!0,o.forEach((function(e){e.events.length||(n=!1)})),n)&&(r.collect.emit(R.SubmitBefore,o),r.collect.emit(R.SubmitVerify,o),r.collect.requestManager.useRequest({url:r.reportUrl,data:o,success:function(e,t){e&&0!==e.e?(r.collect.emit(R.SubmitError,{type:"f_data",eventData:t,errorCode:e.e,response:e}),r.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_EVENT,info:"",time:Date.now(),data:s,code:e.e,failType:"",status:"fail"})):(r.collect.emit(R.SubmitScuess,{eventData:t,res:e}),r.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_EVENT,info:"",time:Date.now(),data:s,code:200,status:"success"}))},fail:function(e,t){r.configManager.get("reportErrorCallback")(e,t),r.collect.emit(R.SubmitError,{type:"f_net",eventData:e,errorCode:t}),r.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_EVENT,info:"",time:Date.now(),data:s,code:t,failType:"",status:"fail"})},timeout:r.timeout,useBeacon:!r.config.disable_sendbeacon&&t,withCredentials:r.enable_ttwebid}),r.collect.emit(R.SubmitAfter,o))}catch(e){console.warn("something error, "+JSON.stringify(e.stack)),r.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:e.message})}}))},e}(),H=function(){function e(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return e.prototype.apply=function(e,t){var r=this;this.collect=e,this.config=t,this.configManager=this.collect.configManager,this.storage=new x(!1),this.tokenKey="__tea_cache_tokens_"+t.app_id,this.enable_ttwebid=t.enable_ttwebid,this.enableCustomWebid=t.enable_custom_webid,this.collect.on(R.ConfigUuid,(function(e){r.setUuid(e)})),this.collect.on(R.ConfigWebId,(function(e){r.setWebId(e)})),this.enableCookie=t.cross_subdomain,this.expiresTime=t.cookie_expire||6048e5,this.cookieDomain=t.cookie_domain||"",this.checkStorage()},e.prototype.checkStorage=function(){var e=this;this.cacheToken=this.storage.getItem(this.tokenKey)||{},this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid?this.enableCustomWebid?this.collect.on(R.CustomWebId,(function(){e.tokenReady=!0,e.collect.emit(R.TokenComplete)})):this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},e.prototype.check=function(){this.cacheToken&&this.cacheToken.web_id?this.complete(this.cacheToken):this.config.disable_webid?this.complete({web_id:m(),user_unique_id:this.configManager.get("user_unique_id")||m()}):this.remoteWebid()},e.prototype.checkEnv=function(){var e=window.navigator.userAgent;return(-1!==e.indexOf("miniProgram")||-1!==e.indexOf("MiniProgram"))&&!(!(e=h(window.location.href))||!e.Web_ID||(this.complete({web_id:""+e.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+e.Web_ID}),0))},e.prototype.remoteWebid=function(){var e=this,t=this.configManager.getUrl("webid"),r={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""},n=(this.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"SDK WEBID",logType:"fetch",level:"info",time:Date.now(),data:r}),m());this.collect.requestManager.useRequest({url:t,data:r,success:function(t){var r;t&&0===t.e?(r=t.web_id,e.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"WEBID",logType:"fetch",level:"info",time:Date.now(),data:t})):(e.collect.configManager.set({localWebId:r=n}),e.collect.emit(R.TokenError),e.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"WEBID",logType:"fetch",level:"warn",time:Date.now(),data:t}),e.collect.logger.warn("appid: "+e.config.app_id+" get webid error, use local webid~")),e.complete({web_id:e.configManager.get("web_id")||r,user_unique_id:e.configManager.get("user_unique_id")||r})},fail:function(){e.complete({web_id:e.configManager.get("web_id")||n,user_unique_id:e.configManager.get("user_unique_id")||n}),e.collect.configManager.set({localWebId:n}),e.collect.emit(R.TokenError),e.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"WEBID",logType:"fetch",level:"error",time:Date.now(),data:null}),e.collect.logger.warn("appid: "+e.config.app_id+", get webid error, use local webid~")},timeout:3e5})},e.prototype.complete=function(e){var t=e.web_id,r=e.user_unique_id;e.timestamp=Date.now(),this.collect.configManager.set({web_id:t,user_unique_id:r}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(R.TokenComplete)},e.prototype.completeTtWid=function(e){var t=e.user_unique_id||"",r=this.configManager.get("user_unique_id");(r||t)&&this.configManager.set({user_unique_id:r||t}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(R.TokenComplete)},e.prototype.setUuid=function(e){var t,r;e&&-1===["null","undefined","Null","None"].indexOf(e)?(e=String(e),t=this.configManager.get("user_unique_id"),r=this.cacheToken&&this.cacheToken.user_unique_id,e===t&&e===r||(this.configManager.set({user_unique_id:e}),this.cacheToken||(this.cacheToken={}),this.cacheToken.user_unique_id=e,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(R.TokenChange,"uuid"),this.collect.emit(R.SessionReset))):this.clearUuid()},e.prototype.clearUuid=function(){this.config.enable_ttwebid||this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(R.TokenReset))},e.prototype.setWebId=function(e){var t,r;e&&!this.config.enable_ttwebid&&(this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==e&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?e:this.cacheToken.user_unique_id,this.cacheToken.web_id=e):(this.cacheToken={},this.cacheToken.web_id=e,this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now(),t=this.configManager.get("web_id"),(r=this.configManager.get("user_unique_id"))&&r!==t||(this.configManager.set({user_unique_id:e}),this.collect.emit(R.TokenChange,"uuid")),t!==e&&(this.configManager.set({web_id:e}),this.collect.emit(R.TokenChange,"webid")),this.setStorage(this.cacheToken))},e.prototype.setStorage=function(e){e._type_=this.enableCustomWebid?"custom":"default",delete e["diss".split("").reverse().join("")],this.storage.setItem(this.tokenKey,e),this.cacheToken=e},e.prototype.getReady=function(){return this.tokenReady},e.prototype.getTobId=function(){var e=this;return new Promise((function(t){"tcpy"!==e.config.channel_type&&"ttp"!==e.config.channel_type?e.collect.requestManager.useRequest({url:e.configManager.getUrl("tobid"),data:{app_id:e.config.app_id,user_unique_id:e.configManager.get("user_unique_id"),web_id:e.configManager.get("web_id"),user_unique_id_type:e.configManager.get("user_unique_id_type")},success:function(e){e&&0===e.e?t(e.tobid):t("")},fail:function(){t("")},time:3e4,withCredentials:e.enable_ttwebid}):t("")}))},e}(),U=function(){function e(){}return e.prototype.apply=function(e,t){var r=this;this.collect=e,this.storage=new x(!1,"session"),this.sessionKey="__tea_session_id_"+t.app_id,this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSessionTimeCheck=t.disable_session_check,this.disableSession||(this.setSessionId(),this.collect.on(R.SessionReset,(function(e){r.resetSessionId(e)})),this.collect.on(R.SessionResetTime,(function(){r.updateSessionIdTime()})))},e.prototype.updateSessionIdTime=function(){var e,t=this.storage.getItem(this.sessionKey);t&&t.sessionId&&(e=t.timestamp,Date.now()-e>this.expireTime?t={sessionId:y(),timestamp:Date.now()}:t.timestamp=Date.now(),this.storage.setItem(this.sessionKey,t),this.resetExpTime())},e.prototype.setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:y(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.disableSessionTimeCheck||(this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return!this.disableSession&&e&&e.sessionId?e.sessionId:""},e.prototype.resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.resetSessionId=function(e){e={sessionId:e||y(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e)},e.prototype.checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:y(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),N=function(){function e(e,t){this.collector=e,this.config=t,this.requestType=t.request_type||"xhr",this.supportBeacon=!(!window.navigator||!window.navigator.sendBeacon),this.errorCode={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005},this.customHeader=t.custom_request_header||{}}return e.prototype.useFetch=function(e){var t=e.url,r=e.data,n=e.method,i=e.success,o=e.fail,s={"Content-Type":"application/json; charset=utf-8"};if(Object.keys(this.customHeader).length)for(var a in this.customHeader)s[a]=this.customHeader[a];window.fetch?fetch(t,{method:n||"POST",headers:s,body:JSON.stringify(r)}).then((function(e){return e.json()})).then((function(e){i&&i(e)})).catch((function(e){o&&o(r,e)})):(this.requestType="xhr",console.log("your brwoser not support fetch, use xhr"),this.useRequest({url:t,data:r,method:n,success:i,fail:o}))},e.prototype.useBeacon=function(e){var t=e.url,r=e.data,n=e.success;e=e.fail,window.navigator.sendBeacon(t,JSON.stringify(r))?n&&n():e&&e(r,this.errorCode.BEACON_FALSE)},e.prototype.useRequest=function(e){var t=this,r=e.url,n=e.data,i=e.method,o=e.success,s=e.fail,a=e.timeout,c=e.useBeacon,u=e.withCredentials,l=e.app_key,f=e.forceXhr;if(c&&this.supportBeacon)this.useBeacon({url:r,data:n,method:i,success:o,fail:s});else if("fetch"!==this.requestType||f)try{var h=new XMLHttpRequest,p=i||"POST";if(h.open(p,""+r,!0),h.setRequestHeader("Content-Type","application/json; charset=utf-8"),l&&h.setRequestHeader("X-MCS-AppKey",""+l),Object.keys(this.customHeader).length)for(var d in this.customHeader)h.setRequestHeader(d,this.customHeader[d]);u&&(h.withCredentials=!0),a&&(h.timeout=a,h.ontimeout=function(){s&&s(n,t.errorCode.TIMEOUT)}),h.onload=function(){if(o){var e=null;if(h.responseText){try{e=JSON.parse(h.responseText)}catch(t){e={}}o(e,n)}}},h.onerror=function(){h.abort(),s&&s(n,t.errorCode.XHR_ON)},h.send(JSON.stringify(n))}catch(e){}else this.useFetch({url:r,data:n,method:i,success:o,fail:s})},e}(),F=function(){function e(e,t){this.devToolReady=!1,this.devToolOrigin="*",this.sendAlready=!1,t.enable_debug&&(this.collect=e,this.config=t,this.app_id=t.app_id,t=e.adapters.storage,this.cacheStorgae=new t(!1,"session"),this.filterEvent=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","bav2b_page","bav2b_beat","bav2b_page_statistics","bav2b_click","bav2b_page_exposure","_be_active","predefine_pageview","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append","predefine_page_alive","predefine_page_close","abtest_exposure"],this.load())}return e.prototype.loadScript=function(e){try{var t=document.createElement("script");t.src=e,t.onerror=function(){console.log("load DevTool render fail")},t.onload=function(){console.log("load DevTool render success")},document.getElementsByTagName("body")[0].appendChild(t)}catch(e){console.log("devTool load fail, "+e.message)}},e.prototype.parseUrl=function(){var e={};try{var t=window.location.href.split("?")[1].split("&");t.length&&t.forEach((function(t){t=t.split("="),e[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}))}catch(e){}return e},e.prototype.load=function(){try{var e=this.parseUrl();if(e.open_devtool_web&&e.app_id){if(parseInt(e.app_id)!==this.app_id)return}else if(!this.getStorage())return;this.loadBaseInfo(),this.loadHook(),this.setStorage(),this.addLintener(),this.loadDebuggerModule(),this.loadDevTool()}catch(e){console.log("debug fail, "+e.message)}},e.prototype.getStorage=function(){var e=this.cacheStorgae.getItem("__applog_devtool_web");return e&&parseInt(e)===this.app_id},e.prototype.setStorage=function(){this.cacheStorgae.setItem("__applog_devtool_web",this.app_id)},e.prototype.loadDevTool=function(){this.loadScript("https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/devtool/debug-web.js")},e.prototype.loadBaseInfo=function(){var e=this;this.info=[{title:"",type:1,infoName:{app_id:this.config.app_id,channel:this.config.channel,:this.collect.configManager.getDomain(),SDK:"5.2.0_oversea",SDK:"npm"}},{title:"",type:2,infoName:{uuid:this.collect.configManager.get("user").user_unique_id||"",web_id:this.collect.configManager.get("user").web_id||"",ssid:"SSID"}},{title:"",type:2,infoName:{:this.collect.configManager.get("browser"),:this.collect.configManager.get("browser_version"),:this.collect.configManager.get("platform"),:this.collect.configManager.get("device_model"),:this.collect.configManager.get("os_name"),:this.collect.configManager.get("os_version"),:this.collect.configManager.get("os_version"),:this.collect.configManager.get("referrer"),:""}},{title:"",type:3,infoName:{:!!this.config.autotrack,:!!this.config.enable_stay_duration}},{title:"A/B",type:4,infoName:{"A/B":!!this.config.enable_ab_test}},{title:"",type:3,infoName:{:!!this.config.Native}}],this.log=[],this.event=[],this.collect.on(R.Ready,(function(){e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id,e.info[2].infoName[""]=JSON.stringify(e.collect.configManager.get("custom")),e.config.enable_ab_test&&(e.info[4].infoName["VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["A/B"]=e.config.ab_channel_domain||l(O[e.config.channel]),e.info[4].infoName[""]=e.collect.configManager.getAbData()),e.config.Native&&(e.info[5].infoName[""]=!!e.collect.bridgeReport)}))},e.prototype.loadHook=function(){var e=this;this.collect.on(g.DEBUGGER_MESSAGE,(function(t){switch(t.type){case g.DEBUGGER_MESSAGE_SDK:var r={time:t.time,type:t.logType||"sdk",level:t.level,name:t.info,show:!0,levelShow:!0,needDesc:!!t.data};return t.data&&(r.desc={content:JSON.stringify(t.data)}),e.updateLog(r),t.secType&&"AB"===t.secType?(e.info[4].infoName["VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName[""]=e.collect.configManager.getAbData()):"USER"===t.secType&&(e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id),void e.updateInfo();case g.DEBUGGER_MESSAGE_EVENT:if(t.data&&t.data.length){var n=(r=t.data[0]).events;if(!n.length)return;n.forEach((function(r){r.checkShow=!0,r.searchShow=!0,r.success=t.status,r.type=-1!==e.filterEvent.indexOf(r.event)?"sdk":"cus",r.type=e.collect.bridgeReport?"bridge":r.type,r.info="","fail"===t.status&&(r.info={message:"code: "+t.code+" msg: "+t.failType})})),e.updateEvent(r)}return}}))},e.prototype.addLintener=function(){var e=this;window.addEventListener("message",(function(t){if(t.origin===location.origin){if(t&&t.data&&"devtool:web:ready"===t.data.type){if(e.devToolOrigin=t.origin,e.devToolReady=!0,e.sendAlready)return;console.log("inittttt"),e.sendData("devtool:web:init",{info:e.info,log:e.log,event:e.event}),e.sendAlready=!0}t&&t.data&&"devtool:web:ssid"===t.data.type&&e.collect.getToken((function(t){e.info[1].infoName.ssid=t.tobid,e.updateInfo()}))}}))},e.prototype.sendData=function(e,t){try{var r={type:e,payload:t};(window.opener||window.parent).postMessage(r,this.devToolOrigin)}catch(e){}},e.prototype.updateInfo=function(){this.devToolReady&&this.sendData("devtool:web:info",this.info)},e.prototype.updateLog=function(e){this.devToolReady?this.sendData("devtool:web:log",e):this.log.push(e)},e.prototype.updateEvent=function(e){this.devToolReady?this.sendData("devtool:web:event",e):this.event.push(e)},e.prototype.loadDebuggerModule=function(){var e,t=document.head||document.getElementsByTagName("head")[0];(e=document.createElement("style")).appendChild(document.createTextNode("#debugger-applog-web {\n      position: absolute;\n      width: 90px;\n      height: 30px;\n      background: #23c243;\n      border-radius: 6px;\n      color: #fff;\n      font-size: 12px;\n      bottom: 5%;\n      right: 10%;\n      text-align: center;\n      line-height: 30px;\n      cursor: pointer;\n      z-index:100;\n    }")),t.appendChild(e),((t=document.createElement("div")).innerHTML='<div id="debugger-applog-web" class="debugger-applog-web">AppLog</div>',e=document.createElement("div")).innerHTML='<div id="debugger-container" class="debugger-container"></div>',document.getElementsByTagName("body")[0].appendChild(t),document.getElementsByTagName("body")[0].appendChild(e),document.getElementById("debugger-applog-web").addEventListener("click",(function(){(window.opener||window.parent).postMessage({type:"devtool:web:open-draw"},location.origin)}))},e}(),G={autotrack:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/autotrack.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/autotrack.js"},object:"LogAutoTrack"},ab:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/ab.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/ab.js"},object:"LogAb"},stay:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/stay.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/stay.js"},object:"LogStay"},route:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/route.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/route.js"},object:"LogRoute"},tracer:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/tracer.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/tracer.js"},object:"LogTracer"},retry:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/retry.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/retry.js"},object:"LogRetry"},visual:{src:{sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/visual.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/visual.js"},object:"LogVisual"}},J=["et","profile","heartbeat","monitor"],K=function(){function e(e){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroy=!1,this.sdkReady=!1,this.adapters={},this.loadType="base",this.name=e,this.hook=new _,this.remotePlugin=new Map,this.Types=R,this.adapters.storage=x}return e.usePlugin=function(t,r,n){if(r){for(var i=!1,o=0,s=e.plugins.length;o<s;o++)if(e.plugins[o].name===r){e.plugins[o].plugin=t,e.plugins[o].options=n||{},i=!0;break}i||e.plugins.push({name:r,plugin:t,options:n})}else e.plugins.push({plugin:t})},e.prototype.usePlugin=function(e,t,r){e&&("full"===this.loadType&&J.includes(e)?console.info("your sdk version has "+e+" already ~"):t?"string"==typeof t?this.remotePlugin.get(e)||this.remotePlugin.set(e,{src:t,call:r}):this.remotePlugin.get(e)||this.remotePlugin.set(e,{instance:t}):this.remotePlugin.get(e)||this.remotePlugin.set(e,"sdk"))},e.prototype.init=function(t){var r,n=this;try{r=JSON.parse(JSON.stringify(t))}catch(e){r=t}this.logger=new z(this.name,r.log),this.inited?this.logger.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!"):r&&u(r)?r.app_id&&"number"==typeof(t=r.app_id)&&!isNaN(t)?r.app_key&&"string"!=typeof r.app_key?this.logger.warn("app_key param is error, must be string, please check!"):(t=["sg","va","in","ie","ie2"],r.channel_domain||-1!==t.indexOf(r.channel)||(this.logger.warn("your channel: "+r.channel+" is not exist. channel must be one of "+t.join(",")+", use sg instead, please check!!!"),r.channel="sg"),this.spider=new B,this.spider.checkSpider(r)?this.logger.warn("The current environment may be a spider, can not report!"):(this.appBridge=new I(this,r.enable_native),this.requestManager=new N(this,r),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new A(this,r),this.debugger=new F(this,r),this.initConfig=r,this.emit(R.Init),this.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"SDK INIT",data:r,level:"info",time:Date.now()}),r.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport||(this.configManager.setAppid(r.app_id),this.eventManager=new j,this.tokenManager=new H,this.sessionManager=new U,Promise.all([new Promise((function(e){n.once(R.TokenComplete,(function(){e(!0)}))})),new Promise((function(e){n.once(R.Start,(function(){e(!0)}))}))]).then((function(){try{e.plugins.reduce((function(e,t){var r=t.plugin;return t=t.options,t=Object.assign(n.initConfig,t),(r=new r).apply(n,t),e.push(r),e}),n.pluginInstances)}catch(e){console.warn("load plugin error, "+e.message),n.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:e.message})}n.sdkReady=!0,n.emit(R.Ready),n.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"SDK ",time:Date.now(),level:"info",data:n.configManager.get("user")}),n.logger.info("appid: "+r.app_id+", userInfo:"+JSON.stringify(n.configManager.get("user"))),n.logger.info("appid: "+r.app_id+", sdk is ready, version is 5.2.0_oversea, you can report now !!!"),r.disable_auto_pv&&(n.disableAutoPageView=!0);try{("full"===n.loadType&&r.enable_ab_test||r.autotrack)&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){n.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:e.message})}n.pageView(),n.on(R.TokenChange,(function(e){"webid"===e&&n.pageView(),n.logger.info("appid: "+r.app_id+" token change, new userInfo:"+JSON.stringify(n.configManager.get("user"))),n.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"SDK ",time:Date.now(),secType:"USER",level:"info",data:n.configManager.get("user")})})),n.on(R.TokenReset,(function(){n.logger.info("appid: "+r.app_id+" token reset, new userInfo:"+JSON.stringify(n.configManager.get("user"))),n.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"SDK ",time:Date.now(),secType:"USER",level:"info",data:n.configManager.get("user")})})),n.on(R.RouteChange,(function(e){e.init||r.disable_route_report||n.pageView()}))})),this.tokenManager.apply(this,r),this.eventManager.apply(this,r),this.sessionManager.apply(this,r)),this.inited=!0)):this.logger.warn("app_id param is error, must be number, please check!"):this.logger.warn("init params error,please check")},e.prototype.config=function(e){if(this.inited)if(e&&u(e)){var t,r;try{t=JSON.parse(JSON.stringify(t))}catch(r){t=e}this.bridgeReport?this.appBridge.setConfig(t):(t._staging_flag&&1===t._staging_flag&&(this.staging=!0),t.disable_auto_pv&&(this.disableAutoPageView=!0,delete t.disable_auto_pv),e=a({},t),this.initConfig&&this.initConfig.configPersist&&((r=this.configManager.getStore())&&(e=Object.assign(r,t)),this.configManager.setStore(t)),e.web_id,e.user_unique_id,r=function(e,t){var r={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&(r[i[n]]=e[i[n]]);return r}(e,["web_id","user_unique_id"]),e.hasOwnProperty("web_id")&&this.emit(R.ConfigWebId,e.web_id),e.hasOwnProperty("user_unique_id")&&this.emit(R.ConfigUuid,e.user_unique_id),this.configManager.set(r),this.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"SDK CONFIG",level:"info",time:Date.now(),data:e}))}else console.warn("config params is error, please check");else console.warn("config must be use after function init")},e.prototype.setDomain=function(e){this.configManager&&this.configManager.setDomain(e),this.emit(R.ConfigDomain)},e.prototype.getConfig=function(e){return this.configManager.get(e)},e.prototype.send=function(){this.start()},e.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.emit(R.Start),this.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"SDK START",level:"info",time:Date.now()}),this.bridgeReport)&&(this.pageView(),this.emit(R.Ready))},e.prototype.event=function(e,t){var r=this;try{var n=[];if(Array.isArray(e))e.forEach((function(e){(e=r.processEvent(e[0],e[1]||{}))&&n.push(e)}));else{var i=this.processEvent(e,t);if(!i)return;n.push(i)}this.bridgeReport?n.forEach((function(e){var t=e.event;e=e.params,r.appBridge.onEventV3(t,JSON.stringify(e))})):n.length&&(this.emit(R.Event,n),this.emit(R.SessionResetTime))}catch(e){this.logger.warn("something error, please check"),this.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e,t){var r;Array.isArray(e)?this.logger.warn("beconEvent not support batch report, please check"):(r=[],(e=this.processEvent(e,t||{}))&&(r.push(e),r.length)&&(this.emit(R.BeconEvent,r),this.emit(R.SessionResetTime)))},e.prototype.beaconEvent=function(e,t){this.beconEvent(e,t)},e.prototype.processEvent=function(e,t){void 0===t&&(t={});try{var r,n,i;return e?(/^event\./.test(r=e)&&(r=e.slice(6)),i=void((n="object"!=typeof(n=t)?{}:n).profile?delete n.profile:n.event_index=v+=1),n.local_ms?(i=n.local_ms,delete n.local_ms):i=+new Date,{event:r,params:n,local_time_ms:i,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}):(console.warn("eventName is null please check"),null)}catch(r){return this.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:r.message}),{event:e,params:t}}},e.prototype.filterEvent=function(e){this.eventFilter=e},e.prototype.on=function(e,t){this.hook.on(e,t)},e.prototype.once=function(e,t){this.hook.once(e,t)},e.prototype.off=function(e,t){this.hook.off(e,t)},e.prototype.emit=function(e,t,r){this.hook.emit(e,t,r)},e.prototype.set=function(e){this.hook.set(e)},e.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},e.prototype.predefinePageView=function(e){var t;void 0===e&&(e={}),this.inited?(t={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+(this.configManager&&this.configManager.is_first_time||!1)},t=a(a({},t),e),this.event("predefine_pageview",t)):console.warn("predefinePageView should call after init")},e.prototype.clearEventCache=function(){this.emit(R.CleanEvents)},e.prototype.setWebId=function(e){this.config({web_id:""+e})},e.prototype.setNativeAppId=function(e){this.bridgeReport&&this.appBridge.setNativeAppId(e)},e.prototype.getSessionId=y,e.prototype.setSessionId=function(e){this.emit(R.SessionReset,e)},e.prototype.resetStayDuration=function(e,t,r){this.emit(R.ResetStay,{url_path:e,title:t,url:r},R.Stay)},e.prototype.resetStayParams=function(e,t,r){this.emit(R.SetStay,{url_path:e=void 0===e?"":e,title:t=void 0===t?"":t,url:r=void 0===r?"":r},R.Stay)},e.prototype.getToken=function(e,t){var r,n,i,o=this;this.inited?(r=!1,n=function(t){var n;if(!r)return r=!0,n=o.configManager.get().user,t&&(n.tobid=t,n["diss".split("").reverse().join("")]=t),e(a({},n))},i=function(){o.tokenManager.getTobId().then((function(e){n(e)}))},this.sdkReady?i():(t&&setTimeout((function(){n()}),t),this.on(R.Ready,(function(){i()})))):console.warn("predefinePageView should call after init")},e.prototype.profileSet=function(e){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(e)):this.emit(R.ProfileSet,e,R.Profile),this.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"SDK profileSet",level:"info",time:Date.now(),data:e})},e.prototype.profileSetOnce=function(e){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(e)):this.emit(R.ProfileSetOnce,e,R.Profile),this.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"SDK profileSetOnce",level:"info",time:Date.now(),data:e})},e.prototype.profileIncrement=function(e){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(e)):this.emit(R.ProfileIncrement,e,R.Profile),this.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"SDK profileIncrement",level:"info",time:Date.now(),data:e})},e.prototype.profileUnset=function(e){this.bridgeReport?this.appBridge.profileUnset(e):this.emit(R.ProfileUnset,e,R.Profile),this.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"SDK profileUnset",level:"info",time:Date.now(),data:e})},e.prototype.profileAppend=function(e){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(e)):this.emit(R.ProfileAppend,e,R.Profile),this.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"SDK profileAppend",level:"info",time:Date.now(),data:e})},e.prototype.setExternalAbVersion=function(e){this.emit(R.AbExternalVersion,"string"==typeof e&&e?(""+e).trim():null,R.Ab)},e.prototype.getVar=function(e,t,r,n){this.emit(R.AbVar,{name:e,defaultValue:t,callback:r,uuid:n},R.Ab)},e.prototype.getABconfig=function(e,t){this.emit(R.AbConfig,{params:e,callback:t},R.Ab)},e.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},e.prototype.onAbSdkVersionChange=function(e){var t=this;return this.emit(R.AbVersionChangeOn,e,R.Ab),function(){t.emit(R.AbVersionChangeOff,e,R.Ab)}},e.prototype.offAbSdkVersionChange=function(e){this.emit(R.AbVersionChangeOff,e,R.Ab)},e.prototype.openOverlayer=function(){this.emit(R.AbOpenLayer,"",R.Ab)},e.prototype.closeOverlayer=function(){this.emit(R.AbCloseLayer,"",R.Ab)},e.prototype.getAllVars=function(e){this.emit(R.AbAllVars,e,R.Ab)},e.prototype.destoryInstace=function(){this.destroy||(this.destroy=!0,this.off(R.TokenComplete),this.emit(R.DestoryInstance))},e.prototype.destroyInstance=function(){this.destroy||(this.destroy=!0,this.off(R.TokenComplete),this.emit(R.DestoryInstance))},e.plugins=[],e}(),V=(t=function(){function e(){}return e.prototype.apply=function(e,t){var r=this;t.event_verify_url&&("string"==typeof t.event_verify_url?(this.url=t.event_verify_url+"/v1/list_test",this.url&&(t=e.Types,e.on(t.SubmitBefore,(function(t){e.requestManager.useBeacon({url:r.url,data:t})})))):console.log("please use correct et_test url"))},e}(),function(){function e(){var e=this;this.setInterval=function(){e.clearIntervalFunc=function(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var r=Date.now()+t,n=window.setTimeout((function i(){var o=Date.now()-r;e(),r+=t,n=window.setTimeout(i,Math.max(0,t-o))}),t);return function(){window.clearTimeout(n)}}((function(){e.isSessionhasEvent&&e.endCurrentSession()}),e.sessionInterval)},this.clearInterval=function(){e.clearIntervalFunc&&e.clearIntervalFunc()}}return e.prototype.apply=function(e,t){var r=this;this.collect=e,t.disable_heartbeat||(this.sessionInterval=6e4,this.startTime=0,this.lastTime=0,this.setInterval(),e=this.collect.Types,this.collect.on(e.SessionReset,(function(){r.process()})))},e.prototype.endCurrentSession=function(){this.collect.event("_be_active",{start_time:this.startTime,end_time:this.lastTime,url:window.location.href,referrer:window.document.referrer,title:document.title||location.pathname}),this.isSessionhasEvent=!1,this.startTime=0},e.prototype.process=function(){this.isSessionhasEvent||(this.isSessionhasEvent=!0,this.startTime=+new Date);var e=this.lastTime||+new Date;this.lastTime=+new Date,this.lastTime-e>this.sessionInterval&&(this.clearInterval(),this.endCurrentSession(),this.setInterval())},e}()),q=function(){function e(){}return e.prototype.apply=function(e,t){var r=this;this.collect=e,this.config=t,this.config.channel_domain||t.disable_track_event||t.disable_sdk_monitor||(this.url=e.configManager.getUrl("event"),t=this.collect.Types,this.collect.on(t.Ready,(function(){r.sdkOnload()})),this.collect.on(t.SubmitError,(function(e){var t=e.type,n=e.eventData;e=e.errorCode,"f_data"===t&&r.sdkError(n,e)})))},e.prototype.sdkOnload=function(){var e=this;try{var t=this.collect.configManager.get(),r=t.header,n=t.user,i=r.app_id,o=r.app_name,s=r.sdk_version,a=n.web_id,c={events:[{event:"onload",params:JSON.stringify({app_id:i,app_name:o||"",sdk_version:s,sdk_type:"npm",sdk_config:this.config,sdk_desc:"TOC_OVERSEA"}),local_time_ms:Date.now()}],user:{user_unique_id:a},header:{}};setTimeout((function(){e.collect.requestManager.useRequest({url:e.url,data:[c],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})}),16)}catch(e){}},e.prototype.sdkError=function(e,t){var r=this;try{var n=e[0],i=n.user,o=n.header,s=[],a=(e.forEach((function(e){e.events.forEach((function(e){s.push(e)}))})),{events:s.map((function(e){return{event:"on_error",params:JSON.stringify({error_code:t,app_id:o.app_id,app_name:o.app_name||"",error_event:e.event,sdk_version:o.sdk_version,local_time_ms:e.local_time_ms,tea_event_index:Date.now(),params:e.params,header:JSON.stringify(o),user:JSON.stringify(i)}),local_time_ms:Date.now()}})),user:{user_unique_id:i.user_unique_id},header:{}});setTimeout((function(){r.collect.requestManager.useRequest({url:r.url,data:[a],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})}),16)}catch(e){}},e}(),W="undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null,X=function(){function e(){}return e.prototype.apply=function(e,t){this._plugin={},this.config=t,this.collect=e,this.channel=t.channel||"cn",this.loadExtend()},e.prototype.loadExtend=function(){var e=this;try{this.collect.remotePlugin.forEach((function(t,r){var n,i;"sdk"===t?G.hasOwnProperty(r)?(n=G[r].object,i=""+G[r].src[e.channel],e.exist(r,n,i)):console.warn("your "+r+" is not existplease check plugin name"):"object"==typeof t&&(t.src?e.exist(r,t.call,t.src):e.process(r,t.instance,"INSTANCE"))}))}catch(e){this.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:e.message}),console.log("load extend error")}},e.prototype.exist=function(e,t,r){var n=this;W[t]?(this.process(e,W[t]),console.log(""+e+"~")):this.loadPlugin(e,r,(function(){n.process(e,W[t]),console.log(" %c %s %s %s","color: yellow; background-color: black;","","load plugin:"+e+" success","-")}),(function(){console.log(" %c %s %s %s","color: red; background-color: yellow;","","load plugin:"+e+" error","-")}))},e.prototype.process=function(e,t,r){try{var n;r?((n=new t).apply&&n.apply(this.collect,this.config),console.log("excude "+e+" success")):t&&t(this.collect,this.config)}catch(t){this.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:t.message}),console.log("excude "+e+" error, message:"+t.message)}},e.prototype.loadPlugin=function(e,t,r,n){var i=this;try{var o=document.createElement("script");o.src=t,this._plugin[e]||(this._plugin[e]=[]),this._plugin[e].push(r),o.onerror=function(){n(t)},o.onload=function(){i._plugin[e].forEach((function(e){e()}))},document.getElementsByTagName("head")[0].appendChild(o)}catch(e){this.collect.emit(g.DEBUGGER_MESSAGE,{type:g.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:e.message})}},e}(),$=(K.usePlugin(X,"extend"),K.usePlugin(t,"et"),K.usePlugin(V,"heartbeat"),K.usePlugin(q,"monitor"),X=new K("default")),Q={selectRoute:900,browserError:1e3,crc32:1e3,preUpload:1001,initUploadID:1002,process:1003,fileMerge:1004,complete:1005},Z="video",ee="image",te="object",re={video:"video_upload",image:"image_upload",object:"object_upload"},ne="vod",ie="imagex";function oe(e){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(){return(se=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==oe(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==oe(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===oe(e)?e:String(e)}(n.key),n)}}var ce=function(){function e(t,r){switch(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.context=r,this.teaLog=$,this.options.region){case"us-east-1":case"us-east-2":case"us-east-5":case"us-east-red":case"gcp":case"US-TTP":default:this.tea_app_id=2643,this.tea_channel="va";break;case"boei18n":case"ap-singapore-1":this.tea_app_id=2643,this.tea_channel="sg"}this.teaLog.init({app_id:this.tea_app_id,channel:this.tea_channel,log:!1,disable_sdk_monitor:!0,disable_auto_pv:!0}),this.teaLog.config({evtParams:{sdk_version:"2.0.10"}}),this.setLineAppId(this.options.appId),this.setUserUniqueId(this.options.userId),this.teaLog.start()}return function(e,t,r){t&&ae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"send",value:function(e){var t=this.context,r=e.key,n=(t=t.tasks[r],Q[e.stage]||999),i=(t=e.fileType||t&&t.fileType,e.fileSize||0),o={log_type:re[t],stage:n,fk:r,fs:i,req:e.req,res:e.res,ts:Math.round(Date.now()/1e3),sst:e.stageStartTime,set:e.stageEndTime,dur:e.duration,tdur:e.totalDuration,durs:e.duration/1e3,tdurs:e.totalDuration/1e3,eslr:e.enableSelectRoute,ucsrr:e.useClientSelectRouteResult,skipCommit:!!e.skipCommit,errc:null==(r=e.extra)?void 0:r.errorCode,err:null==(r=e.extra)?void 0:r.error,msg:null==(r=e.extra)?void 0:r.message},s=(r="error"===(r=e.type)||"retry"===r?r:n,"".concat("image"===t?"image":"video","_")+r);switch(n){case 1e3:this.teaLog.event(s,se({},o,{type:e.type,errc:e.extra&&e.extra.errorCode,ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,msg:e.extra&&e.extra.message,crc32Array:e.crc32Array,isDirect:e.isDirect})}));break;case 1001:this.teaLog.event(s,se({},o,{type:e.type,oid:e.oid,upload_host:e.tosDomain,errc:e.extra&&e.extra.errorCode,ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,err:e.extra&&e.extra.error,msg:e.extra&&e.extra.message,sig:e.signature,stk:e.proxyStsToken})}));break;case 1002:this.teaLog.event(s,se({},o,{type:e.type,oid:e.oid,upload_host:e.tosDomain,errc:e.extra&&e.extra.errorCode,ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,msg:e.extra&&e.extra.message,upid:e.uploadID})}));break;case 1003:e.isAllFinish||e.isDirect||(delete o.sst,delete o.set,delete o.dur),this.teaLog.event(s,se({},o,{type:e.type,oid:e.oid,errc:e.extra&&e.extra.errorCode,upload_host:e.tosDomain,af:e.isAllFinish,cst:e.crc32StartTime,cet:e.crc32EndTime,cdur:e.crc32Duration,slst:e.sliceStartTime,slet:e.sliceEndTime,sldurs:e.sliceDuration&&e.sliceDuration/1e3,ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,msg:e.extra&&e.extra.message,si:e.sliceIndex,af:e.isAllFinish})}));break;case 1004:default:this.teaLog.event(s,se({},o,{type:e.type,oid:e.oid,upload_host:e.tosDomain,errc:e.extra&&e.extra.errorCode,ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,msg:e.extra&&e.extra.message})}));break;case 1005:this.teaLog.event(s,se({},o,{type:e.type,oid:e.oid,upload_host:e.tosDomain,errc:e.extra&&e.extra.errorCode,speed:Math.round(i/(e.totalDuration/1e3)/1024),ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,err:e.extra&&e.extra.error,msg:e.extra&&e.extra.message,vid:e.uploadResult&&e.uploadResult.Vid})}));break;case 900:this.teaLog.event(s,se({},o,{type:e.type,errc:e.extra&&e.extra.errorCode,race_info:e.raceInfo,client_ip:e.lastClientIp,uc:e.useCache,ex:JSON.stringify({errc:e.extra&&e.extra.errorCode,err:e.extra&&e.extra.error,msg:e.extra&&e.extra.message})}))}}},{key:"setLineAppId",value:function(e){this.teaLog.config({evtParams:{line_app_id:e}})}},{key:"setUserUniqueId",value:function(e){this.teaLog.config({user_unique_id:e})}},{key:"console",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){this.options.debug&&console.log(e)}))}]),e}(),ue=(t=r(6),r.n(t)),le=(V=r(4),r.n(V)),fe={urlTemplate:function(e,t){var r;return t=t||{},Object.keys(t).forEach((function(n){r=new RegExp("{".concat(n,"}"),"g"),e=e.replace(r,t[n])})),e},toQueryString:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).map((function(t){return"".concat(t,"=").concat(encodeURIComponent(e[t]))})).join("&")},supportChunked:function(){var e=window.Blob||window.WebKitBlob;try{var t=e.prototype;return!(!FormData||!(t.slice||t.webkitSlice||t.mozSlice))}catch(e){return!1}},supportXhr:function(){return!!window.FormData||window.ProgressEvent&&window.FileReader},supportCrc32:function(){var e=window.FileReader&&window.FileReader.prototype.readAsBinaryString;return"undefined"!=typeof Int32Array&&e&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice)},storage:function(e){var t=e;if(e={removeItem:function(e){delete t.cache[e]},setItem:function(e,r){t.cache[e]=r},getItem:function(e){return t.cache[e]},clear:function(){delete t.cache,t.cache={}}},!(1<arguments.length&&void 0!==arguments[1])||arguments[1])try{if(window.localStorage)return window.localStorage.setItem("",""),window.localStorage}catch(e){}return e},noop:function(){},getUnique:function(e){return"".concat(e,"_").concat((new Date).getTime(),"_").concat(parseInt(1e6*Math.random()))},getFileSliceLength:function(e,t){var r=e.size,n=1048576;return t&&"function"==typeof t?t(r)<2097152?2097152:t(r)||r:200*n<r?10*n:r<=200*n&&2*n<=r?5*n:e.size},getFileSuffix:function(e){if(e&&"[object String]"===Object.prototype.toString.call(e)){var t=e.lastIndexOf(".");if(0<t&&(e="."+e.substring(t+1)).length<=8)return e}},fileSlice:function(e,t,r){return(e.slice||e.webkitSlice||e.mozSlice).call(e,t,r)},getPathByURL:function(e){return/^(?:(https?\:)\/\/)?(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/.exec(e)[5]||"/"},crypto:{hmac:function(e,t){return ue()(t,e)},sha256:function(e){return le()(e)}},date:{iso8601:function(e){return(e=void 0===e?fe.date.getDate():e).toISOString().replace(/\.\d{3}Z$/,"Z")}},Buffer:Uint8Array,generateKey:function(e){for(var t="",r=0;r<e;r++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t}},he=fe;function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==pe(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==pe(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===pe(e)?e:String(e)}(n.key),n)}}function me(e,t){return(me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ye(e){return(ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ve=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&me(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=ye(e);return function(e,t){if(t&&("object"===pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=ye(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=e.call(this)).xhr=new XMLHttpRequest,r._data=null,r}return function(e,t,r){t&&de(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"_ajax",value:function(e){var t=this,r=this.xhr;r.upload.onprogress=function(e){t.emit("progress",e)},r.onreadystatechange=function(n){4===r.readyState&&(r.upload.onprogress=he.noop,r.onreadystatechange=he.noop,r.params=e,t._data&&t._data.url&&(r.currentUrl=t._data.url),200<=r.status&&r.status<300?t.emit("complete",r):400<=r.status&&t.emit("error",r))},r.onerror=function(){r.errText="unknow net error",t.emit("error",r)},r.ontimeout=function(){r.errText="timeout",t.emit("error",r)},r.onabort=function(){r.errText="abort",t.emit("error",r)},r.send(e)}},{key:"send",value:function(e){var t=this;return this._data=e,this.xhr.open(e.method||"POST",e.url||"",!0),e.headers&&Object.keys(e.headers).forEach((function(r){t.xhr.setRequestHeader(r,e.headers[r])})),this.xhr.timeout=e.timeout||0,e.ontimeout&&(this.xhr.ontimeout=e.ontimeout),e.binary?this.sendAsBinary(e):e.custom?"object"===pe(e.custom)?this.sendAsCustom(JSON.stringify(e.custom)):"none"===e.custom?(delete e.custom,this.sendAsCustom()):this.sendAsCustom(e.custom):this.sendAsFormData(e)}},{key:"sendAsBinary",value:function(e){return this.xhr.setRequestHeader("Content-Type","application/octet-stream"),this.xhr.setRequestHeader("Content-Disposition",'attachment; filename="'.concat(encodeURI(e.filename),'"')),this._ajax(e.file)}},{key:"sendAsFormData",value:function(e){t=(t=e.formData?"function"==typeof e.formData?e.formData():e.formData:t)||[];for(var t,r=new FormData,n=0,i=t.length;n<i;n++){var o=r[n];r.append(o.name,o.value)}return e.file&&r.append(e.field,e.file,e.name),this._ajax(r)}},{key:"sendAsCustom",value:function(e){return this._ajax(e)}},{key:"abort",value:function(){this.xhr.onreadystatechange=he.noop,this.xhr.abort()}},{key:"getResponse",value:function(){return this.xhr.response}},{key:"getText",value:function(){return this.xhr.responseText}},{key:"getJson",value:function(){return JSON.parse(this.xhr.responseText)}}]),t}(),ge=(q=r(1),r.n(q));function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _e(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function Se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(r),!0).forEach((function(t){!function(e,t,r){(t=we(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Me(){return(Me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,we(n.key),n)}}function we(e){return e=function(e,t){if("object"!==be(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==be(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===be(e)?e:String(e)}function xe(e,t){return(xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Ye(e){return(Ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var De=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xe(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ye(e);return function(e,t){if(t&&("object"===be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=Ye(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=e.call(this)).options=r,i.config=n,i.uploaderCtx=r.context,i.file=r.file,i.cacheKey="__bd_uploader_cache",i}return function(e,t,r){t&&ke(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e,t){this._st=Date.now(),this.uploaderCtx._broadcast("startSelectRoute",null,!0),this.clientIp=e.clientIp,this.selectRouteTimeout=e.selectRouteTimeout||5e3,this.selectRouteCacheTime=e.selectRouteCacheTime||36e5,this.selectRouteFileSize=e.selectRouteFileSize||2097152,this.completeCallback=t,(e=this.checkSelect({clientIp:this.clientIp}))?this.success(e,null,!0):this.startSelectRoute()}},{key:"checkSelect",value:function(e){e=e.clientIp;var t=null;try{t=JSON.parse(this.uploaderCtx.storage.getItem(this.cacheKey))}catch(e){return null}if(t){var r=t.lastClientIp,n=t.lastSelectRouteTime;if(e&&e!==r)return null;if((new Date).getTime()-n<this.selectRouteCacheTime)return t}return null}},{key:"startSelectRoute",value:function(){var e=this,t=this.config.region,r=new ve,n=(r.on("complete",(function(t){if(t.response)try{var r,n=JSON.parse(t.response);n.ResponseMetadata.Error?e.fail({xhr:t,errorCode:n.ResponseMetadata.Error.CodeN,error:n.ResponseMetadata.Error.Code,message:n.ResponseMetadata.Error.Message}):(r=n.Result.Domains,e.race(r,t))}catch(r){e.fail({error:"catch error: ".concat(r.toString()),xhr:t})}else e.fail({error:"request fail: ".concat(t.statusText||t.errText||"UNKNOWN"),xhr:t})})),r.on("error",(function(t){var r={error:"request fail: ".concat(t.statusText||t.errText||"UNKNOWN"),xhr:t};t.response&&(t=JSON.parse(t.response)).ResponseMetadata&&t.ResponseMetadata.Error&&(r.errorCode=t.ResponseMetadata.Error.CodeN,r.error=t.ResponseMetadata.Error.Code,r.message=t.ResponseMetadata.Error.Message),e.fail(r)})),this.config.videoHost),i=ne,o=this.config.videoConfig&&this.config.videoConfig.spaceName,s=(o={Action:"GetUploadCandidates",Version:"2020-11-19",SpaceName:o=this.options.type===te&&this.config.objectConfig&&this.config.objectConfig.spaceName?this.config.objectConfig.spaceName:o},this.options.stsToken),a=he.toQueryString(o),c=s.AccessKeyID,u=s.AccessKeyId,l=s.SecretAccessKey,f=s.SessionToken;s=s.CurrentTime,n={method:"GET",url:"".concat(n,"?").concat(a),timeout:3e4,region:t,params:o},a=new ge.a(n,i),this.config.useServerCurrentTime&&6e4<Math.abs(new Date(s)-new Date)&&(this.systemTimeGap=new Date(s)-new Date),t=this.systemTimeGap?new Date((new Date).getTime()+this.systemTimeGap):new Date,a.addAuthorization({accessKeyId:u||c,secretAccessKey:l,sessionToken:f},t),r.send(n)}},{key:"race",value:function(e,t){var r=this,n=this.file,i=(n.slice||n.webkitSlice||n.mozSlice).call(n,0,Math.min(this.selectRouteFileSize,n.size)),s=e.map((function(e){return{domainName:e.Name,domainInfo:e,percent:0,startTime:(new Date).getTime(),endTime:(new Date).getTime(),complete:!1}})),a=0,c=s.length;s.forEach((function(e,n){var i=new ve;i.on("complete",(function(){s[n].endTime=(new Date).getTime(),s[n].complete=!0,s.forEach((function(e,t){n!==t&&e.transport&&e.transport.abort()})),r.formatRaceInfo(s,t)})),i.on("error",(function(e){s[n].endTime=(new Date).getTime(),s[n].complete=!0,s[n].error=e.errText,c<=++a&&r.formatRaceInfo(s,t)})),i.on("progress",(function(e){e=e.loaded/e.total,s[n].percent=e})),s[n].transport=i})),s.forEach((function(e){var t={oid:(n=e.domainInfo).StoreID,tosDomain:"".concat(r.config.schema,"://").concat(n.Name)},n=(t=he.urlTemplate(o,t)+"?speedtest",n.Sign);e.transport.send({method:"post",url:t,headers:{Authorization:n,"Content-CRC32":"ignore"},file:i,binary:1,timeout:r.selectRouteTimeout})}))}},{key:"formatRaceInfo",value:function(e,t){e.sort((function(e,t){return e.percent<t.percent?1:e.percent>t.percent?-1:e.error?1:t.error?-1:0})),e.forEach((function(e){delete e.transport})),e={lastClientIp:this.clientIp,lastSelectRouteTime:(new Date).getTime(),raceInfo:e,type:"success"},this.uploaderCtx.storage.setItem(this.cacheKey,JSON.stringify(e)),this.success(e,t)}},{key:"success",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];t=t&&this.formatXhr(t),this.uploaderCtx.logger.send(Me(Se(Se({stage:"selectRoute",stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,fileSize:this.file&&this.file.size},t),{},{useCache:r}),e)),this.uploaderCtx._broadcast("completeSelectRoute",Se(Se({},e),{},{useCache:r}),!0),this.completeCallback({selectRouteResult:e.raceInfo})}},{key:"fail",value:function(e){var t={error:e.error,errorCode:e.errorCode,message:e.message};this.uploaderCtx.logger.send(Me(Se({stage:"selectRoute",stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,fileSize:this.file&&this.file.size,extra:t,type:"warn"},this.formatXhr(e.xhr)))),this.uploaderCtx._broadcast("completeSelectRoute",Se({type:"warn"},t),!0),this.completeCallback()}},{key:"formatXhr",value:function(e){return{req:{url:e.currentUrl,param:e.params},res:{status:e.status,header:e.getAllResponseHeaders(),body:e.responseText}}}}]),t}(),Oe=function(e,t){for(var r=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],n=("undefined"!=typeof Int32Array&&(r=new Int32Array(r)),-1^~~t),i=(e=new Uint8Array(e)).length,o=0;o<i;o++)n=r[255&(n^e[o])]^n>>>8;return(-1^n)>>>0},Ee=function(e){if(void 0!==e)return function e(t){return t.length<8?e(t="0".concat(t)):t}(Number(e).toString(16))};function Te(e){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==Te(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==Te(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===Te(e)?e:String(e)}(n.key),n)}}var Le=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.file=t,this.successProcess=n,this.failProcess=i,this.sliceLength=r,this.retryTime=0,this.fileSize=t.size,this.crc32Array=[]}return function(e,t,r){t&&Re(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"start",value:function(){this.readFileCrc32(this.file)}},{key:"readFileCrc32",value:function(e){var t=this,r=this.sliceLength,n=e.slice||e.webkitSlice||e.mozSlice,i=new FileReader,o=0,s=0,a=0;!function c(){s<e.size&&(s=Math.min(o+r,e.size),104857600<e.size)&&e.size-s<=5242880&&(s=e.size),i.readAsArrayBuffer(n.call(e,o,s)),i.onload=function(r){r=r.target.result,a=Oe(r,0),t.crc32Array.push({start:o,end:s,crc32:Ee(a),buffer:r}),(o=s)<e.size?c():t.success(t.crc32Array)}}()}},{key:"success",value:function(e){this.successProcess(e)}},{key:"fail",value:function(e,t,r,n){3<=this.retryTime?this.failProcess():(this.readFileCrc32(e,t,r,n),this.retryTime++)}}]),e}(),Ce=1000002,Pe=1000003,Ae=1003e3,ze="The format of stsToken is incorrect.";function Be(e){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ie(){return(Ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function He(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==Be(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==Be(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===Be(e)?e:String(e)}(n.key),n)}}var Ue=function(){function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.context=t.context,this.key=t.key,this.isDirect=t.isDirect,this.isImageBatchUpload=t.isImageBatchUpload,this.file=t.file,this.type=(this.isImageBatchUpload?null==(t=this.file[0])?void 0:t.type:null==(t=this.file)?void 0:t.type)||"",this.sliceLength=he.getFileSliceLength(this.file,r.getSliceFunc),this.config=r}return function(e,t,r){t&&He(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"start",value:function(e,t,r){this.successProcess=t,this.failProcess=r,this._st=Date.now(),this.crc32(this.file,this.sliceLength)}},{key:"crc32",value:function(e,t){var r=this;if(this.isImageBatchUpload)for(var n=e.length,i=[],o=function(t){new Le(e[t],e[t].size,(function(e){i[t]=e[0],i.filter((function(e){return!!e})).length===n&&r.success(i)}),(function(e){r.fail(e)})).start()},s=0;s<n;s++)o(s);else!e||!e.size||e.size<=0?this.fail({errorCode:Pe,message:"There is a problem with the input file or fileSize."}):this.isDirect?new Le(e,e.size,(function(e){r.success(e)}),(function(e){r.fail({errorCode:Pe,message:"get crc32 error: ".concat(e&&e.message)})})).start():this.sliceFile(e,t,(function(e){r.success(e)}),(function(e){r.fail(e)}))}},{key:"sliceFile",value:function(e,t,r,n){for(var i=[],o=t,s=e.size,a=e.slice||e.webkitSlice||e.mozSlice,c=0,u=0,l=0;u<s;)u=Math.min(c+o,s),i.push({start:c,end:u=104857600<s&&s-u<=5242880?s:u,crc32:0}),c=u;try{!function t(o){var c=new FileReader,u=i[o].start,f=i[o].end;c.readAsArrayBuffer(a.call(e,u,f)),c.onload=function(e){e=e.target.result,l=Ee(Oe(e,0)),i[o].crc32=l,f===s?r(i):t(i.length-1)},c.onerror=function(e){var t=e.target.error.name;e=e.target.error.message,n({crc32Array:i,errorCode:1000003,message:t+": "+e})}}(0)}catch(t){n({message:t&&t.toString()})}}},{key:"getCrc32Key",value:function(e,t){return t="[object Array]"===Object.prototype.toString.call(t)?function(e){return function(e){if(Array.isArray(e))return je(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?je(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?je(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t):[t],t.push(e[0].crc32,e[e.length-1].crc32),this.config.instanceId&&t.push(this.config.instanceId),t.join("_")}},{key:"success",value:function(e){var t=this.context,r=this.key,n=[],i=[];if(this.isImageBatchUpload)for(var o=0;o<this.file.length;o++)n.push(this.file[o].size),i.push(this.file[o].name);else n=this.file.size,i=this.file.name;var s=this.getCrc32Key(e,n);(t=t.tasks[r])&&this.successProcess(Ie(t,{key:r,crc32Array:e,crc32Key:s,sdkVersion:"2.0.10",sliceLength:this.sliceLength,extra:{message:"get crc32 success"},stage:"crc32",type:"success",fileSize:n,fileName:i,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st,isDirect:this.isDirect,isImageBatchUpload:this.isImageBatchUpload}))}},{key:"fail",value:function(e){var t=this.context,r=this.key,n=e&&e.message?e.message:"get crc32 error",i=e&&e.errorCode;e=e&&e.crc32Array,t=Ie(t.tasks[r],{crc32Array:e,extra:{message:n,errorCode:i},type:"error",stage:"crc32",stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st}),this.failProcess(t)}}]),e}(),Ne=function(e){return!e||e.SessionToken&&e.SecretAccessKey&&(e.AccessKeyId||e.AccessKeyID)},Fe=function(e,t,r){if(r===ne||r===ie)return r;if(e!==Z){if(e===ee)return ie;if(e===te){if(t.objectConfig&&t.objectConfig.spaceName)return ne;if(t.objectConfig&&t.objectConfig.serviceId)return ie;if(t.videoConfig&&t.videoConfig.spaceName)return ne;if(t.imageConfig&&t.imageConfig.serviceId)return ie}}return ne};function Ge(e){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function Ke(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(r),!0).forEach((function(t){!function(e,t,r){(t=We(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Je(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ve(){return(Ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function qe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,We(n.key),n)}}function We(e){return e=function(e,t){if("object"!==Ge(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==Ge(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===Ge(e)?e:String(e)}function Xe(e,t){return(Xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function $e(e){return($e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qe=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xe(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=$e(e);return function(e,t){if(t&&("object"===Ge(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=$e(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=e.call(this)).options=r,i.config=n,i.uploaderCtx=r.context,i.currFileCtx=r.context.tasks[r.key],i.systemTimeGap=0,i.retryTime=n.retryTaskTime||2,i.hasRetryTime=0,i.isImageBatchUpload=!!i.options.isImageBatchUpload,i.isDirect=i.options.isDirect,i}return function(e,t,r){t&&qe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e,t,r){this.startOptions=e,this.failProcess=r,this.successProcess=t,this._st=Date.now(),r=(e=this.uploaderCtx._getCache(this.currFileCtx.crc32Key))?JSON.parse(e):{},!this.isDirect&&r.oid&&r.UploadID?this.resumeFromCache(r):this.startPreUpload()}},{key:"startPreUpload",value:function(){var e=this,t=this.config.region,r=new ve,n=(r.on("complete",(function(t){if(t.response){var r=null;try{var n=JSON.parse(t.response);if(n.ResponseMetadata.Error)return e.fail({xhr:t,errorCode:n.ResponseMetadata.Error.CodeN,error:n.ResponseMetadata.Error.Code,message:n.ResponseMetadata.Error.Message});var i,o,s,a,c,u,l,f=Fe(e.options.type,e.config,e.options.serviceType),h=n.Result,p=f===ie?h.UploadAddress:h.InnerUploadAddress.UploadNodes[0],d=p.StoreInfos,m=p.UploadHosts,y=p.SessionKey,v=p.UploadHeader,g=void 0===v?{}:v,b=f===ie?m[0]:p.UploadHost,_=null==(i=d[0])?void 0:i.UploadID,S=[],M=[];e.isImageBatchUpload&&1<d.length?d.forEach((function(e){S.push(e.Auth),M.push(e.StoreUri)})):(S=d[0].Auth,M=d[0].StoreUri),f===ne&&(o=h.InnerUploadAddress.UploadNodes).length&&1<o.length&&(a={SessionKey:(s=o[1]).SessionKey,UploadHeader:s.UploadHeader,StoreInfo:s.StoreInfos[0],UploadHost:s.UploadHost}),e.startOptions&&e.startOptions.enableSelectRoute&&(l=!0,e.startOptions.selectRouteResult)&&(u=!(((c=e.startOptions.selectRouteResult)[0]&&c[0].domainName)!==b)),r=Ve(e.currFileCtx,{key:e.options.key,useBackupDomain:e.uploaderCtx.useBackupDomain,signature:S,type:"success",extra:{message:"prepare upload success"},stage:"preUpload",oid:M,systemTimeGap:e.systemTimeGap,tosDomain:"".concat(e.config.schema,"://").concat(b),xhr:t,UploadHeader:g,SessionKey:y,UploadID:_,fallbackStoreInfo:a,stageStartTime:e._st,stageEndTime:Date.now(),duration:Date.now()-e._st,totalDuration:Date.now()-e._st+e.currFileCtx.totalDuration,useClientSelectRouteResult:u,enableSelectRoute:l})}catch(r){return e.fail({error:"catch error: ".concat(r.message||r.toString()),xhr:t})}return e.successProcess(r)}return e.fail({error:"request fail: ".concat(t.statusText||t.errText||"UNKNOWN"),xhr:t})})),r.on("error",(function(t){var r;(e.options.type===ee&&e.config.imageFallbackHost||e.options.type===Z&&e.config.videoFallbackHost)&&!e.uploaderCtx.useBackupDomain?(e.hasRetryTime<e.retryTime-1?e.hasRetryTime++:e.uploaderCtx.useBackupDomain=!0,e.startPreUpload()):(r={error:"request fail: ".concat(t.statusText||t.errText||"UNKNOWN"),xhr:t},t.response&&(t=JSON.parse(t.response)).ResponseMetadata&&t.ResponseMetadata.Error&&(r.errorCode=t.ResponseMetadata.Error.CodeN,r.error=t.ResponseMetadata.Error.Code,r.message=t.ResponseMetadata.Error.Message),e.fail(r))})),""),i={},o=this.uploaderCtx.useBackupDomain,s=Fe(this.options.type,this.config,this.options.serviceType),a=(s===ie&&(n=o?this.config.imageFallbackHost:this.config.imageHost,i={Action:"ApplyImageUpload",Version:"2018-08-01"},this.options.type===ee&&(this.config.imageConfig&&this.config.imageConfig.serviceId?i.ServiceId=this.config.imageConfig.serviceId:i.SpaceName=this.config.videoConfig&&this.config.videoConfig.spaceName),this.options.type===te&&(i.ServiceId=this.config.objectConfig&&this.config.objectConfig.serviceId||this.config.imageConfig&&this.config.imageConfig.serviceId),this.currFileCtx.fileSize&&1<this.currFileCtx.fileSize.length&&(i.UploadNum=this.currFileCtx.fileSize.length),this.options.storeKey)&&(a=this.options.storeKey,"[object Array]"===Object.prototype.toString.call(a)?i.StoreKeys=a:"[object String]"===Object.prototype.toString.call(a)&&(i.StoreKeys=[a])),s===ne&&(a=this.config.videoConfig&&this.config.videoConfig.spaceName,this.options.type===te&&this.config.objectConfig&&this.config.objectConfig.spaceName&&(a=this.config.objectConfig.spaceName),n=o?this.config.videoFallbackHost:this.config.videoHost,i={Action:"ApplyUploadInner",Version:"2020-11-19",SpaceName:a,FileType:this.options.type,IsInner:1},this.config.enOID&&(i.EnOID=1),(this.options.testHost||this.config.testHost)&&(i.TestHost=this.options.testHost||this.config.testHost),this.startOptions)&&this.startOptions.selectRouteResult&&(o=this.startOptions.selectRouteResult,i.ClientBestHosts=o.map((function(e){return e.domainName})).join(",")),this.currFileCtx.fileSize&&!this.currFileCtx.isImageBatchUpload&&(i.FileSize=this.currFileCtx.fileSize),this.config.useFileExtension&&this.currFileCtx.fileName&&(this.options.type===te||this.options.type===ee)&&(a=this.currFileCtx.fileName,o=he.getFileSuffix(a))&&(i.FileExtension=o),this.config.accountId&&(i["X-Account-Id"]=this.config.accountId),this.options.type!==ee&&this.options.type!==te||!this.config.bizType||(i.BizType=this.config.bizType,i.AppID=this.config.appId,i.UserID=this.config.userId),this.config.openExperiment&&(i.app_id=this.config.appId,i.user_id=this.config.userId),i.s=Math.random().toString(36).substr(2),this.options.fileSize&&(i.FileSize=this.options.fileSize),this.currFileCtx.proxyStsToken||this.config.stsToken),c=(o=he.toQueryString(i),a.AccessKeyID),u=a.AccessKeyId,l=a.SecretAccessKey,f=a.SessionToken;a=a.CurrentTime,o={method:"GET",url:"".concat(n,"?").concat(o),timeout:this.config.gatewayTimeout||3e4,region:t,params:i,pathname:he.getPathByURL(n)},t=new ge.a(o,s),this.config.useServerCurrentTime&&6e4<Math.abs(new Date(a)-new Date)&&(this.systemTimeGap=new Date(a)-new Date),i=this.systemTimeGap?new Date((new Date).getTime()+this.systemTimeGap):new Date,t.addAuthorization({accessKeyId:u||c,secretAccessKey:l,sessionToken:f},i),r.send(o)}},{key:"resumeFromCache",value:function(e){var t=this,r=this.options.key,n=new ve,i=(n.on("complete",(function(n){var i=null;try{var o=JSON.parse(n.response);if(!(2e3===o.code&&0<o.data.partlist.length))return t.startPreUpload();var s=t.confirmCache(o.data.partlist),a=e.hasMerge?5:s.isAllFinished?4:3;i=Ve(t.currFileCtx,e,{key:r,xhr:n,extra:{message:"prepare upload from cache success"},stage:"preUpload",type:"success",percent:0,cacheTask:a,proxyStsToken:t.options.stsToken,currentTask:1,status:1,isBreak:1,crc32Array:s.crc32Array,stageStartTime:t._st,stageEndTime:Date.now(),duration:Date.now()-t._st,totalDuration:Date.now()-t._st+t.currFileCtx.totalDuration})}catch(n){return t.startPreUpload()}t.successProcess(i)})),n.on("error",(function(e){400<=e.status?t.startPreUpload():t.fail({error:"request error",xhr:e})})),this.config.userId);n.send({method:"get",url:he.urlTemplate("{tosDomain}/upload/v1/{oid}?uploadid={uploadId}&action=part_list",{tosDomain:e.tosDomain,oid:e.oid,uploadId:e.UploadID}),headers:Ke({Authorization:e.signature,"X-Storage-U":encodeURIComponent(i)},e.UploadHeader),timeout:3e4})}},{key:"confirmCache",value:function(e){var t=this.currFileCtx.crc32Array,r={},n=(e.forEach((function(e){void 0===r[e.num-1]&&(r[e.num-1]={tag:!0,crc32:e.crc32})})),!0);return e=t.map((function(e,t){return r[t]&&r[t].tag&&r[t].crc32?(e.crc32=r[t].crc32,e.finished=!0,e.loaded=e.end-e.start):n=!1,e})),{isAllFinished:n,crc32Array:e}}},{key:"fail",value:function(e){var t=this,r=e.xhr,n=e.errorCode||1001e3,i="prepare upload error: UNKNOWN";r&&(i=0===r.status?"prepare upload error: NETERROR":e.message||"prepare upload error: ".concat(r.status)),i=Ve(this.currFileCtx,{extra:{message:i,error:e.error,errorCode:n},type:"error",stage:"preUpload",xhr:r,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currFileCtx.totalDuration}),this.isImageBatchUpload&&(i.successImage=[],i.failImage=null==(e=this.currFileCtx)?void 0:e.crc32Array.map((function(e,r){return{crc32:e.crc32,fileSize:null==(e=t.currFileCtx)?void 0:e.fileSize[r],fileName:null==(e=t.currFileCtx)?void 0:e.fileName[r],finishSize:0,success:!1}}))),this.uploaderCtx._removeTaskCache(this.options.key),this.failProcess(i)}}]),t}();function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function et(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function tt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?et(Object(r),!0).forEach((function(t){!function(e,t,r){(t=it(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):et(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function rt(){return(rt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function nt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,it(n.key),n)}}function it(e){return e=function(e,t){if("object"!==Ze(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==Ze(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===Ze(e)?e:String(e)}function ot(e,t){return(ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function st(e){return(st=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var at=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ot(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=st(e);return function(e,t){if(t&&("object"===Ze(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=st(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=e.call(this)).options=r,i.config=n,i.transport=new ve,i.uploaderCtx=r.context,i.currFileCtx=r.context.tasks[r.key],i.eventInit(),i}return function(e,t,r){t&&nt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"initUpload",value:function(e){e&&(e=this.currFileCtx.fallbackStoreInfo)&&(rt(this.currFileCtx,{oid:e.StoreInfo.StoreUri,tosDomain:"".concat(this.config.schema,"://").concat(e.UploadHost),signature:e.StoreInfo.Auth,UploadHeader:e.UploadHeader,SessionKey:e.SessionKey}),this.uploaderCtx._saveTask(this.options.key)),e={oid:this.currFileCtx.oid,tosDomain:this.currFileCtx.tosDomain},e=he.urlTemplate("{tosDomain}/upload/v1/{oid}?uploadmode=part&phase=init",e);var t=this.config.userId;this.transport.send({method:"post",url:e,headers:tt({Authorization:this.currFileCtx.signature,"X-Storage-U":encodeURIComponent(t)},this.currFileCtx.UploadHeader),timeout:this.config.initUploadTimeout||3e4})}},{key:"start",value:function(e,t,r){this.successProcess=t,this.failProcess=r,this._st=Date.now(),this.initUpload(e&&e.changeNodeRetry)}},{key:"eventInit",value:function(){var e=this;this.transport.on("complete",(function(t){var r=null;try{var n,i=JSON.parse(t.response),o=null==(n=i.data)?void 0:n.uploadid;if(2e3!==i.code||!o)return e.fail({error:"fail! response.code: ".concat(i.code,", fail message: ").concat(i.message),code:null==i?void 0:i.code,message:null==i?void 0:i.message,xhr:t});r=rt(e.currFileCtx,{UploadID:o,percent:0,type:"success",extra:{message:"init upload id success"},stage:"initUploadID",xhr:t,stageStartTime:e._st,stageEndTime:Date.now(),duration:Date.now()-e._st,totalDuration:Date.now()-e._st+e.currFileCtx.totalDuration})}catch(r){return e.fail({error:"catch error: ".concat(r.message||JSON.stringify(r)),xhr:t})}return e.successProcess(r)})),this.transport.on("error",(function(t){e.fail({error:"request fail: ".concat(t.statusText||t.errText||"UNKNOWN"),xhr:t})}))}},{key:"fail",value:function(e){var t=this.options.context,r=this.options.key;t=rt(t.tasks[r],{extra:{message:"init upload id error, ".concat(e.error),errorCode:(null==e?void 0:e.code)||1002e3},type:"error",stage:"initUploadID",xhr:e.xhr,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currFileCtx.totalDuration}),this.uploaderCtx._removeTaskCache(this.options.key),this.failProcess(t)}}]),t}();function ct(e){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ut(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function lt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(r),!0).forEach((function(t){!function(e,t,r){(t=ht(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ut(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ft(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ht(n.key),n)}}function ht(e){return e=function(e,t){if("object"!==ct(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==ct(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===ct(e)?e:String(e)}function pt(e,t){return(pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mt=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pt(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=dt(e);return function(e,t){if(t&&("object"===ct(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=dt(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r){var n,i=r.sliceItem,o=r.crc32,s=r.url,a=r.signature,c=r.uploadHeader,u=r.userId,l=r.retryTime,f=r.timeout;return r=void 0===(r=r.method)?"POST":r,function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=e.call(this)).fileSlice=i,n.crc32=o,n.uploadUrl=s,n.uploadHeader=c,n.signature=a,n.userId=u,n.retryTime=l||0,n.method=r,n.retryCount=0,n.timeout=f||18e5,n.ready=!1,n.cancel=!1,n.transport=new ve,n.eventInit(),n}return function(e,t,r){t&&ft(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"upload",value:function(e,t){this.isParamsValid()&&(this._st=Date.now(),this.transport&&this.transport.send({method:this.method,url:this.uploadUrl,headers:lt({Authorization:this.signature,"Content-CRC32":this.crc32,"X-Storage-U":encodeURIComponent(this.userId)},this.uploadHeader),file:this.fileSlice,binary:1,timeout:this.timeout}),e)&&this.emit("retry",t)}},{key:"isParamsValid",value:function(){return this.fileSlice&&(this.fileSlice.size||this.fileSlice.byteLength)?this.crc32?!!this.uploadUrl||(this.emit("error",{message:"slice upload failed: NOURL",crc32:this.crc32,size:this.fileSlice.size||this.fileSlice.byteLength}),!1):(this.emit("error",{message:"slice upload failed: NOCRC32",crc32:this.crc32,size:this.fileSlice.size||this.fileSlice.byteLength}),!1):(this.emit("error",{message:"slice upload failed: NOCONTENT",crc32:this.crc32}),!1)}},{key:"eventInit",value:function(){var e=this;this.transport.on("complete",(function(t){try{var r=JSON.parse(t.response);2e3===r.code?e.success(t):e.fail(t,r)}catch(r){e.fail(t)}})),this.transport.on("error",(function(t){e.fail(t)})),this.transport.on("progress",(function(t){e.process(t)}))}},{key:"success",value:function(e){this.ready=!0;var t=Date.now()-this._st,r=this.fileSlice.size||this.fileSlice.byteLength;this.emit("complete",{crc32:this.crc32,size:r,speed:r/t,xhr:e,sliceStartTime:this._st,sliceEndTime:Date.now(),sliceDuration:Date.now()-this._st})}},{key:"fail",value:function(e){var t,r,n=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.cancel||(t={crc32:this.crc32,size:this.fileSlice.size||this.fileSlice.byteLength,xhr:e,sliceStartTime:this._st,sliceEndTime:Date.now(),sliceDuration:Date.now()-this._st},e&&401===e.status?this.emit("error",lt({message:"slice upload failed: UNAUTHORIZED"},t)):(r="slice upload failed: UNKNOWN",e&&(r=e.status?"slice upload failed: ".concat((null==i?void 0:i.message)||e.status):"slice upload failed: NETERROR"),this.retryCount<this.retryTime?(setTimeout((function(){n.upload(!0,lt({message:r},t))}),1e3),this.retryCount++):this.emit("error",lt({message:r,code:null==i?void 0:i.code},t))))}},{key:"process",value:function(e){this.cancel||this.emit("progress",{crc32:this.crc32,loaded:e.loaded||0,total:e.total||0})}},{key:"abort",value:function(){this.transport&&(this.cancel=!0,this.transport.abort())}},{key:"destroy",value:function(){this.transport=null}}]),t}(),yt=(K=r(2),r.n(K));function vt(e){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gt(){return(gt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==vt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==vt(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===vt(e)?e:String(e)}(n.key),n)}}function St(e,t){return(St=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Mt(e){return(Mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var kt=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&St(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Mt(e);return function(e,t){if(t&&("object"===vt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=Mt(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r){var n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=e.call(this)).file=r.file,n.context=r.context,n.key=r.key,n.config=i,n.finishArr=[],n.errorLength=0,n.finishSize=0,n.retryUploadTime=Number(i.retryUploadTime)||2,n.progressMonitorTime=Number(i.progressMonitorTime)||10,n.progressMonitorSpeed=Number(i.progressMonitorSpeed)||50,n.uploadSliceCount=Number(i.uploadSliceCount)||3,n.realtimeSpeedInterval=Number(i.realtimeSpeedInterval)||5,n.processRetry=0,n.lastFinishSize=-1,n.lastProcessPercent=-1,n.lastIntervalSize=-1,n.lastCalculateSpeedTime=-1,n.lastCalculateSpeedSize=0,n.uploadHandlers={},n}return function(e,t,r){t&&_t(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e,t,r){this.failProcess=r,this.successProcess=t,this.errorLength=0,this.currentCtx=this.context.tasks[this.key],this.crc32Array=this.context.tasks[this.key].crc32Array,this.uploadSliceCount=this.uploadSliceCount>this.crc32Array.length?this.crc32Array.length:this.uploadSliceCount,this.lastIndex=0,this.uploading=[],this._uploadSize=this.crc32Array.reduce((function(e,t){return e+(t.finished?0:t.end-t.start)}),0),this._st=Date.now(),this._lastSaveTime=Date.now(),this.lastCalculateSpeedTime=this._st,this.initWorker(),this.setProgressMonitor(),this.threadUpload()}},{key:"initWorker",value:function(){var e,t=this;this.worker||(e=this.crc32Array,this.worker=new yt.a,this.worker.onmessage=function(r){r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],c=!0,u=!1;try{for(o=(r=r.call(e)).next,0;!(c=(n=o.call(r)).done)&&(a.push(n.value),4!==a.length);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(e)||function(e,t){var r;if(e)return"string"==typeof e?bt(e,4):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?bt(e,4):void 0}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(r.data);var n=r[0],i=r[1],o=r[2],s=(r=r[3],(new Date).getTime()),a=e[o];a.crc32=i,a.crc32StartTime=r,a.crc32EndTime=s,a.crc32Duration=s-r,t.upload(a,n,o)})}},{key:"read",value:function(e,t){var r=this,n=this.file,i=n.slice||n.webkitSlice||n.mozSlice,o=new FileReader;o.onload=function(e){var n=(new Date).getTime();r.worker.postMessage([e.target.result,t,n,!!r.config.clientEncrypt,r.currentCtx.clientEncryptKey,r.crc32Array.length-1===t],[e.target.result])},o.onerror=function(){r.stop(),r.fail({extra:{message:"An error occurred reading the file",errorCode:1003003}})},o.readAsArrayBuffer(i.call(n,e.start,e.end))}},{key:"threadUpload",value:function(){if(this.uploading.length<this.uploadSliceCount){var e=this.lastIndex,t=this.crc32Array[e];if(t){if(t.finished){if(-1===this.finishArr.indexOf(t.start)&&(this.finishArr.push(t.start),this.finishArr.length>=this.crc32Array.length))return this.stop(),void this.success()}else t.loaded=0,this.uploading.push(e),this.read(t,e);this.lastIndex++,this.threadUpload()}}}},{key:"stop",value:function(){var e=this;Object.keys(this.uploadHandlers).forEach((function(t){e.uploadHandlers[t].abort(),e.uploadHandlers[t].destroy()})),this.uploadHandlers={},this.worker&&this.worker.terminate(),this.worker=null,this.clearMonitor()}},{key:"setProgressMonitor",value:function(){var e=this;this.progressMonitorInterval=setInterval((function(){var t,r=e.finishSize;r-e.lastIntervalSize<e.progressMonitorTime*e.progressMonitorSpeed*1024?(t=gt(e.currentCtx,{stage:"process",type:"warn",extra:{message:"percent are not updated in ".concat(e.progressMonitorTime," seconds")}}),e.context.logger.send(t),e.context._broadcast("slowProgress",t),e.clearMonitor()):e.lastIntervalSize=r}),1e3*this.progressMonitorTime)}},{key:"clearMonitor",value:function(){this.progressMonitorInterval&&clearInterval(this.progressMonitorInterval)}},{key:"upload",value:function(e,t,r){var n=this,o=e.crc32,s={part_number:r+1,uploadId:this.currentCtx.UploadID,oid:this.currentCtx.oid,tosDomain:this.currentCtx.tosDomain},a=(s=he.urlTemplate(i,s),this.config.userId),c=this.config.uploadTimeout;(this.config.clientEncrypt||(t=he.fileSlice(this.file,e.start,e.end)),t=new mt({sliceItem:t,crc32:o,url:s,signature:this.currentCtx.signature,uploadHeader:this.currentCtx.UploadHeader,userId:a,method:"POST",retryTime:this.retryUploadTime,timeout:c})).on("complete",(function(t){1===n.currentCtx.status&&(t.start=e.start,t.crc32StartTime=e.crc32StartTime,t.crc32EndTime=e.crc32EndTime,t.crc32Duration=e.crc32Duration,t.index=r,n.fileSliceSuccess(t))})),t.on("error",(function(t){1===n.currentCtx.status&&(t.start=e.start,t.crc32StartTime=e.crc32StartTime,t.crc32EndTime=e.crc32EndTime,t.crc32Duration=e.crc32Duration,t.index=r,n.fail(t))})),t.on("progress",(function(t){1===n.currentCtx.status&&(t.start=e.start,t.index=r,n.process(t))})),t.on("retry",(function(t){1===n.currentCtx.status&&(t.start=e.start,t.index=r,n.retry(t))})),t.upload(),this.uploadHandlers[r]=t}},{key:"success",value:function(e){this.finishArr=[];var t=Date.now()-this._st;t=this._uploadSize/t,t=gt(this.currentCtx,{type:"success",stage:"process",percent:100,extra:{message:"upload all success"},speed:t,xhr:e,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._lastSaveTime+this.currentCtx.totalDuration,isAllFinish:!0}),this.worker&&this.worker.terminate(),this.successProcess(t)}},{key:"fail",value:function(e){var t=this.errorFormat(e);t.type="error",void 0!==e.statusCode&&gt(this.currentCtx,{statusCode:e.statusCode}),this.errorLength||(this.context.logger.send(gt({},t)),this.stop(),this.context._broadcast("error",t),this.currentCtx.isBreak?this.context._cancel(this.key):this.context._pause(this.key),this.errorLength++)}},{key:"retry",value:function(e){e=this.errorFormat(e),this.context.logger.send(gt({},e,{type:"retry"}))}},{key:"fileSliceSuccess",value:function(e){var t,r=e.index,n=Date.now(),i=(-1===this.finishArr.indexOf(e.start)&&this.finishArr.push(e.start),this.crc32Array[r].finished=!0,this.crc32Array[r].speed=e.speed,{message:"slice upload success"});e.xhr&&(t=e.xhr,i.currentUrl=t.currentUrl||"",gt(this.currentCtx,{req:{url:t.currentUrl,param:t.params},res:{status:t.status,body:t.responseText,header:t.getAllResponseHeaders()}}),delete e.xhr),this.context.logger.send(gt(this.currentCtx,{stage:"process",type:"success",sliceIndex:r,extra:i,totalDuration:n-this._lastSaveTime+this.currentCtx.totalDuration,sliceStartTime:e.sliceStartTime,sliceEndTime:e.sliceEndTime,sliceDuration:e.sliceDuration,crc32StartTime:e.crc32StartTime,crc32EndTime:e.crc32EndTime,crc32Duration:e.crc32Duration})),this._lastSaveTime=n,this.uploading.splice(this.uploading.indexOf(r),1),this.uploadHandlers[r]&&delete this.uploadHandlers[r],this.finishArr.length>=this.crc32Array.length?(this.stop(),this.success(e.xhr)):this.threadUpload()}},{key:"getFinishSize",value:function(e,t){var r=t.crc32,n=0;return e.forEach((function(e){e.crc32===r?(e.loaded=t.loaded,n+=t.loaded):(e.loaded||(e.loaded=0),n+=e.loaded)})),n}},{key:"process",value:function(e){var t=this.currentCtx.realtimeSpeed||0,r=this.currentCtx.fileSize,n=(this.finishSize=this.getFinishSize(this.crc32Array,e),this.finishSize>this.lastFinishSize&&((e=new Date).getTime()-this.lastCalculateSpeedTime>1e3*this.realtimeSpeedInterval&&(i=e.getTime()-this.lastCalculateSpeedTime,n=this.finishSize-this.lastCalculateSpeedSize,t=Math.floor(n/i),this.lastCalculateSpeedTime=e.getTime(),this.lastCalculateSpeedSize=this.finishSize),this.lastFinishSize=this.finishSize),Math.floor(this.finishSize/r*100*100)/100||0),i=gt(this.currentCtx,{stage:"process",percent:n,realtimeSpeed:t});n>this.lastProcessPercent&&100!==n&&(this.lastProcessPercent=n,this.context._broadcast("progress",i))}},{key:"errorFormat",value:function(e){var t=this.currentCtx.totalDuration,r=Date.now()-this._st,n=e.index,i=((i=e.crc32?{message:e.message,data:e.crc32,size:e.size}:e.extra).errorCode=(null==e?void 0:e.code)||i.errorCode||Ae,gt(this.currentCtx,{extra:i,sliceIndex:n,stage:"process",req:{},res:{},totalDuration:r+t,sliceStartTime:e.sliceStartTime,sliceEndTime:e.sliceEndTime,sliceDuration:e.sliceDuration,crc32StartTime:e.crc32StartTime,crc32EndTime:e.crc32EndTime,crc32Duration:e.crc32Duration}));return e.xhr&&(n=e.xhr,i.req={url:e.xhr.currentUrl},i.res={status:n.status,body:n.responseText,header:n.getAllResponseHeaders()},delete e.xhr),i}}]),t}();function wt(e){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xt(){return(xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Yt(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function Dt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ot(n.key),n)}}function Ot(e){return e=function(e,t){if("object"!==wt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==wt(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===wt(e)?e:String(e)}function Et(e,t){return(Et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Tt(e){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rt=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Et(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Tt(e);return function(e,t){if(t&&("object"===wt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=Tt(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=e.call(this)).options=r,i.config=n,i.transport=new ve,i.eventInit(),i.errorCount=0,i.uploaderCtx=r.context,i.currFileCtx=r.context.tasks[r.key],i}return function(e,t,r){t&&Dt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"mergeFile",value:function(){for(var e={oid:this.currFileCtx.oid,uploadId:this.currFileCtx.UploadID,tosDomain:this.currFileCtx.tosDomain},t=this.currFileCtx.crc32Array,r="",n=0;n<t.length;n++)r=(r?"".concat(r,","):"").concat(n+1,":").concat(t[n].crc32);e=he.urlTemplate("{tosDomain}/upload/v1/{oid}?uploadmode=part&phase=finish&uploadid={uploadId}",e);var i=this.config.userId;i=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(r),!0).forEach((function(t){!function(e,t,r){(t=Ot(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({Authorization:this.currFileCtx.signature,"X-Storage-U":encodeURIComponent(i)},this.currFileCtx.UploadHeader),this.config.clientEncrypt&&(i["x-upload-encryption-mode"]=2,i["x-upload-encryption-key"]=btoa(this.currFileCtx.clientEncryptKey)),this.transport.send({method:"post",url:e,headers:i,custom:r})}},{key:"start",value:function(e,t,r){this.successProcess=t,this.failProcess=r,this._st=Date.now(),this.mergeFile()}},{key:"eventInit",value:function(){var e=this,t=this.options.stage;this.transport.on("complete",(function(r){var n=null;try{var i,o=JSON.parse(r.response);if(2e3!==o.code||null==(i=o.data)||!i.key)return e.fail({error:"fail! response.code: ".concat(o.code,", fail message: ").concat(o.message),code:null==o?void 0:o.code,message:null==o?void 0:o.message,xhr:r});n=xt(e.currFileCtx,{stage:t,type:"success",hasMerge:!0,extra:{message:"merge file success"},xhr:r,stageStartTime:e._st,stageEndTime:Date.now(),duration:Date.now()-e._st,totalDuration:Date.now()-e._st+e.currFileCtx.totalDuration})}catch(n){return e.fail({error:"response parse error: ".concat(n.message||JSON.stringify(n)),xhr:r})}return e.successProcess(n)})),this.transport.on("error",(function(t){e.fail({error:"request fail: ".concat(t.statusText||t.errText),xhr:t})}))}},{key:"getProcessIndex",value:function(e){var t=0;return e.forEach((function(e,r){"process"===e.stage&&(t=r)})),t}},{key:"fail",value:function(e){e=xt(this.currFileCtx,{extra:{message:"merge file error, ".concat(e.error),errorCode:(null==e?void 0:e.code)||1004e3},type:"error",stage:this.options.stage,xhr:e.xhr,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currFileCtx.totalDuration}),this.failProcess(e)}}]),t}();function Lt(e){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ct(){return(Ct=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Pt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==Lt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==Lt(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===Lt(e)?e:String(e)}(n.key),n)}}function At(e,t){return(At=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function zt(e){return(zt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Bt=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&At(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=zt(e);return function(e,t){if(t&&("object"===Lt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=zt(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r){var n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=e.call(this)).options=r,n.file=r.file,n.context=r.context,n.key=r.key,n.isImageBatchUpload=r.isImageBatchUpload,n.config=i,n.finishArr=[],n.errorLength=0,n.finishSize=0,n.retryUploadTime=n.config.retryUploadTime||0,n.processRetry=0,n.lastFinishSize=-1,n.lastProcessPercent=-1,n.lastIntervalSize=-1,n.uploader={},n._uploadProcessMap={},n}return function(e,t,r){t&&Pt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e,t,r){this.failProcess=r,this.successProcess=t,this.currentCtx=this.context.tasks[this.key],this.crc32Array=this.context.tasks[this.key].crc32Array,this._uploadSize=this.isImageBatchUpload?this.currentCtx.fileSize.reduce((function(e,t){return e+t})):this.file.size,this._st=Date.now(),this.upload()}},{key:"stop",value:function(){var e=this;this.uploader&&Object.keys(this.uploader).forEach((function(t){e.uploader[t]&&(e.uploader[t].abort(),e.uploader[t].destroy())}))}},{key:"upload",value:function(){for(var e=this,t=this.crc32Array.length,r=0,n=0,i=0;i<t;i++){var s=(a=this.crc32Array[i]).buffer,a=a.crc32,c=this.currentCtx.signature,u=(c="[object Array]"===Object.prototype.toString.call(c)?c[i]:c,this.currentCtx.oid),l={oid:u="[object Array]"===Object.prototype.toString.call(u)?u[i]:u,tosDomain:this.currentCtx.tosDomain},f=(l=he.urlTemplate(o,l),this.config.userId),h=this.config.uploadTimeout,p=void 0,d=this.isImageBatchUpload?(p=this.currentCtx.fileSize[i],this.currentCtx.fileName[i]):(p=this.file.size,this.file.name);this._uploadProcessMap[a]&&this._uploadProcessMap[a].success?r+=1:(this._uploadProcessMap[a]={crc32:a,fileSize:p,fileName:d,oid:u,finishSize:0,success:!1},(p=new mt({sliceItem:s,crc32:a,url:l,signature:c,uploadHeader:this.currentCtx.UploadHeader,userId:f,retryTime:this.retryUploadTime,method:"POST",timeout:h})).on("complete",(function(i){r++,e._uploadProcessMap[i.crc32].finishSize=i.size,e._uploadProcessMap[i.crc32].success=!0,n+r===t&&e.success(i.xhr)})),p.on("error",(function(r){++n===t&&e.fail(r)})),p.on("progress",(function(t){e.process(t)})),p.upload(),this.uploader[a]=p)}}},{key:"success",value:function(e){this.finishArr=[];var t=Date.now()-this._st,r=(t=this._uploadSize/t,Ct(this.currentCtx,{type:"success",stage:"process",percent:100,extra:{message:"direct upload success"},speed:t,xhr:e,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currentCtx.totalDuration}));this.isImageBatchUpload&&(r.successImage=[],r.failImage=[],Object.values(this._uploadProcessMap).forEach((function(e){(e.success?r.successImage:r.failImage).push(e)}))),this.uploader=null,this._uploadProcessMap=null,this.successProcess(r)}},{key:"fail",value:function(e){e=Ct(this.currentCtx,{extra:{message:"direct upload error: ".concat(e.message||e.xhr.errText),errorCode:e.code||Ae},type:"error",stage:"process",xhr:e.xhr,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currentCtx.totalDuration}),this.isImageBatchUpload&&(e.failImage=Object.values(this._uploadProcessMap)),this.uploader=null,this._uploadProcessMap=null,this.failProcess(e)}},{key:"process",value:function(e){var t=this._uploadSize;this._uploadProcessMap[e.crc32].finishSize=Math.max(this._uploadProcessMap[e.crc32].finishSize,e.loaded),this.finishSize=Object.values(this._uploadProcessMap).reduce((function(e,t){return e+t.finishSize}),0),this.finishSize>this.lastFinishSize&&(this.lastFinishSize=this.finishSize),e=Math.floor(this.finishSize/t*100*100)/100||0,t=Ct(this.currentCtx,{stage:"process",percent:e}),e>this.lastProcessPercent&&100!==e&&(this.lastProcessPercent=e,this.context._broadcast("progress",t))}}]),t}();function It(e){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jt(){return(jt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ht(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==It(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==It(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===It(e)?e:String(e)}(n.key),n)}}function Ut(e,t){return(Ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Nt(e){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ft=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ut(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Nt(e);return function(e,t){if(t&&("object"===It(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=Nt(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r){var n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=e.call(this)).options=r,n.file=r.file,n.context=r.context,n.key=r.key,n.config=i,n.errorLength=0,n.retryUploadTime=Number(i.retryUploadTime)||2,n.maxUploadSliceCount=Number(i.uploadSliceCount)||5,n.uploadQueue=[],n.crc32Array=[],n.uploadSliceCount=0,n.isCalcCrc32=!1,n.isFileReading=!1,n.hasStarted=!1,n.hasCompleteUpload=!1,n}return function(e,t,r){t&&Ht(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e,t,r){this.failProcess=r,this.successProcess=t,this.currentCtx=this.context.tasks[this.key],this.hasStarted=!0,this._st=Date.now(),this.initWorker()}},{key:"initWorker",value:function(){var e=this;this.worker||(this.worker=new yt.a,this.worker.onmessage=function(t){e.isCalcCrc32=!1;var r=t.data[0],n=t.data[2],i=t.data[1];e.uploadQueue.forEach((function(t,o){t.index===n&&(e.uploadQueue[o].crc32=i,e.uploadQueue[o].fileSliceBuffer=r,e.crc32Array[n]={crc32:i})})),e.startUploadQueue()},this.startUploadQueue())}},{key:"addStreamSlice",value:function(e){var t=this,r=e.fileSlice,n=e.index;(this.isFileReading=!0,e=new FileReader).readAsArrayBuffer(r),e.onload=function(e){t.isFileReading=!1,e=e.target.result,t.uploadQueue.push({fileSliceBuffer:e,index:n}),t.hasStarted&&t.startUploadQueue()}}},{key:"completeStreamUpload",value:function(){this.hasCompleteUpload=!0,0!==this.uploadQueue.length||this.isFileReading||this.success()}},{key:"startUploadQueue",value:function(){var e;this.uploadSliceCount<=this.maxUploadSliceCount&&0<this.uploadQueue.length&&this.uploadQueue[0].crc32?(e=this.uploadQueue.shift(),this.uploadSliceCount++,this.upload({sliceItem:e.fileSliceBuffer,index:e.index,crc32:e.crc32})):0<this.uploadQueue.length&&!this.uploadQueue[0].crc32&&this.startCrc32Queue()}},{key:"startCrc32Queue",value:function(){if(!this.isCalcCrc32)for(var e=0;e<this.uploadQueue.length;e++){var t=this.uploadQueue[e];if(!t.crc32){this.isCalcCrc32=!0,this.worker.postMessage([t.fileSliceBuffer,t.index],[t.fileSliceBuffer]);break}}}},{key:"upload",value:function(e){var t=this,r=e.sliceItem,n=e.index,o=(e=e.crc32,this.currentCtx.signature),s={part_number:n+1,uploadId:this.currentCtx.UploadID,oid:this.currentCtx.oid,tosDomain:this.currentCtx.tosDomain},a=(s=he.urlTemplate(i,s),this.config.userId);(r=new mt({sliceItem:r,crc32:e,url:s,signature:o,uploadHeader:this.currentCtx.UploadHeader,userId:a,retryTime:this.retryUploadTime,method:"POST",timeout:this.config.uploadTimeout})).on("complete",(function(e){1===t.currentCtx.status&&(e.index=n,t.fileSliceSuccess(e))})),r.on("error",(function(e){1===t.currentCtx.status&&(e.index=n,t.fail(e))})),r.upload()}},{key:"fileSliceSuccess",value:function(e){var t=e.index,r=Date.now(),n={message:"stream slice upload success"},i=(e.xhr&&(i=e.xhr,n.currentUrl=i.currentUrl||"",jt(this.currentCtx,{req:{url:i.currentUrl,param:i.params},res:{status:i.status,body:i.responseText,header:i.getAllResponseHeaders()}}),delete e.xhr),this.context.logger.send(jt(this.currentCtx,{stage:"process",type:"success",sliceIndex:t,extra:n,totalDuration:r-this._lastSaveTime+this.currentCtx.totalDuration})),jt(this.currentCtx,{uploadQueueLength:this.uploadQueue.length,sliceIndex:t}));this.context._broadcast("stream-progress",i),this.uploadSliceCount--,this.hasCompleteUpload&&0===this.uploadQueue.length?this.success(e.xhr):this.startUploadQueue()}},{key:"success",value:function(e){this.isAllSuccess||(e=jt(this.currentCtx,{type:"success",stage:"process",percent:100,extra:{message:"all slice upload success"},crc32Array:this.crc32Array,xhr:e,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currentCtx.totalDuration}),this.successProcess(e))}},{key:"fail",value:function(e){var t=e.index;e=jt(this.currentCtx,{extra:{message:"stream slice upload error"},type:"error",stage:"process",xhr:e.xhr,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currentCtx.totalDuration,sliceIndex:t}),this.context.logger.send(jt({},e)),this.context._broadcast("error",e)}}]),t}();function Gt(e){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jt(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function Kt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(r),!0).forEach((function(t){!function(e,t,r){(t=Wt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Vt(){return(Vt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function qt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wt(n.key),n)}}function Wt(e){return e=function(e,t){if("object"!==Gt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==Gt(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===Gt(e)?e:String(e)}function Xt(e,t){return(Xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function $t(e){return($t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qt=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xt(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=$t(e);return function(e,t){if(t&&("object"===Gt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=$t(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=e.call(this)).options=r,i.config=n,i.uploaderCtx=r.context,i.currFileCtx=r.context.tasks[r.key],i.isImageBatchUpload=!!i.options.isImageBatchUpload,i.skipCommit=r.skipCommit,i.transport=new ve,i.eventInit(),i}return function(e,t,r){t&&qt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"commitUpload",value:function(){var e,t,r=this.options.key,n=(r=this.options.context.tasks[r],this.config.region),i="",o={},s=this.uploaderCtx.useBackupDomain,a=Fe(this.options.type,this.config,this.options.serviceType),c=(a===ie&&(i=s?this.config.imageFallbackHost:this.config.imageHost,o={Action:"CommitImageUpload",Version:"2018-08-01"},t={SessionKey:r.SessionKey},this.options.type===ee&&(this.config.imageConfig&&this.config.imageConfig.serviceId?o.ServiceId=this.config.imageConfig.serviceId:o.SpaceName=this.config.videoConfig&&this.config.videoConfig.spaceName,e=this.config.imageConfig&&this.config.imageConfig.processAction,Array.isArray(e)&&0<e.length&&(t.Functions=e),this.config.skipMeta)&&(o.SkipMeta=!0),this.options.type===te&&(o.ServiceId=this.config.objectConfig&&this.config.objectConfig.serviceId||this.config.imageConfig&&this.config.imageConfig.serviceId),e=JSON.stringify(t)),a===ne&&(c=this.config.videoConfig&&this.config.videoConfig.spaceName,this.options.type===te&&this.config.objectConfig&&this.config.objectConfig.spaceName&&(c=this.config.objectConfig.spaceName),i=s?this.config.videoFallbackHost:this.config.videoHost,o={Action:"CommitUploadInner",Version:"2020-11-19",SpaceName:c},t={SessionKey:r.SessionKey,Functions:[]},s=this.config.videoConfig&&this.config.videoConfig.processAction,this.options.type===te&&this.config.objectConfig&&this.config.objectConfig.processAction&&(s=this.config.objectConfig.processAction),Array.isArray(s)&&0<s.length&&(t.Functions=s),(this.config.videoConfig&&this.config.videoConfig.callbackArgs||this.options.callbackArgs)&&(t.CallbackArgs=this.options.callbackArgs||this.config.videoConfig.callbackArgs),this.options.type===Z&&this.config.skipDownload&&(o.SkipDownload=!0),this.options.type===te&&this.options.objectSync&&(t.ObjectSync=this.options.objectSync),this.options.type===Z&&this.options.needExactFormat&&(t.needExactFormat=this.options.needExactFormat),e=JSON.stringify(t)),this.config.accountId&&(o["X-Account-Id"]=this.config.accountId),this.config.openExperiment&&(o.app_id=this.config.appId,o.user_id=this.config.userId),he.toQueryString(o)),u=(s=this.currFileCtx.proxyStsToken||this.config.stsToken).AccessKeyID,l=s.AccessKeyId,f=s.SecretAccessKey;s=s.SessionToken,(c={method:"POST",url:"".concat(i,"?").concat(c),timeout:this.config.gatewayTimeout||3e4,region:n,params:o,headers:{},pathname:he.getPathByURL(i)}).custom=e,c.body=t,a===ie&&(c.headers["Content-Type"]="application/json"),n=new ge.a(c,a),i=(o=r.systemTimeGap)?new Date((new Date).getTime()+o):new Date,n.addAuthorization({accessKeyId:l||u,secretAccessKey:f,sessionToken:s},i),this.transport.send(c)}},{key:"start",value:function(e,t,r){if(this.successProcess=t,this.failProcess=r,this._st=Date.now(),this.skipCommit)return this.successProcess(Vt(this.currFileCtx,{stage:"complete",type:"success",percent:100,extra:{message:"upload successful, skip commit"},stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currFileCtx.totalDuration,skipCommit:this.skipCommit}));try{this.commitUpload()}catch(e){this.fail({error:"catch error: ".concat(e.toString())})}}},{key:"eventInit",value:function(){var e=this;this.transport.on("complete",(function(t){var r=null;try{var n=JSON.parse(t.response);if(n.ResponseMetadata.Error)return e.fail({xhr:t,errorCode:n.ResponseMetadata.Error.CodeN,error:n.ResponseMetadata.Error.Code,message:n.ResponseMetadata.Error.Message});var i,o,s=Fe(e.options.type,e.config,e.options.serviceType),a=n.Result,c={};s===ie?e.isImageBatchUpload?(i=a.Results,o=a.PluginResult||[],i.forEach((function(e,t){i[t]=Kt(Kt({},i[t]),o[t])})),c=i):Vt(c=a.Results[0],a.PluginResult&&a.PluginResult[0]):c=a.Results[0],r=Vt(e.currFileCtx,{stage:"complete",type:"success",percent:100,extra:{message:"upload successful"},uploadResult:c,xhr:t,stageStartTime:e._st,stageEndTime:Date.now(),duration:Date.now()-e._st,totalDuration:Date.now()-e._st+e.currFileCtx.totalDuration,skipCommit:e.skipCommit})}catch(r){return e.fail({error:"catch error: ".concat(r.message||r.toString()),xhr:t})}return e.successProcess(r)})),this.transport.on("error",(function(t){var r={error:"request fail: ".concat(t.statusText||t.errText||"UNKNOWN"),xhr:t};t.response&&(t=JSON.parse(t.response)).ResponseMetadata&&t.ResponseMetadata.Error&&(r.errorCode=t.ResponseMetadata.Error.CodeN,r.error=t.ResponseMetadata.Error.Code,r.message=t.ResponseMetadata.Error.Message),e.fail(r)}))}},{key:"fail",value:function(e){var t=this.options.context,r=this.options.key,n=e.xhr,i=e.errorCode||1005e3,o="commit upload error: UNKNOWN";n&&(o=0===n.status?"commit upload error: NETERROR":e.message||"commit upload error: ".concat(n.status)),t=Vt(t.tasks[r],{extra:{message:o,error:e.error,errorCode:i},type:"error",stage:"complete",xhr:n,stageStartTime:this._st,stageEndTime:Date.now(),duration:Date.now()-this._st,totalDuration:Date.now()-this._st+this.currFileCtx.totalDuration,skipCommit:this.skipCommit}),this.failProcess(t)}}]),t}();function Zt(e){return(Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function er(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function tr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?er(Object(r),!0).forEach((function(t){!function(e,t,r){(t=ir(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):er(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function rr(){return(rr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function nr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ir(n.key),n)}}function ir(e){return e=function(e,t){if("object"!==Zt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==Zt(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===Zt(e)?e:String(e)}function or(e,t){return(or=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function sr(e){return(sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ar=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&or(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=sr(e);return function(e,t){if(t&&("object"===Zt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=sr(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r){var n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length?arguments[2]:void 0,s=3<arguments.length?arguments[3]:void 0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=e.call(this,r)).tasks=r,n.config=i,n.key=s,n.uploaderCtx=o,n.current=0,n.length=n.tasks.length,n.taskError={},n.uploadList=[],n.retryTaskTime=i.retryTaskTime||2,n}return function(e,t,r){t&&nr(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e){var t=this.tasks.shift();t&&(this.current=t.index,this.execTask(t,e))}},{key:"execTask",value:function(e,t){var r,n,i=this,o=e.key,s=this.uploaderCtx,a=s.tasks[o];a&&(r=a.cacheTask,n=s.taskList[o].length,r&&0<e.index&&e.index<r?this.start():(a.currentTask=e.index,1===a.status&&(1!==e.index&&"initUploadID"!==e.stage||(e.arg=rr(e.arg,t)),e)&&e.func.call(e.context,e.arg,(function(r){var c;s.taskList[o]&&((c=s.taskList[o][e.index+1])&&0!==e.index&&!a.isDirect?s._saveTask(o,{currentTask:c.index,stage:c.stage}):e.index===n-1&&s._removeTaskCache(o),i.success(r),0<i.tasks.length?i.start(t):s._queueSuccess(o))}),(function(r){var n;r.xhr&&400<=r.xhr.status||3===e.index&&r.isDirect?i.fail(r):!i.taskError[o]||i.taskError[o]<i.retryTaskTime?(i.taskError[o]?i.taskError[o]++:i.taskError[o]=1,n=i.errorFormat(r,!0),i.uploaderCtx.logger.send(n),"initUploadID"===e.stage?i.execTask(e,tr(tr({},t),{},{changeNodeRetry:!0})):i.execTask(e,t)):(r.key=o,i.fail(r))}))))}},{key:"addTask",value:function(e){this.tasks.push(e)}},{key:"success",value:function(e){var t;e.xhr&&(t=e.xhr,e.req={url:t.currentUrl,param:t.params},e.res={status:t.status,header:t.getAllResponseHeaders(),body:t.responseText},delete e.xhr),rr(e,{type:"success"});try{this.uploaderCtx._broadcast(e.stage,e)}catch(e){throw Error(e)}this.uploaderCtx.logger.send(e)}},{key:"fail",value:function(e){var t=this.uploaderCtx,r=e.key;e=this.errorFormat(e);try{t._broadcast("error",e)}catch(e){throw Error(e)}t.tasks[r].isBreak?t._cancel(r):t._pause(r),t.logger.send(e)}},{key:"cancel",value:function(e){var t,r=this.key,n=this.uploaderCtx.tasks[r].currentTask;this.uploaderCtx.taskList[r].forEach((function(e){n===e.index&&(t=e)})),e?3===n&&this.uploaderCtx.tasks[r].isDirect&&t&&null!=(e=t)&&null!=(e=e.context)&&e.stop():(this.tasks=[],t&&3===t.index&&t.context.stop(),this.uploaderCtx._removeTaskCache(r))}},{key:"restart",value:function(){this.uploadList.forEach((function(e){e.cancel=!1})),this.start()}},{key:"errorFormat",value:function(e,t){var r;return t={type:t?"retry":"error"},e.xhr&&(r=e.xhr,e.req={url:r.currentUrl,param:r.params},e.res={status:r.status,header:r.getAllResponseHeaders(),body:r.responseText},e.extra&&(e.extra.req=e.req,e.extra.res=e.res),delete e.xhr),rr(e,t)}}]),t}();function cr(e){return(cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ur(){return(ur=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function lr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){return e=function(e,t){if("object"!==cr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==cr(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===cr(e)?e:String(e)}(n.key),n)}}function fr(e,t){return(fr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function hr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pr(e){return(pr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dr=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fr(e,t)}(t,n.a);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=pr(e);return function(e,t){if(t&&("object"===cr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return hr(e)}(this,t?(r=pr(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=e.call(this,r)).config=ur({},s),n._mergeOptions(n.config,r),n.tasks={},n.taskList={},n.cache={},n.storage=he.storage(hr(n),n.config.enableDiskBreakpoint),n.logger=n.config.noLog?{send:function(){}}:new ce(n.config,hr(n)),n}return function(e,t,r){t&&lr(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"_mergeOptions",value:function(e,t){t&&"object"===cr(t)&&(ur(e,t),Object.keys(t).forEach((function(r){"vodDomain"===r&&(e.replace[r]=t[r])})))}},{key:"_setCache",value:function(e,t){this.storage.setItem(e,t)}},{key:"_getCache",value:function(e){return this.storage.getItem(e)}},{key:"_removeCache",value:function(e){e?this.storage.removeItem(e):this.storage.clear()}},{key:"_addTask",value:function(e,t){var r=this.tasks,n=this.taskList;r[e]&&r[e].task?n[e].push(t):(n[e]=[],n[e].push(t),r[e]=r[e]||{},r[e].task=new ar([],this.config,this,e)),r[e].task.addTask(t)}},{key:"_broadcast",value:function(e,t,r){!r&&1!==(r=this.tasks[t.key].status)&&0!==r||this.emit(e,t)}},{key:"_addCrc32ProcessTask",value:function(e,t){var r=(n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).isDirect,n=n.isImageBatchUpload;r={context:e=new Ue({file:e.file,context:this,key:t,isDirect:r,isImageBatchUpload:void 0!==n&&n},this.config),func:e.start,arg:{},key:t,index:0,stage:"crc32"},this._addTask(t,r)}},{key:"_addPreUploadTask",value:function(e,t){var r=(n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).isDirect,n=n.isImageBatchUpload;r={file:e.file,stsToken:e.stsToken,context:this,type:e.type||Z,preUploadUriParams:e.preUploadUriParams||{},storeKey:e.storeKey,testHost:e.testHost,key:t,isDirect:r,isImageBatchUpload:void 0!==n&&n,fileSize:e.fileSize,serviceType:e.serviceType||null},e={context:n=new Qe(r,this.config),func:n.start,arg:{},key:t,index:1,stage:"preUpload"},this._addTask(t,e)}},{key:"_addDirectUploadTask",value:function(e,t){var r=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).isImageBatchUpload;r={context:e=new Bt({file:e.file,context:this,key:t,isImageBatchUpload:void 0!==r&&r},this.config),func:e.start,arg:{},key:t,index:3,stage:"process"},this._addTask(t,r)}},{key:"_addInitUploadIDTask",value:function(e,t){e={context:e=new at({file:e.file,context:this,key:t},this.config),func:e.start,arg:{},key:t,index:2,stage:"initUploadID"},this._addTask(t,e)}},{key:"_addUploadProcessTask",value:function(e,t){e={context:e=new kt({file:e.file,context:this,key:t},this.config),func:e.start,arg:{},key:t,index:3,stage:"process"},this._addTask(t,e)}},{key:"_addStreamUploadTask",value:function(e,t){this.streamUploadTask=new Ft({context:this,key:t},this.config);var r={context:this.streamUploadTask,func:this.streamUploadTask.start,arg:{},key:t,index:3,stage:"process"};this._addTask(t,r)}},{key:"_mergeFileTask",value:function(e,t){e={context:e=new Rt({file:e.file,context:this,stage:"fileMerge",key:t},this.config),func:e.start,arg:{},key:t,index:4,stage:"fileMerge"},this._addTask(t,e)}},{key:"_getMetaInfoTask",value:function(e,t){var r=(n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).isImageBatchUpload,n=n.skipCommit;r={file:e.file,context:this,data:e.data,type:e.type||Z,callbackArgs:e.callbackArgs,objectSync:e.objectSync,needExactFormat:e.needExactFormat,key:t,isImageBatchUpload:void 0!==r&&r,skipCommit:void 0!==n&&n,serviceType:e.serviceType||null},e={context:n=new Qt(r,this.config),func:n.start,arg:{},key:t,index:5,stage:"complete"},this._addTask(t,e)}},{key:"_addAllUploadProcess",value:function(e,t){var r=e.type===ee&&"[object Array]"===Object.prototype.toString.call(e.file),n=(this.tasks[t]=this.tasks[t]||{},this.tasks[t].fileType=e.type||Z,this.tasks[t].fileSize=e.file&&e.file.size,this.tasks[t].proxyStsToken=e.stsToken,this.lastStsToken=e.stsToken,this.lastFile=e.file,e.file.size<=he.getFileSliceLength(e.file)||r);e.useDirectUpload&&(n=!0),this._addCrc32ProcessTask(e,t,{isDirect:n,isImageBatchUpload:r}),this._addPreUploadTask(e,t,{isDirect:n,isImageBatchUpload:r}),n?this._addDirectUploadTask(e,t,{isImageBatchUpload:r}):(this._addInitUploadIDTask(e,t),this._addUploadProcessTask(e,t),this._mergeFileTask(e,t)),n=!(!this.config.skipCommit||Fe(e.type,this.config)!==ie),this._getMetaInfoTask(e,t,{isImageBatchUpload:r,skipCommit:n})}},{key:"_addAllUploadProcessClientEncrypt",value:function(e){var t,r=this;return e.type===ee&&Array.isArray(e.file)?(t=[],e.file.forEach((function(n){t.push(r._createClientEncryptTask({stsToken:e.stsToken,type:e.type,file:n}))})),t):this._createClientEncryptTask(e)}},{key:"_createClientEncryptTask",value:function(e){var t=he.getUnique("file"),r=(this.tasks[t]=this.tasks[t]||{},this.tasks[t].fileType=e.type||Z,this.tasks[t].fileSize=e.file&&e.file.size,this.tasks[t].proxyStsToken=e.stsToken,this.tasks[t].clientEncryptKey=he.generateKey(16),this._addCrc32ProcessTask(e,t,{isDirect:!1,isImageBatchUpload:!1}),this._addPreUploadTask(e,t,{isDirect:!1,isImageBatchUpload:!1}),this._addInitUploadIDTask(e,t),this._addUploadProcessTask(e,t),this._mergeFileTask(e,t),!(!this.config.skipCommit||Fe(e.type,this.config)!==ie));return this._getMetaInfoTask(e,t,{isImageBatchUpload:!1,skipCommit:r}),t}},{key:"_addAllStreamUploadProcess",value:function(e,t){this.tasks[t]=this.tasks[t]||{},this.tasks[t].fileType=e.type||Z,this.tasks[t].proxyStsToken=e.stsToken,this._addPreUploadTask(e,t),this._addInitUploadIDTask(e,t),this._addStreamUploadTask(e,t),this._mergeFileTask(e,t),this._getMetaInfoTask(e,t)}},{key:"_addStreamSlice",value:function(e){var t=e.fileSlice;e=e.index,this.streamUploadTask.addStreamSlice({fileSlice:t,index:e})}},{key:"_completeStreamUpload",value:function(){this.streamUploadTask.completeStreamUpload()}},{key:"_run",value:function(e,t){var r=this.tasks,n=navigator.userAgent.toLowerCase().match(/msie ([\d.]+)/);n&&n[1]&&Number(n[1])<=9?(this._broadcast("error",ur(r[e],{key:e,status:0,stage:"browserError",extra:{message:"cannot support the browser below ie10"},type:"error"})),this.logger.send(r[e]),this._cancel(e)):r[e]?3===r[e].status?this._restart(e):(r[e].startTime=(new Date).getTime(),r[e].task&&1!==r[e].status&&r[e].task.tasks.length&&(r[e].status=1,this.logger.send(ur({},r[e],{extra:{message:"start upload"},type:"start",key:e})),r[e].task.start(t))):console.warn("".concat(e," is not exit in object tasks, stop running..."))}},{key:"_selectRoute",value:function(e,t){new De({stsToken:this.lastStsToken,context:this,type:Z,file:this.lastFile},this.config).start(e,t)}},{key:"_restart",value:function(e){var t,r,n=this,i=this.tasks;i[e]?(t=i[e].task,r=i[e].currentTask||0,this.taskList[e].forEach((function(i,o){i.index===r&&(t.tasks=n.taskList[e].slice(o))})),t&&1!==i[e].status&&t.tasks.length&&(i[e].status=1,t.restart())):console.warn("".concat(e," is not exit in object tasks"))}},{key:"_cancel",value:function(e){var t=this.tasks;t[e]?(t[e].status=2,t[e].task.cancel(),delete this.taskList[e]):console.warn("".concat(e," is not exit in object tasks"))}},{key:"_pause",value:function(e){var t=this.tasks;t[e]?(t[e].status=3,t[e].task.cancel(!0),t[e].isDirect||this._saveTask(e)):console.warn("".concat(e," is not exit in object tasks"))}},{key:"_removeTaskCache",value:function(e){var t=this.tasks;t[e]?(t=t[e].crc32Key)&&this._removeCache(t):console.warn("".concat(e," is not exit in object tasks"))}},{key:"_saveTask",value:function(e,t){if(t=(e=ur({},this.tasks[e],t||{})).crc32Key)try{this._setCache(t,this.serializeCacheInfo(e))}catch(e){console.warn(e)}}},{key:"serializeCacheInfo",value:function(e){var t="";delete e.task,delete e.xhr,delete e.crc32Array;try{t=JSON.stringify(e)}catch(n){var r={};Object.keys(e).forEach((function(t){"task"!==t&&"xhr"!==t&&"crc32Array"!==t&&(r[t]=e[t])})),t=JSON.stringify(r)}return t}},{key:"_queueSuccess",value:function(e){var t,r=this.tasks;r[e]?(t=new Date,r[e].endTime=t.getTime(),r[e].time=r[e].endTime-r[e].startTime,r[e].status=0,delete this.taskList[e],delete r[e]):console.warn("".concat(e," is not exit in object tasks"))}},{key:"_removeFile",value:function(e){delete this.tasks[e]}},{key:"_batchAction",value:function(e,t){var r=this.tasks;Object.keys(r).forEach((function(r){e&&e(r,t)}))}},{key:"_refreshSTSToken",value:function(e){var t=this,r=this.tasks;Object.keys(r).forEach((function(n){var i=ur({},n=r[n],{proxyStsToken:e}),o=(n.proxyStsToken=e,i.crc32Key);o&&(n.proxyStsToken=e,t._setCache(o,t.serializeCacheInfo(i)))}))}},{key:"_setOption",value:function(e){this._mergeOptions(this.config,e),e.userId&&!this.config.noLog&&this.logger.setUserUniqueId(e.userId),e.appId&&!this.config.noLog&&this.logger.setLineAppId(e.appId)}},{key:"_getOption",value:function(e){var t=ur({},this.config);return Object.keys(t).forEach((function(e){(-1<e.indexOf("Url")||"replace"===e||"log"===e)&&delete t[e]})),e?t[e]:t}},{key:"_userCancel",value:function(e){var t=this,r=this.tasks;e?(this._cancel(e),this.logger.send(ur({},r[e],{type:"cancel"})),delete this.tasks[e]):Object.keys(r).forEach((function(e){t._cancel(e),t.logger.send(ur({},r[e],{type:"cancel"})),delete t.tasks[e]}))}},{key:"_userPause",value:function(e){var t=this,r=this.tasks;e?(this._pause(e),this.logger.send(ur({},r[e],{type:"pause"}))):Object.keys(r).forEach((function(e){t._pause(e),t.logger.send(ur({},r[e],{type:"pause"}))}))}}]),t}();function mr(e){return(mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yr(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function vr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yr(Object(r),!0).forEach((function(t){!function(e,t,r){(t=br(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function gr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,br(n.key),n)}}function br(e){return e=function(e,t){if("object"!==mr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return String(e);if("object"!==mr(r=r.call(e,"string")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e),"symbol"===mr(e)?e:String(e)}function _r(e,t){return(_r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Sr(e){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Mr=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_r(e,t)}(t,dr);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Sr(e);return function(e,t){if(t&&("object"===mr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e)}(this,t?(r=Sr(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments))}}(t);function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.apply(this,arguments)}return function(e,t,r){t&&gr(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"start",value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.abort=!1,r.selectRoute?this._selectRoute(r,(function(r){r=vr(vr({},r),{},{enableSelectRoute:!0}),e?t._run(e,r):t._batchAction(t._run.bind(t),r)})):e?this._run(e):this._batchAction(this._run.bind(this))}},{key:"addFile",value:function(e){var t;return e&&Ne(e.stsToken)?e.file&&this.config.clientEncrypt?this._addAllUploadProcessClientEncrypt(e):e.file?(t=he.getUnique("file"),this._addAllUploadProcess(e,t),t):null:(this.emit("error",{extra:{message:ze,errorCode:Ce}}),null)}},{key:"addImageFile",value:function(e){var t;return e&&Ne(e.stsToken)?e.file?(e.type=e.type||ee,t=he.getUnique("file"),this._addAllUploadProcess(e,t),t):null:(this.emit("error",{extra:{message:ze,errorCode:Ce}}),null)}},{key:"addStreamUploadTask",value:function(e){var t;return e&&Ne(e.stsToken)?(t=he.getUnique("file"),this._addAllStreamUploadProcess(e,t),t):(this.emit("error",{extra:{message:ze,errorCode:Ce}}),null)}},{key:"addStreamSlice",value:function(e){var t=e.fileSlice;e=e.index,this._addStreamSlice({fileSlice:t,index:e})}},{key:"completeStreamUpload",value:function(){this._completeStreamUpload()}},{key:"removeFile",value:function(e){e&&this._removeFile(e)}},{key:"cancel",value:function(e){e?this._userCancel(e):this._batchAction(this._userCancel.bind(this))}},{key:"pause",value:function(e){this._userPause(e)}},{key:"restart",value:function(e){e?this._restart(e):this._batchAction(this._restart.bind(this))}},{key:"refreshSTSToken",value:function(e){this._refreshSTSToken(e)}},{key:"setOption",value:function(e){this._setOption(e)}},{key:"getOption",value:function(e){return this._getOption(e)}}]),t}()}]).default},e.exports=t()},96711:(e,t,r)=>{"use strict";r.d(t,{Cj:()=>M,TH:()=>k});var n=r(31738),i=r(2185),o=r(99385),s=r.n(o);function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}r(13489);const c=(0,n.createContext)({strategy:{banners:[],buttons:[],popups:[],wrappers:[]},schemeParams:{},fallbackURLParams:{}});function u(e){return new Promise((t=>{const r=null!=e?e:1e3;let n=0;const i=Number(new Date),o=r/20,s=setInterval((()=>{n++;const e=Number(new Date)-i;(n>=o||e>2*r)&&(clearInterval(s),t(Boolean(e>2*r||document.hidden||document.webkitHidden)))}),20)}))}function l(e,t={}){const r=Object.assign({},t),n=e.replace(/\{\{([\w.]*)\}\}/g,(function(e,n){const i=t[n];return delete r[n],null!=i?i:""})),i=Object.entries(r).map((([e,t])=>`${e}=${t}`)).join("&");return`${n}${i?n.includes("?")?`&${i}`:`?${i}`:""}`}const f={Snapchat:/Snapchat/gi,WeChat:/MicroMessenger/gi,Band:/Band/gi,KakaoTalk:/KAKAOTALK/gi,Messenger:/Messenger/gi,Line:/Line/gi,Facebook:/FBAN|FBAV/gi};let h,p=!1;var d,m,y;(y=d||(d={})).I18N="I18N",y.ALISG="ALISG",y.MALIVA="MALIVA",y["US-TTP"]="US-TTP",function(e){e.DEFAULT="default",e.APP_LINK="AppLink",e.ONE_LINK="OneLink"}(m||(m={}));const v={I18N:{channel:"sg",channel_type:"tcpy"},ALISG:{channel:"sg",channel_type:"tcpy"},MALIVA:{channel:"va",channel_type:"tcpy"},"US-TTP":{channel_type:"ttp"}};function g(e,t){t?t(e):location.href=e}function b(){const e=new URLSearchParams(window.location.search).get("ug_source");if(e)return{ug_source:e};const{userAgent:t}=navigator;for(const[e,r]of Object.entries(f))if(r.test(t))return{ug_source:e};return{}}function _(e,t={},r={}){const{links:n,providerContext:i}=e;let{schemeParams:o={},fallbackURLParams:s={}}=e;const{schemeParams:a,fallbackURLParams:c}=i,{url_schemes:u,url_fallback:f,extra:h}=n,p=null!=u?u:[];if(!p[0])throw new Error("Schemes empty");const d=p[0].startsWith("snssdk1180")?"t":p[0].startsWith("snssdk1233")?"m":"lite";let m={appType:d};try{m=Object.assign(Object.assign({},m),JSON.parse(null!=h?h:""))}catch(e){}if("function"==typeof o)try{o=o(m)}catch(e){o={}}if("function"==typeof s)try{s=s(m)}catch(e){s={}}const y=(null!=u?u:[]).map((e=>l(e,Object.assign(Object.assign(Object.assign(Object.assign({needlaunchlog:1,ug_medium:"fe_component"},i.uniqueId?{wid:i.uniqueId}:{}),t),a),o))));return{appType:d,parsedExtra:m,processedSchemes:y,processedFallbackURL:l((null!=f?f:"").replace("{{schema}}",encodeURIComponent(y[0])),Object.assign(Object.assign(Object.assign(Object.assign({pid:"website"},i.uniqueId?{wid:i.uniqueId}:{}),r),c),s))}}function S(e){return function(e,t,r,n){return new(r||(r=Promise))((function(t,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,s)}a((n=n.apply(e,[])).next())}))}(this,0,void 0,(function*(){const{target:t,links:r,jumpLinkType:n=m.DEFAULT,jumpStartHandler:o,jumpFailHandler:s,jumpHook:a,strategyContext:c,providerContext:l}=e,{schemeParams:f={},fallbackURLParams:y={}}=e,{checkOpenTime:S,useNewRedirectPath:M}=l;h=Date.now();try{!function(e,t){var r,n,o;!p&&t&&e.uniqueId&&(i.Z.init(Object.assign({app_id:1284},v[null!==(r=t.idc)&&void 0!==r?r:d["US-TTP"]])),i.Z.config({user_unique_id:String(null!==(n=e.uniqueId)&&void 0!==n?n:""),evtParams:{biz_name:t.biz_name,page_name:t.page_name,wid:null!==(o=e.uniqueId)&&void 0!==o?o:""}}),i.Z.start(),p=!0)}(l,c);const{appType:e,parsedExtra:k,processedSchemes:w,processedFallbackURL:x}=_({links:r,providerContext:l,schemeParams:f,fallbackURLParams:y},Object.assign({jump_time:h},b()),Object.assign({jump_time:h},b()));if(function(e,t){p&&i.Z.event("sharing_component_jump",{target:e,status:0,jump_time:h,app_type:t})}(t,e),null==o||o(Object.assign({jumpTime:h},k)),void 0!==window.melonapp){const[e,t]=w[0].split("://");return void g(`intent://${t}#Intent;scheme=${e};end`,a)}if("android"!==function(){const e=navigator.userAgent;return/android/i.test(e)?"android":/iPhone|iPad|iPod|iOS/i.test(e)?"ios":/\(Macintosh; Intel /.test(e)?"mac":/Win\d{2}|Windows/.test(e)?"windows":"unknown"}()||n===m.APP_LINK){const e=w[0],t=`${w.some((e=>e.startsWith("snssdk1180")))?"https://www.tiktokv.com":"https://app-va.tiktokv.com"}/${M?"now_redirect/":"redirect/"}`;return void g(`${t}?redirect_url=${encodeURIComponent(e)}&dl=${encodeURIComponent(x)}&decode_once=1`,a)}for(const e of w)if(g(e,a),yield u(S))return;!function(e,t){p&&i.Z.event("sharing_component_jump",{target:e,status:1,jump_time:h,app_type:t})}(t,e),null==s||s(Object.assign({jumpTime:h},k)),g(x,a)}catch(e){return void console.warn(e)}}))}const M=e=>{var{customStyle:t={},customClassNames:r=[],jumpStartHandler:i,jumpFailHandler:o,jumpHook:u,onClick:l,target:f,children:h,schemeParams:p={},fallbackURLParams:d={},type:m="div",withDefaultHref:y=!1}=e,v=a(e,["customStyle","customClassNames","jumpStartHandler","jumpFailHandler","jumpHook","onClick","target","children","schemeParams","fallbackURLParams","type","withDefaultHref"]);const g=(0,n.useContext)(c),{strategy:b}=g,M=a(g,["strategy"]),k=(0,n.useMemo)((()=>{if(null==b?void 0:b.wrappers)return b.wrappers.find((e=>e.name===f))}),[b,f]),w=(0,n.useMemo)((()=>k&&k.wrapper_url?function(e){try{const{processedSchemes:t,processedFallbackURL:r}=_(e),n=t[0];return`${(t.some((e=>e.startsWith("snssdk1180")))?"https://www.tiktokv.com":"https://app-va.tiktokv.com")+"/redirect/"}?redirect_url=${encodeURIComponent(n)}&dl=${encodeURIComponent(r)}&decode_once=1`}catch(e){return console.warn(e),""}}({links:k.wrapper_url,schemeParams:p,fallbackURLParams:d,providerContext:M}):""),[k,p,d,M]),x=null==b?void 0:b.page_context,Y=(0,n.useCallback)((e=>{var t;null==l||l(e),y&&e.preventDefault(),(null==k?void 0:k.wrapper_url)&&S({target:null!==(t=k.name)&&void 0!==t?t:"",jumpLinkType:k.jump_link_type,links:k.wrapper_url,jumpStartHandler:i,jumpFailHandler:o,jumpHook:u,schemeParams:p,fallbackURLParams:d,providerContext:M,strategyContext:x})}),[i,o,u,l,k,p,d,M,x,y]);return y?n.createElement("a",Object.assign({style:t,className:s()("matrix-smart-wrapper","matrix-smart-wrapper-a",r),onClick:Y,href:w},v),h):n.createElement(m,Object.assign({style:t,className:s()("matrix-smart-wrapper",r),onClick:Y},v),h)},k=({strategy:e={},schemeParams:t={},fallbackURLParams:r={},checkOpenTime:i,useNewRedirectPath:o,uniqueId:s,children:a})=>{const u=(0,n.useMemo)((()=>({strategy:e,schemeParams:t,fallbackURLParams:r,checkOpenTime:i,uniqueId:s,useNewRedirectPath:o})),[e,t,r,i,s,o]);return n.createElement(c.Provider,{value:u},a)}},17753:(e,t,r)=>{"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function s(e,t,r){return(t=f(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},l.apply(this,arguments)}function f(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}r.d(t,{Z:()=>S}),r(29832),r(34895),r(91170),r(3495),r(94609);var h=r(51962),p=r.n(h);function d(e,t){try{e.disconnect(t)}catch(e){console.error(e)}}function m(e,t){try{e.connect(t)}catch(e){console.error(e)}}r(71339),r(48612);var y="running",v={pause:"_onPause",play:"_onPlay",loadeddata:"_onLoadedData",timeupdate:"_onTimeupdate",error:"_onPlayerError"},g=[],b="1.2.1-alpha.0",_=[],S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(S,e);var t,r,n,f,h,p=(f=S,h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=a(f);if(h){var r=a(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}(this,e)});function S(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,S),s(u(e=p.call(this,t)),"_onPlayerError",(function(){})),s(u(e),"_onTimeupdate",(function(){if(e.player&&e.audioCtx){var t=e.player._connectState;e.audioCtx.state===y||4!==t&&3!==t||(e.log("_onTimeupdate  _connectState:".concat(t)),e.resume(e.audioCtx,"ontimeupdate"))}})),s(u(e),"_onPause",(function(){e.player&&e.log("_onPause")})),s(u(e),"_onPlay",(function(){if(e.audioCtx&&e.player){var t=e.player,r=t._connectState,n=t._effectNode;e.log("_onPlay ".concat(e.audioCtx.state," _connectState:").concat(r)),n&&e.audioCtx.state!==y?e.resume(e.audioCtx,"onplay"):e.enableEffectNode(n)}})),s(u(e),"_onLoadedData",(function(){e.player&&(e.audioCtx.state!==y&&e.resume(e.audioCtx,"loadeddata"),e.log("_onLoadedData state:".concat(e.audioCtx.state," _connectState:").concat(e.player._connectState)),4===e.player._connectState&&e.emit("ready",e._getStateInfo()))})),s(u(e),"_onAudioContextStatechange",(function(t){if(e.audioCtx){var r=e.audioCtx.state,n=e.player,i=n._connectState,o=n._effectNode;e.log("onAudioContextStatechange state:".concat(r,"  _connectState:").concat(i)),o?r===y&&4!==i&&e.connectEffect(e.audioCtx,e.player,e.config.meta,"statechange"):e._initEffect()}})),s(u(e),"_onprocessorerror",(function(t){var r=u(e),n=r.audioCtx,i=r.player;n&&i&&(e.log("onprocessorerror",t),e.emit("error",e._getError(31,t.message)),e.disableEffectNode(),e.disconnectEffect(n,i))})),s(u(e),"_onPortMessage",(function(t){if(e.audioCtx)switch(t.data.type){case"ONLOAD":e.log("[onPortMessage] ONLOAD",t.data);break;case"ERROR":e.log("[onPortMessage] ERROR",t.data),e.emit("error",e._getError(31,t.data.data.state)),e.disableEffectNode(),e.disconnectEffect(e.audioCtx,e.player);break;case"DATA":e._cacheBuffer(t.data.input,t.data.output);break;case"SAMPLE":e._checkSample(t.data)}})),e.config={processorName:"mammon-worklet-processor",processorUrl:"",needPcmData:!1,debugger:!1,logger:!1,sampleRate:0,maxCount:375,meta:{peak:.99,loudness:-8,targetLufs:-16},needReuse:!0},Object.keys(t).map((function(r){e.config[r]=t[r]})),e.audioCtx=null,e.player=null,e.playerId=null,r&&e.attachPlayer(r),e.count=0,e.costTime=0,e._inputBuffer=[],e._outputBuffer=[],e}return t=S,r=[{key:"connectState",get:function(){return this.player?this.player._connectState:-1}},{key:"sampleRate",get:function(){return this.audioCtx?this.audioCtx.sampleRate:0}},{key:"debugger",get:function(){return this.config.logger||"undefined"!=typeof window&&window.location&&window.location.href.indexOf("xgplayerdebugger=1")>-1},set:function(e){this.config.logger=e}},{key:"log",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.debugger&&(t=console).log.apply(t,["[MammonEngine][LOG]".concat(this.playerId,"  ").concat(e)].concat(n))}},{key:"attachPlayer",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(this.config.processorUrl){if(e&&"undefined"!=typeof Window&&(window.AudioContext||window.webkitAudioContext)){var i=e.video||e;if(this.player!==i){if(this.player&&this.detachPlayer(this.player),this.player=i,this.playerId=e.playerId||(new Date).getTime(),this.player._connectState||this._changeConnectState(2),!this.checkCrossOrigin(this.player)){var o=this._getError(16,"VALUE_OF_VIDEO[crossOrigin]_IS_INVALID");return console.error(o.error,o),void this.emit("error",o)}var s=this.player._source;s&&s.context?this.audioCtx=s.context:this.audioCtx=n||S.getAudioContext(this.config.sampleRate),r&&Object.keys(r).forEach((function(e){t.config.meta[e]=r[e]})),Object.keys(v).forEach((function(e){t.player.addEventListener(e,t[v[e]])})),this.audioCtx.addEventListener("statechange",this._onAudioContextStatechange),this._initEffect()}}}else{var a=this._getError(15,"config_processorUrl_IS_NULL");console.error(a.error,a)}}},{key:"detachPlayer",value:function(){if(this.player){var e=this.player;this.log("detachPlayer",this.playerId);for(var t=e._effectNode,r=Object.keys(v),n=0;n<r.length;n++)e.removeEventListener(r[n],this[v[r[n]]]);var i=this.config;this.audioCtx.removeEventListener("statechange",this._onAudioContextStatechange),this.freeEffectNode(t,i.needReuse),e._effectNode=null,this.player=null,this.audioCtx=null,this._inputBuffer=[],this._outputBuffer=[]}}},{key:"updateMeta",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.log("updateMeta",t,this.config.meta),this.config.meta||(this.config.meta={}),Object.keys(t).map((function(r){e.config.meta[r]=t[r]})),this.audioCtx&&this.player){var r=this.audioCtx,n=this.player,i=this.getParams(r,t);if(i)n._effectNode?(this.updateEffectNode(n._effectNode,i),r.state===y&&4!==n._connectState&&this.connectEffect(this.audioCtx,this.player,this.config.meta,"updateMeta")):this._initEffect();else{this.disconnectEffect(r,this.player);var o=this._getError(15,"meta_info_error_update");this.emit("error",o)}}}},{key:"checkCrossOrigin",value:function(e){var t=e.getAttribute("crossorigin");return this.log("checkCrossOrigin ",t),e instanceof HTMLMediaElement&&("anonymous"===t||"use-credentials"===t)}},{key:"_initEffect",value:function(){var e=this,t=this.audioCtx,r=this.config;try{this._addWorkletModule(t,r.processorUrl,(function(r){if(e.audioCtx&&e.player){if(r)return console.error("addWorkletModule error",r),void e.emit("error",r);e.audioCtx._isReady=!0;var n=e.getParams(t,e.config.meta);if(n){var i=e.player._effectNode;if(!i)try{if(!(i=e.getEffectNode(e.audioCtx,n,e.playerId))){var o=e._getError(14,"getEffectNode_error");return e.log("getEffectNode error"),void e.emit("error",o)}}catch(t){var s=e._getError(14,"createEffectNode_".concat(t.message));return e.log("getEffectNode error1",t),void e.emit("error",s)}i.onprocessorerror=e._onprocessorerror,i.port.onmessage=e._onPortMessage,e.player._effectNode=i,m(i,i.context.destination),e.audioCtx.state===y&&e.connectEffect(e.audioCtx,e.player,e.config.meta,"_initEffect"),e.log("addWorkletModule success audioCtx.state",e.audioCtx.state)}else{e.log("meta info error",e.config.meta);var a=e._getError(13,"meta_info_error");e.emit("error",a)}}}))}catch(e){var n=this._getError(16,e.message);this.emit("error",n),console.error("LOG ",e)}}},{key:"getParams",value:function(e,t){return t&&t.peak&&t.loudness?{sampleRate:e.sampleRate,numChannels:e.destination.channelCount,source_peak:t.peak||.99,source_lufs:t.loudness||-8,target_lufs:t.targetLufs||-16,debugger:this.config.debugger||!1,needPcmData:this.config.needPcmData,maxCount:e.sampleRate/128}:null}},{key:"connectEffect",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,i=t._effectNode,o=t._connectState;if(this.log(" [connectEffect] step:".concat(n," _connectState:").concat(o," audioCtx.state:").concat(e.state)),i&&t&&e.state===y){var s=this.getParams(e,r);if(s){this.log(" [connectEffect] params",s);try{var a=this._getSource(e,t);if(!a)throw new Error("init_or_createMediaElementSource error");4!==o&&(d(a,e.destination),m(a,i),m(i,e.destination),this._changeConnectState(4),this.updateEffectNode(i,s)),this.enableEffectNode(i),this.emit("ready",this._getStateInfo())}catch(r){console.error(" [connectEffect] error",r);var c=this._getError(21,r.message||"connect_effect_error");this.emit("error",c),this.disableEffectNode(e._effectNode),this.connectSource(e,t._source)}}else this.log(" [connectEffect] param is null cantt connect")}else this.log(" [connectEffect] not meet connect conditions")}},{key:"disconnectEffect",value:function(e,t){if(e&&t)try{var r=t._effectNode,n=t._source;this.disableEffectNode(r),d(n,r),d(r,e.destination),m(n,e.destination),this._changeConnectState(3)}catch(e){var i=this._getError(41,e.message||"disconnect_error");this.emit("error",i),console.error("disconnectEffect error",e)}}},{key:"connectSource",value:function(e,t){if(e&&t)try{t.connect(e.destination),this._changeConnectState(3)}catch(e){var r=this._getError(22,e.message||"connect_source_error");this.emit("error",r)}}},{key:"_changeConnectState",value:function(e){this.player&&(this.player._connectState=e,this.emit("connect_state",e))}},{key:"_getSource",value:function(e,t){try{var r=t._source;return r||(r=e.createMediaElementSource(t),t._source=r,r.connect(e.destination)),r}catch(e){return null}}},{key:"_addWorkletModule",value:function(e,t,r){var n=this;if(e){if(e._isReady)return this.log("_addWorkletModule _isReady"),void r(null);try{var i=e.audioWorklet;if(!i||!i.addModule)return void r(this._getError(11,"audioWorklet_is_undefined"));i.addModule(t).then((function(e){n.debugger,r(null)})).catch((function(e){console.error("audioWorklet.addModule error",e),r(n._getError(12,e.message))}))}catch(e){console.error("audioWorklet Error",e),r(this._getError(13,e.message||"audioWorklet_error"))}}else r(new Error("audioCtx is null"))}},{key:"getEffectNode",value:function(e,t,r){for(var n=null,i=0;i<g.length;i++)if(!g[i]._running){n=g[i];break}return n?n.port.postMessage({type:"UPDATE",param:t}):(console.log(">>>new AudioWorkletNode"),n=new AudioWorkletNode(e,this.config.processorName,{outputChannelCount:[e.destination.channelCount],processorOptions:t}),g.push(n)),n._running=!0,n._playerId=r,n}},{key:"freeEffectNode",value:function(e,t){this.disconnectEffect(this.audioCtx,this.player),e&&(e.onprocessorerror=null,e.port.onmessage=null,e._playerId=null,e._running=!1,!t&&this.destroyEffectNode(e))}},{key:"_checkSample",value:function(e){this.costTime=e.duration,this.emit("sample",{costTime:e.duration})}},{key:"_cacheBuffer",value:function(e,t){for(var r=!0,n=0;n<e[0].length;n++)if(0!==e[0][n]){r=!1;break}!r&&this.config.needPcmData&&(this.count++,this._inputBuffer.push(e),this._outputBuffer.push(t))}},{key:"_getError",value:function(e,t){return i(i({},this._getStateInfo()),{},{error:"".concat(e,"_").concat(t),code:e})}},{key:"_getStateInfo",value:function(){var e=this.player,t=this.config,r=this.audioCtx,n=t.meta||{};return{version:b,state:r?r.state:0,connectState:e?e._connectState:0,volume:e?e.volume:-1,muted:e?e.muted?1:0:-1,costTime:this.costTime,peak:parseFloat(n.peak)||0,loudness:parseFloat(n.loudness)||0,targetLufs:parseFloat(n.targetLufs)||0,currentTime:e?e.currentTime:-1}}},{key:"resume",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";if(e){if(e){this.log("call audioCtx.resume step: ".concat(r));try{var n=e.resume();return n&&n.then&&n.then((function(){t.log("audioCtx.resume success",r)})).catch((function(e){console.error("audioCtx.resume error",r,e)})),n}catch(e){console.error("audioCtx.resume error",r)}}}else e=this.audioCtx}},{key:"updateEffectNode",value:function(e,t){e&&e.port.postMessage({type:"UPDATE",param:t})}},{key:"enableEffectNode",value:function(e){e&&e.port.postMessage({type:"ENABLE"})}},{key:"disableEffectNode",value:function(e){e&&e.port.postMessage({type:"DISABLE"})}},{key:"destroyEffectNode",value:function(e){this.log("destroyEffectNode"),e&&e.port.postMessage({type:"DESTROY"})}},{key:"emit",value:function(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];(r=l(a(S.prototype),"emit",this)).call.apply(r,[this,e,t].concat(i))}},{key:"on",value:function(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];(r=l(a(S.prototype),"on",this)).call.apply(r,[this,e,t].concat(i))}},{key:"once",value:function(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];(r=l(a(S.prototype),"once",this)).call.apply(r,[this,e,t].concat(i))}},{key:"off",value:function(e,t){for(var r,n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];(r=l(a(S.prototype),"off",this)).call.apply(r,[this,e,t].concat(i))}},{key:"offAll",value:function(){l(a(S.prototype),"removeAllListeners",this).call(this)}},{key:"destroy",value:function(){this.offAll(),this.detachPlayer()}}],n=[{key:"getAudioContext",value:function(e){if("undefined"==typeof window)return null;var t=window.AudioContext||window.webkitAudioContext;if(!t||!S.isSupported)return null;if(0===_.length&&_.push(new t),!e)return _[0];var r=null;return _.forEach((function(t){t.sampleRate===e&&(r=t)})),r||(r=new t({sampleRate:e}),_.push(r)),r}},{key:"isSupported",value:function(){return"undefined"!=typeof window&&"undefined"!=typeof WebAssembly&&(window.AudioContext||window.webkitAudioContext)}},{key:"__AUDIO_CONTEXT_LIST",get:function(){return _}},{key:"autoSampleRate",get:function(){return _.length>0?_[0].sampleRate:0}},{key:"__EFFECT_NODES",get:function(){return g}},{key:"version",get:function(){return b}}],r&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),S}(p())},13459:function(e){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=13)}([function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(14);function i(){return"undefined"!=typeof Reflect&&Reflect.get?(e.exports=i=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,r){var i=n(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(this,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(15);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(11).default,i=r(7);e.exports=function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(16)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},function(e,t){function r(e,t,r,n,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var s=e.apply(t,n);function a(e){r(s,i,o,a,c,"next",e)}function c(e){r(s,i,o,a,c,"throw",e)}a(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(17),i=r(18),o=r(19),s=r(20);e.exports=function(e){return n(e)||i(e)||o(e)||s()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){e.exports=r(21)},function(e,t,r){var n=r(0);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t,n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(11).default;function i(){"use strict";e.exports=i=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},r=Object.prototype,o=r.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var i=t&&t.prototype instanceof d?t:d,o=Object.create(i.prototype),s=new Y(n||[]);return o._invoke=function(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=k(s,r);if(a){if(a===p)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=h(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,s),o}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var p={};function d(){}function m(){}function y(){}var v={};l(v,a,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(D([])));b&&b!==r&&o.call(b,a)&&(v=b);var _=y.prototype=d.prototype=Object.create(v);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,t){var r;this._invoke=function(i,s){function a(){return new t((function(r,a){!function r(i,s,a,c){var u=h(e[i],e,s);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==n(f)&&o.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,c)}))}c(u.arg)}(i,s,r,a)}))}return r=r?r.then(a,a):a()}}function k(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var n=h(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,p;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Y(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function D(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:O}}function O(){return{value:void 0,done:!0}}return m.prototype=y,l(_,"constructor",y),l(y,"constructor",m),m.displayName=l(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,u,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},S(M.prototype),l(M.prototype,c,(function(){return this})),t.AsyncIterator=M,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var s=new M(f(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},S(_),l(_,u,"Generator"),l(_,a,(function(){return this})),l(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=D,Y.prototype={constructor:Y,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var a=o.call(i,"catchLoc"),c=o.call(i,"finallyLoc");if(a&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;x(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:D(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(12);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(12);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";r.r(t),r.d(t,"StreamPlayer",(function(){return Ft})),r.d(t,"BasicPlayer",(function(){return Jt})),r.d(t,"storage",(function(){return Ut}));var n=r(9),i=r.n(n),o=r(2),s=r.n(o),a=r(3),c=r.n(a),u=r(1),l=r.n(u),f=r(4),h=r.n(f),p=r(5),d=r.n(p),m=r(0),y=r.n(m),v=r(8),g=r.n(v),b=r(10),_=r.n(b),S={playback:{autoplay:!1,loop:!1,muted:!1,metaChunkSize:209715.2,dataChunkSize:1048576,bufferEnoughTime:.5,bufferMaxTime:3,bufferCheckingInterval:100,preload:"auto"},subtitle:{rect:{width:250,height:50,top:200,left:100},style:{whiteSpace:"nowrap"}},memory:{defaultBufferSize:10485760}},M=r(7),k=r.n(M),w=r(6),x=r.n(w),Y=function(){function e(){s()(this,e),this._events=[],this._callbacks={}}return c()(e,[{key:"register",value:function(e){this._events.includes[e]||this._events.push(e)}},{key:"on",value:function(e,t){return!!this._events.includes(e)&&(this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t),!0)}},{key:"off",value:function(e,t){if(!this._events.includes(e))return!1;var r=this._callbacks[e].indexOf(t);return this._callbacks[e].splice(r,1),!0}},{key:"trigger",value:function(e,t){if(!this._callbacks[e]||!this._callbacks[e].length)return!1;var r=null;return this._callbacks[e].forEach((function(e,n){0==n?r=e(t):e(t)})),r}},{key:"events",get:function(){return this._events},set:function(e){var t=this;e.forEach((function(e){t.register(e)}))}}]),e}();var D=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s()(this,r),n=t.call(this),x()(k()(n),"_updateStyle",(function(){var e="";n.selfRender?e="::cue {line-height:"+n._rect.height+"px; white-space: "+n._style.whiteSpace+";}":n.styleNode||(e="::cue { opacity: 0; }"),e.length&&(n.styleNode&&n.styleNode.remove(),n.styleNode=document.createElement("style"),n.styleNode.textContent=e,document.head.append(n.styleNode))})),x()(k()(n),"_updateRect",(function(){if(n.selfRender&&n.textTrack&&n.textTrack.track&&n.textTrack.track.cues)for(var e=0;e<n.textTrack.track.cues.length;e++){var t=n.textTrack.track.cues[e];t.line=Math.floor(n._rect.top/n._rect.height),t.size=Math.floor(n._rect.width/n.el.offsetWidth*100);var r=Math.floor(t.size/2),i=Math.floor(100-t.size/2),o=Math.floor(n._rect.left/n.el.offsetWidth*100);o<r&&(o=r),o>i&&(o=i),t.position=o}})),x()(k()(n),"_initTextTrack",(function(){n.textTrack=document.createElement("track"),n.textTrack.default=!0,n.textTrack.kind="captions",n.textTrack.label="English",n.textTrack.srclang="en",n.textTrack.oncuechange=function(e){var t,r,i=null===(t=e.target)||void 0===t||null===(r=t.track)||void 0===r?void 0:r.activeCues;i&&i.length&&(n.selfRender||(i[0].track.mode="hidden"),n.trigger("SUBTITLE_CHANGED",{id:i[0].id,text:i[0].text,startTime:i[0].startTime,endTime:i[0].endTime,textTrack:n.textTrack,cues:i})),n._updateRect()}})),x()(k()(n),"load",(function(e){return fetch(e).then((function(e){return e.text()})).then((function(e){var t=new Blob([e],{type:"text/vtt"});n.textTrack&&(n.textTrack.src=URL.createObjectURL(t),n.el.appendChild(n.textTrack),n.trigger("SUBTITLE_LOADED",null))}))})),x()(k()(n),"reset",(function(){n.textTrack&&(n.textTrack.src&&URL.revokeObjectURL(n.textTrack.src),n.textTrack.parentNode&&n.textTrack.parentNode.removeChild(n.textTrack),n.textTrack=null),n.styleNode&&(n.styleNode.remove(),n.styleNode=null)})),n.el=e,n.config=i,n.styleNode=null,n.textTrack=null,n.selfRender=n.config.selfRender||S.subtitle.selfRender,n._initTextTrack(),n.rect=i.rect||S.subtitle.rect,n.style=i.style||S.subtitle.style,n.events=["SUBTITLE_CHANGED","SUBTITLE_LOADED"],n}return c()(r,[{key:"rect",set:function(e){this._rect=e,this._updateRect()}},{key:"style",set:function(e){this._style=e,this._updateStyle()}}]),r}(Y);var O=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this)).el=e,i.events=n,i.proxyEvents=[],i}return c()(r,[{key:"bind",value:function(e,t){l()(y()(r.prototype),"on",this).call(this,e,t)||this.el.addEventListener(e,t)}},{key:"remove",value:function(e,t){l()(y()(r.prototype),"off",this).call(this,e,t)||this.el.removeEventListener(e,t)}},{key:"proxy",value:function(e,t){var n=this;this.register(e),this.proxyEvents.push(e),l()(y()(r.prototype),"on",this).call(this,e,t),this.el.addEventListener(e,(function(t){l()(y()(r.prototype),"trigger",n).call(n,e,t)}))}}]),r}(Y),E=["AUTOPLAY_PREVENTED"],T=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;s()(this,e),this.type=t,this.config=r,this.el=document.createElement("video"),this.config.container&&this.config.container.appendChild(this.el),this.eventManager=new O(this.el,[].concat(_()(E),_()(n))),this.subtitle=null,this.isReady=!1,this._initAttributes()}var t;return c()(e,[{key:"_initAttributes",value:function(){this.el.autoplay=this.config.autoplay||S.playback.autoplay,this.el.loop=this.config.loop||S.playback.loop,this.el.muted=this.config.muted||S.playback.muted,this.el.controls=!1,this.el.playsInline=!0,this.el.preload=this.config.preload||S.playback.preload}},{key:"_initEvents",value:function(){var e=this;this.eventManager.proxy("canplay",(function(){e.isReady=!0}))}},{key:"load",value:function(e){this.el.src!==e&&(this.el.src=e)}},{key:"play",value:function(){var e=this;return new Promise((function(t,r){e.el.play().then((function(){t()})).catch((function(t){e.eventManager.trigger("AUTOPLAY_PREVENTED",{url:e.el.src,errorName:t.name,error:t})}))}))}},{key:"pause",value:function(){this.el.pause()}},{key:"seek",value:function(e){this.el.currentTime=e}},{key:"mute",value:function(e){this.el.muted=e}},{key:"addSubtitle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;return this.subtitle&&(this.subtitle.reset(),this.subtitle=null),this.subtitle=new D(this.el,t),this.subtitle.on("SUBTITLE_CHANGED",r),this.subtitle.on("SUBTITLE_LOADED",n),this.subtitle.load(e)}},{key:"access",value:function(){var e=this;return this.el.play().then((function(){e.el.pause()}))}},{key:"reset",value:function(){this.pause(),this.el.src=""}},{key:"on",value:function(e,t){this.eventManager.bind(e,t)}},{key:"off",value:function(e,t){this.eventManager.remove(e,t)}},{key:"replay",value:(t=i()(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.seek(0),e.prev=1,e.next=4,this.play();case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(){return t.apply(this,arguments)})},{key:"currentTime",get:function(){return this.el.currentTime}},{key:"playing",get:function(){return!this.el.paused}},{key:"duration",get:function(){return this.el.duration}},{key:"bufferRanges",get:function(){for(var e=[],t=0;t<this.el.buffered.length;t++)e.push({startTime:this.el.buffered.start(t),duration:this.el.buffered.end(t)-this.el.buffered.start(t)});return e}},{key:"volume",set:function(e){this.el.volume=e}},{key:"speed",set:function(e){this.el.playbackRate=e}},{key:"release",value:function(){this.isReady=!1}},{key:"getQualityInfo",value:function(){return this.el.getVideoPlaybackQuality?this.el.getVideoPlaybackQuality():{corruptedVideoFrames:0,creationTime:performance.now(),droppedVideoFrames:this.el.webkitDroppedFrameCount||0,totalVideoFrames:this.el.webkitDecodedFrameCount||0}}}]),e}();T.isSoftwareRender=function(){try{var e=document.createElement("canvas").getContext("webgl"),t=e.getExtension("WEBGL_debug_renderer_info");return e.getParameter(t.UNMASKED_RENDERER_WEBGL).includes("SwiftShader")}catch(e){return!0}};var R=T;var L=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s()(this,r),e=t.call(this),x()(k()(e),"_downloadChunk",(function(){if(!(e.loading||e._totalSize&&e._chunkOffset>=e._totalSize)){var t=function(){var e=performance.now();return function(){return(performance.now()-e)/1e3}}(),r=e._chunkSize,n=e._chunkOffset,i=e.url,o=new XMLHttpRequest;e.xhr=o,o.open("GET",i,!0),o.withCredentials=!!e.config.withCredentials,o.responseType="arraybuffer",o.start=e._chunkOffset,o.setRequestHeader("Range","bytes="+e._chunkOffset+"-"+(e._chunkOffset+r-1)),o.onerror=function(t){0!==t.target.status&&void 0!==t.target.status||e.trigger("ERROR",{name:"CORS_ERROR",url:i})},o.onreadystatechange=function(s){if(403===o.status&&e.trigger("ERROR",{name:"FORBIDDEN_ERROR",url:i,code:403}),4==o.readyState&&(e.loading=!1,200==o.status||206==o.status||304==o.status||416==o.status)){if(416==o.status)return void e.trigger("ERROR",{url:i,name:"RANGE_ERROR",code:416,range:"bytes="+n+"-"+(n+r-1)});if(i!=e.url)return;var a=null;if(o.getAllResponseHeaders().toLocaleLowerCase().indexOf("content-range")>=0&&(a=o.getResponseHeader("content-range")),!e._totalSize&&a){var c=a.split("/");2==c.length&&(e._totalSize=parseInt(c[1]),e.trigger("FILE_SIZE",e._totalSize))}e.eof=o.response.byteLength!=r||o.response.byteLength==e._totalSize,e.lastChunkNetworkTime=t(),e.trigger("CHUNK_READY",{data:o.response,eof:e.eof,chunkOffset:n,chunkSize:r,totalSize:e._totalSize,networkDuration:e.lastChunkNetworkTime}),e.eof||e.paused?e.eof&&e.trigger("EOF",null):e.timeoutId=setTimeout((function(){e._chunkOffset+=r,e._downloadChunk()}),0)}},e.loading=!0,o.send()}})),x()(k()(e),"load",(function(t){e.url=t})),x()(k()(e),"start",(function(){e.url&&(e.eof=!1,e.paused=!1,e.chunkOffset=0,e.switchToInitSize(),e._downloadChunk())})),x()(k()(e),"pause",(function(){e.paused=!0})),x()(k()(e),"resume",(function(t){!e.paused||e.loading||e.eof||(e.paused=!1,null!=t?e._chunkOffset=t:e._chunkOffset+=e._chunkSize,e._downloadChunk())})),x()(k()(e),"release",(function(){e.xhr&&(e.xhr.abort(),e.xhr=null,e.loading=!1),e.eof=!0,e.paused=!0,e.timeoutId&&clearTimeout(e.timeoutId),e.switchToInitSize(),e._chunkOffset=0,e._totalSize=0,e.url=""})),e.config=n,e._chunkSize=0,e._chunkOffset=0,e._totalSize=0,e.url="",e._initChunkSize=-1,e._commonChunkSize=-1,e.lastChunkNetworkTime=0,e.eof=!0,e.paused=!0,e.loading=!1,e.timeoutId=null,e.xhr=null,e.events=["CHUNK_READY","FILE_SIZE","EOF","ERROR"],e}return c()(r,[{key:"chunkSize",set:function(e){!e||e<0||(this._chunkSize=Math.ceil(e))}},{key:"initChunkSize",set:function(e){!e||e<0||(this._initChunkSize=Math.ceil(e))}},{key:"commonChunkSize",set:function(e){!e||e<0||(this._commonChunkSize=Math.ceil(e))}},{key:"switchToCommonSize",value:function(){this._commonChunkSize<=0||(this.chunkSize=this._commonChunkSize)}},{key:"switchToInitSize",value:function(){this._initChunkSize<=0||(this.chunkSize=this._initChunkSize)}},{key:"chunkOffset",set:function(e){this._chunkOffset=e}}]),r}(Y),C=new(c()((function e(){var t=this;s()(this,e),x()(this,"create",(function(e,r,n){return new t.defs[e](r,n)})),x()(this,"define",(function(e,r){t.defs[e]=r})),x()(this,"isSupported",(function(e){return t.defs[e]})),this.defs={}}))),P=Math.pow(2,32),A=function(e,t,r,n,i){var o=new Uint8Array(e,t,i),s=new Uint8Array(r,n,i);o.set(s)},z=function(e,t){return e+t},B=function(e,t){return{value:e.getUint8(t),position:t+1}},I=function(e,t){return{value:e.getUint16(t),position:t+2}},j=function(e,t,r){return{value:e.getUint32(t,!r),position:t+4}},H=function(e,t,r){return e.setUint8(t,r),t+1},U=function(e,t,r){return e.setUint16(t,r),t+2},N=function(e,t,r){return e.setInt32(t,r),t+4},F=function(e,t,r){return e.setUint32(t,r),t+4},G=A,J=z,K=B,V=I,q=function(e,t){return{value:e.getInt16(t),position:t+2}},W=function(e,t){var r=I(e,t),n=r.value<<16;return t=r.position,{value:n|(r=B(e,t)).value,position:t=r.position}},X=j,$=function(e,t,r){return{value:e.getInt32(t,!r),position:t+4}},Q=function(e,t,r){var n=j(e,t,r),i=n.value;t=n.position;var o=(n=j(e,t,r)).value;return t=n.position,{value:r?i*P+o:o*P+i,position:t}},Z=function(e,t,r){return{value:null,position:z(t,8)}},ee=function(e,t,r){for(var n=[],i=t;i<t+r;i++)n.push(e.getUint8(i));return{value:String.fromCharCode.apply(null,n),position:t+r}},te=function(e,t,r){var n=new Uint8Array(r);return A(n.buffer,0,e.buffer,t,r*n.BYTES_PER_ELEMENT),{value:n,position:t+n.byteLength}},re=H,ne=function(e,t,r){return e.setInt16(t,r),t+2},ie=U,oe=function(e,t,r){return t=H(e,t,(16711680&r)>>16),t=H(e,t,(65280&r)>>8),H(e,t,255&r)},se=N,ae=F,ce=function(e,t,r){var n=Math.floor(r/P);return t=F(e,t,n),F(e,t,4294967295&r)},ue=function(e,t,r,n){var i=Math.min(r.length,n),o=0;for(o=0;o<i;o++)t=H(e,t,r.charCodeAt(o));for(;o<n;o++)t=H(e,t,0);return t},le=function(e,t,r){if(r instanceof Uint8Array)A(e.buffer,t,r.buffer,0,r.byteLength),t+=r.byteLength;else for(var n=0;n<r.length;n++)t=H(e,t,r[n]);return t},fe=function(e,t,r){if(r instanceof Uint32Array)A(e.buffer,t,r.buffer,0,r.byteLength),t+=r.byteLength;else for(var n=0;n<r.length;n++)t=F(e,t,r[n]);return t},he=function(e,t,r){r=r||0;var n=new ArrayBuffer(t),i=new Uint8Array(n),o=new Uint8Array(e,r,t);return i.set(o),n},pe=function(e,t){var r=Number(e).toString(16);for(t=null==t?t=2:t;r.length<t;)r="0"+r;return r};var de=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n,i){var o;return s()(this,r),(o=t.call(this)).offset=i,o.type=e,o.size=n,o}return c()(r,[{key:"parse",value:function(e,t){}},{key:"write",value:function(e,t){var r=this;return this.offset=t,t=J(t,4),{position:t=ue(e,t,this.type,4),writeSize:function(t){return r.size=t-r.offset,r.size,ae(e,r.offset,r.size),t}}}}]),r}(Y);var me=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"ftyp",e,n)).data=null,i.majorBrand=null,i.minorVersion=null,i.compatibleBrands=[],i}return c()(r,[{key:"parse",value:function(e,t){if(r.skippable){var n=te(e,t,this.size-8);this.data=n.value,t=n.position}else{var i=this.size-8,o=ee(e,t,4);for(this.majorBrand=o.value,t=o.position,o=X(e,t,!0),this.minorVersion=o.value,t=o.position,i-=8,this.compatibleBrands=[];i>=4;){var s=ee(e,t,4);this.compatibleBrands.push(s.value),t=s.position,i-=4}}return t}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);if(t=n.position,this.data)t=le(e,t,this.data);else{t=ue(e,t,this.majorBrand,4),t=ae(e,t,this.minorVersion);for(var i=0;i<this.compatibleBrands.length;i++)t=ue(e,t,this.compatibleBrands[i],4)}return n.writeSize(t),t}}]),r}(de);me.type="ftyp",me.skippable=!0,C.define(me.type,me);var ye=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n,i){var o;return s()(this,r),(o=t.call(this,e,n,i)).boxes=[],o.events=["SUB_BOX"],o.lastPosition=-1,o.listBoxes=[],o}return c()(r,[{key:"parse",value:function(e,t){for(;t<this.offset+this.size;){this.lastPosition=t;var r=this.trigger("SUB_BOX",{position:t});if(r){t=r.position;var n=r.type;this.listBoxes&&this.listBoxes.length&&this.listBoxes.indexOf(n)>=0?(this[r.type]||(this[r.type]=[]),this[r.type].push(r.box)):this[r.type]=r.box,this.boxes.push(r.type)}if(t==this.lastPosition)break}}},{key:"write",value:function(e,t){var n=this,i=l()(y()(r.prototype),"write",this).call(this,e,t);return{position:t=i.position,writeSize:function(e){return i.writeSize(e)},writeSubBoxes:function(e,t){for(var r=0;r<n.boxes.length;r++){var i=n.boxes[r];if(n[i]&&!n[i].unwritable)if(n.listBoxes&&n.listBoxes.length&&n.listBoxes.indexOf(i)>=0)for(var o=0;o<n[i].length;o++)t=n[i][o].write(e,t),n.size+=n[i][o].size;else t=n[i].write(e,t),n.size+=n[i].size}return t}}}},{key:"addSubBox",value:function(e,t){this[e=e||t.type]=t,this.boxes.push(e)}}]),r}(de);var ve=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"moov",e,n)).listBoxes=["trak"],i}return c()(r,[{key:"parse",value:function(e,t){l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=n.writeSubBoxes(e,t),n.writeSize(t),t}},{key:"duration",get:function(){return this.mvhd?this.mvhd.duration:0}},{key:"timescale",get:function(){return this.mvhd?this.mvhd.timescale:1}}]),r}(ye);ve.type="moov",C.define(ve.type,ve);var ge=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n,i){var o;return s()(this,r),(o=t.call(this,e,n,i)).version=0,o.flags=0,o}return c()(r,[{key:"parse",value:function(e,t){var r=K(e,t);return this.version=r.value,t=r.position,r=W(e,t),this.flags=r.value,r.position}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=re(e,t,this.version),{position:t=oe(e,t,this.flags),writeSize:function(e){return n.writeSize(e)}}}}]),r}(de);var be=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"mvhd",e,n)).data=null,i.creationTime=null,i.modificationTime=null,i.timescale=null,i.duration=null,i.rate=null,i.volume=null,i.nextTrackId=null,i}return c()(r,[{key:"parse",value:function(e,t){if(r.skippable){var n=t;t=l()(y()(r.prototype),"parse",this).call(this,e,t);var i=te(e,t,this.size-8-(t-n));return this.data=i.value,n=i.position,1==this.version?(t=J(t,16),i=X(e,t,!0),this.timescale=i.value,t=i.position,i=Q(e,t,!0),this.duration=i.value,t=i.position):(t=J(t,8),i=X(e,t,!0),this.timescale=i.value,t=i.position,i=X(e,t,!0),this.duration=i.value,t=i.position),n}t=l()(y()(r.prototype),"parse",this).call(this,e,t);var o=null;if(1==this.version)o=Q(e,t,!0),this.creationTime=o.value,t=o.position,o=Q(e,t,!0),this.modificationTime=o.value,t=o.position,o=X(e,t,!0),this.timescale=o.value,t=o.position,o=Q(e,t,!0),this.duration=o.value,t=o.position;else{var s=X(e,t,!0);this.creationTime=s.value,t=s.position,s=X(e,t,!0),this.modificationTime=s.value,t=s.position,s=X(e,t,!0),this.timescale=s.value,t=s.position,s=X(e,t,!0),this.duration=s.value,t=s.position}return o=X(e,t,!0),this.rate=o.value,t=o.position,o=V(e,t),this.volume=o.value>>8,t=o.position,o=function(e,t,r){var n=new Uint32Array(r);return A(n.buffer,0,e.buffer,t,r*n.BYTES_PER_ELEMENT),{value:n,position:t+n.byteLength}}(e,t=J(t,10),9),this.matrix=o.value,t=o.position,t=J(t,24),o=X(e,t,!0),this.nextTrackId=o.value,o.position}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,this.data?t=le(e,t,this.data):(t=ae(e,t,this.creationTime),t=ae(e,t,this.modificationTime),t=ae(e,t,this.timescale),t=ae(e,t,this.duration),t=ae(e,t,this.rate),t=ie(e,t,this.volume<<8),t=J(t,10),t=fe(e,t,this.matrix),t=J(t,24),t=ae(e,t,this.nextTrackId)),n.writeSize(t),t}}]),r}(ge);be.type="mvhd",be.skippable=!0,C.define(be.type,be);var _e=function(){function e(t,r){s()(this,e),this.index=t,this.trackId=r,this.dts=0,this.timescale=1,this.size=0,this.read=!1}return c()(e,[{key:"timestamp",get:function(){return this.dts/this.timescale}}]),e}();var Se=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),i=t.call(this,"trak",e,n),x()(k()(i),"buildSamples",(function(){if(i.sampleIndex=0,i.samples=[],i.samplesDuration=0,i.samplesSize=0,i.mdia&&i.mdia.minf&&i.mdia.minf.stbl){var e=i.mdia.minf.stbl.stco,t=i.mdia.minf.stbl.stsc,r=i.mdia.minf.stbl.stsz,n=i.mdia.minf.stbl.stts,o=i.mdia.minf.stbl.ctts,s=i.mdia.minf.stbl.stss,a=i.mdia.minf.stbl.stsd;if(r&&r.sampleSizes&&r.sampleSizes.length)for(var c=0,u=-1,l=-1,f=-1,h=-1,p=0,d=-1,m=-1,y=-1,v=-1,g=0;g<r.sampleSizes.length;g++){var b=new _e(g,i.id);b.timescale=i.timescale,i.samples[g]=b,b.size=r.sampleSizes[g],i.samplesSize+=b.size,0===g?(d=1,m=0,b.chunkIndex=d,b.chunkRunIndex=m,y=t.samplesPerChunk[m],c=0,v=m+1<t.firstChunk.length?t.firstChunk[m+1]-1:1/0):g<y?(b.chunkIndex=d,b.chunkRunIndex=m):(d++,b.chunkIndex=d,c=0,d<=v||(v=1+ ++m<t.firstChunk.length?t.firstChunk[m+1]-1:1/0),b.chunkRunIndex=m,y+=t.samplesPerChunk[m]),b.descriptionIndex=t.sampleDescriptionIndex[b.chunkRunIndex]-1,b.description=a.entries[b.descriptionIndex],b.offset=e.chunkOffsets[b.chunkIndex-1]+c,c+=b.size,g>u&&(l++,u<0&&(u=0),u+=n.sampleCounts[l]),g>0?(i.samples[g-1].duration=n.sampleDeltas[l],i.samplesDuration+=i.samples[g-1].duration,b.dts=i.samples[g-1].dts+i.samples[g-1].duration,g==r.sampleSizes.length-1&&(b.duration=n.sampleDeltas[l],i.samplesDuration+=b.duration)):b.dts=0,o?(g>=f&&(h++,f<0&&(f=0),f+=o.sampleCounts[h]),b.cts=i.samples[g].dts+o.sampleOffsets[h]):b.cts=b.dts,s?g==s.sampleNumbers[p]-1?(b.iFrame=!0,p++):b.iFrame=!1:b.iFrame=!0}}})),x()(k()(i),"resetForFMP4",(function(){if(i.tkhd&&(i.tkhd.duration=0),i.mdia&&(i.mdia.mdhd&&(i.mdia.mdhd.duration=0),i.mdia&&i.mdia.minf&&i.mdia.minf.stbl)){var e=i.mdia.minf.stbl;if(e.stco&&(e.stco.chunkOffsets=[]),e.stsc){var t=e.stsc;t.firstChunk=[],t.samplesPerChunk=[],t.sampleDescriptionIndex=[]}if(e.stsz&&(e.stsz.sampleSizes=[]),e.stts){var r=e.stts;r.sampleCounts=[],r.sampleDeltas=[]}if(e.ctts){var n=e.ctts;n.sampleCounts=[],n.sampleOffsets=[]}}})),i}return c()(r,[{key:"parse",value:function(e,t){l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=n.writeSubBoxes(e,t),n.writeSize(t),t}},{key:"getSampleOffsetWithTime",value:function(e){if(!this.samples.length)return 0;for(var t=-1,r=-1,n=(this.samples[0].timescale,0);n<this.samples.length;n++){var i=this.samples[n];if(i.cts>e*i.timescale){t=Math.max(0,n-1);break}i.iFrame&&(r=n)}if(t=r)return 0;for(e=this.samples[t].cts,this.sampleIndex=t;this.samples[t].read&&t!=this.samples.length-1;)t++;return this.samples[t].offset}},{key:"id",get:function(){return this.tkhd?this.tkhd.trackId:0}},{key:"idString",get:function(){return"trak_"+this.id}},{key:"name",get:function(){return this.mdia&&this.mdia.hdlr?this.mdia.hdlr.handler:""}},{key:"isAudio",get:function(){return"soun"==this.name}},{key:"isVideo",get:function(){return"vide"==this.name}},{key:"duration",get:function(){return this.mdia&&this.mdia.mdhd?this.mdia.mdhd.duration:0}},{key:"calculatedDuration",get:function(){if(!this.samples.length)return 0;var e=this.samples[this.samples.length-1];return(e.cts+e.duration)/e.timescale}},{key:"timescale",get:function(){return this.mdia&&this.mdia.mdhd?this.mdia.mdhd.timescale:1}},{key:"sampleDesc",get:function(){return this.mdia&&this.mdia.minf&&this.mdia.minf.stbl&&this.mdia.minf.stbl.stsd&&this.mdia.minf.stbl.stsd.entries.length?this.mdia.minf.stbl.stsd.entries[0]:null}},{key:"codec",get:function(){return this.sampleDesc?this.sampleDesc.getCodec():""}},{key:"sampleDuration",get:function(){return this.samples&&this.samples.length?this.samples[0].duration:0}}]),r}(ye);Se.type="trak",C.define(Se.type,Se);var Me=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"tkhd",e,n)).data=null,i.creationTime=null,i.modificationTime=null,i.trackId=null,i.duration=null,i.layer=null,i.alternateGroup=null,i.volume=null,i.matrix=null,i.width=null,i.height=null,i}return c()(r,[{key:"parse",value:function(e,t){if(r.skippable){var n=t;t=l()(y()(r.prototype),"parse",this).call(this,e,t);var i=te(e,t,this.size-8-(t-n));return this.data=i.value,n=i.position,1==this.version?(t=J(t,16),i=X(e,t,!0),this.trackId=i.value,t=i.position,t=J(t,4),i=Q(e,t,!0),this.duration=i.value,t=i.position):(t=J(t,8),i=X(e,t,!0),this.trackId=i.value,t=i.position,t=J(t,4),i=X(e,t,!0),this.duration=i.value,t=i.position),t=J(t,52),i=X(e,t,!0),this.width=i.value,t=i.position,i=X(e,t,!0),this.height=i.value,t=i.position,n}if(t=l()(y()(r.prototype),"parse",this).call(this,e,t),1==this.version){var o=Q(e,t,!0);this.creationTime=o.value,t=o.position,o=Q(e,t,!0),this.modificationTime=o.value,t=o.position,o=X(e,t,!0),this.trackId=o.value,t=o.position,t=(o=X(e,t,!0)).position,o=Q(e,t,!0),this.duration=o.value,t=o.position}else{var s=X(e,t,!0);this.creationTime=s.value,t=s.position,s=X(e,t,!0),this.modificationTime=s.value,t=s.position,s=X(e,t,!0),this.trackId=s.value,t=s.position,t=J(t,4),s=X(e,t,!0),this.duration=s.value,t=s.position}t=J(t,8);var a=q(e,t);return this.layer=a.value,t=a.position,a=q(e,t),this.alternateGroup=a.value,t=a.position,a=q(e,t),this.volume=a.value>>8,t=a.position,a=function(e,t,r){var n=new Int32Array(r);return A(n.buffer,0,e.buffer,t,r*n.BYTES_PER_ELEMENT),{value:n,position:t+n.byteLength}}(e,t=J(t,2),9),this.matrix=a.value,t=a.position,a=X(e,t,!0),this.width=a.value,t=a.position,a=X(e,t,!0),this.height=a.value,a.position}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,this.data?t=le(e,t,this.data):(t=ae(e,t,this.creationTime),t=ae(e,t,this.modificationTime),t=ae(e,t,this.trackId),t=J(t,4),t=ae(e,t,this.duration),t=J(t,8),t=ne(e,t,this.layer),t=ne(e,t,this.alternateGroup),t=ne(e,t,this.volume<<8),t=function(e,t,r){if(r instanceof Int32Array)A(e.buffer,t,r.buffer,0,r.byteLength),t+=r.byteLength;else for(var n=0;n<r.length;n++)t=N(e,t,r[n]);return t}(e,t=J(t,2),this.matrix),t=ae(e,t,this.width),t=ae(e,t,this.height)),n.writeSize(t),t}}]),r}(ge);Me.type="tkhd",Me.skippable=!0,C.define(Me.type,Me);var ke=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"edts",e,n)).unwritable=!0,i}return c()(r,[{key:"parse",value:function(e,t){l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=n.writeSubBoxes(e,t),n.writeSize(t),t}}]),r}(ye);ke.type="edts",C.define(ke.type,ke);var we=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"elst",e,n)).entries=[],i}return c()(r,[{key:"parse",value:function(e,t){if(r.skippable){var n=t;t=l()(y()(r.prototype),"parse",this).call(this,e,t);var i=te(e,t,this.size-8-(t-n));return this.data=i.value,i.position}t=l()(y()(r.prototype),"parse",this).call(this,e,t);var o=X(e,t,!0),s=o.value;t=o.position;for(var a=0;a<s;a++){var c={};this.entries.push(c),1===this.version?(o=Q(e,t,!0),c.segmentDuration=o.value,t=o.position,o=Z(0,t),c.mediaTime=o.value,t=o.position):(o=X(e,t,!0),c.segmentDuration=o.value,t=o.position,o=$(e,t,!0),c.mediaTime=o.value,t=o.position),o=q(e,t),c.mediaRateInteger=o.value,t=o.position,o=q(e,t),c.mediaRateFraction=o.value,t=o.position}return t}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);if(t=n.position,this.data)t=le(e,t,this.data);else{t=ae(e,t,this.entries.length);for(var i=0;i<this.entries.length;i++){var o=this.entries[i];t=ae(e,t,o.segmentDuration),t=se(e,t,o.mediaTime),t=ne(e,t,o.mediaRateInteger),t=ne(e,t,o.mediaRateFraction)}}return n.writeSize(t),t}}]),r}(ge);we.type="elst",we.skippable=!0,C.define(we.type,we);var xe=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"mdia",e,n)}return c()(r,[{key:"parse",value:function(e,t){l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=n.writeSubBoxes(e,t),n.writeSize(t),t}}]),r}(ye);xe.type="mdia",C.define(xe.type,xe);var Ye=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"mdhd",e,n)}return c()(r,[{key:"parse",value:function(e,t){if(r.skippable){var n=t;t=l()(y()(r.prototype),"parse",this).call(this,e,t);var i=te(e,t,this.size-8-(t-n));return this.data=i.value,n=i.position,1==this.version?(t=J(t,16),i=X(e,t,!0),this.timescale=i.value,t=i.position,i=Q(e,t,!0),this.duration=i.value,t=i.position):(t=J(t,8),i=X(e,t,!0),this.timescale=i.value,t=i.position,i=X(e,t,!0),this.duration=i.value,t=i.position),n}if(t=l()(y()(r.prototype),"parse",this).call(this,e,t),1==this.version){var o=Q(e,t,!0);this.creationTime=o.value,t=o.position,o=Q(e,t,!0),this.modificationTime=o.value,t=o.position,o=X(e,t,!0),this.timescale=o.value,t=o.position,o=Q(e,t,!0),this.duration=o.value,t=o.position}else{var s=X(e,t,!0);this.creationTime=s.value,t=s.position,s=X(e,t,!0),this.modificationTime=s.value,t=s.position,s=X(e,t,!0),this.timescale=s.value,t=s.position,s=X(e,t,!0),this.duration=s.value,t=s.position}var a=V(e,t);this.language=a.value,t=a.position;var c=[];return c[0]=this.language>>10&31,c[1]=this.language>>5&31,c[2]=31&this.language,this.languageString=String.fromCharCode(c[0]+96,c[1]+96,c[2]+96),J(t,2)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,this.data?t=le(e,t,this.data):(t=ae(e,t,this.creationTime),t=ae(e,t,this.modificationTime),t=ae(e,t,this.timescale),t=ae(e,t,this.duration),t=ie(e,t,this.language),t=J(t,2)),n.writeSize(t),t}}]),r}(ge);Ye.type="mdhd",Ye.skippable=!0,C.define(Ye.type,Ye);var De=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"hdlr",e,n)).name="",i.handler="",i}return c()(r,[{key:"parse",value:function(e,t){if(t=l()(y()(r.prototype),"parse",this).call(this,e,t),0===this.version){t=J(t,4);var n=ee(e,t,4);this.handler=n.value,t=n.position,t=J(t,12),n=ee(e,t,12),this.name=n.value,t=n.position}return t}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=J(t,4),t=ue(e,t,this.handler,4),t=J(t,12),t=ue(e,t,this.name,this.name.length+1),n.writeSize(t),t}}]),r}(ge);De.type="hdlr",De.skippable=!0,C.define(De.type,De);var Oe=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"minf",e,n)}return c()(r,[{key:"parse",value:function(e,t){l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=n.writeSubBoxes(e,t),n.writeSize(t),t}}]),r}(ye);Oe.type="minf",C.define(Oe.type,Oe);var Ee=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"vmhd",e,n)}return c()(r,[{key:"parse",value:function(e,t){if(r.skippable){var n=t;t=l()(y()(r.prototype),"parse",this).call(this,e,t);var i=te(e,t,this.size-8-(t-n));return this.data=i.value,i.position}t=l()(y()(r.prototype),"parse",this).call(this,e,t);var o=V(e,t);return this.graphicsMode=o.value,o=function(e,t,r){var n=new Uint16Array(r);return A(n.buffer,0,e.buffer,t,r*n.BYTES_PER_ELEMENT),{value:n,position:t+n.byteLength}}(e,t=o.position,3),this.opcolor=o.value,o.position}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,this.data?t=le(e,t,this.data):t=function(e,t,r){if(r instanceof Uint16Array)A(e.buffer,t,r.buffer,0,r.byteLength),t+=r.byteLength;else for(var n=0;n<r.length;n++)t=U(e,t,r[n]);return t}(e,t=ie(e,t,this.graphicsMode),this.opcolor),n.writeSize(t),t}}]),r}(ge);Ee.type="vmhd",Ee.skippable=!0,C.define(Ee.type,Ee);var Te=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"dinf",e,n)}return c()(r,[{key:"parse",value:function(e,t){l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=n.writeSubBoxes(e,t),n.writeSize(t),t}}]),r}(ye);Te.type="dinf",C.define(Te.type,Te);var Re=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"url ",e,n)).location="",i}return c()(r,[{key:"parse",value:function(e,t){t=l()(y()(r.prototype),"parse",this).call(this,e,t),1!==this.flags&&(this.location="")}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,n.writeSize(t),t}}]),r}(ge);Re.type="url ",C.define(Re.type,Re);var Le=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"dref",e,n)).events=["SUB_BOX"],i.entries=[],i}return c()(r,[{key:"parse",value:function(e,t){t=l()(y()(r.prototype),"parse",this).call(this,e,t);var n=X(e,t,!0),i=n.value;t=n.position;for(var o=0;o<i;o++){var s=this.trigger("SUB_BOX",{position:t});s&&(t=s.position,this.entries.push(s.box))}}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);t=n.position,t=ae(e,t,this.entries.length);for(var i=0;i<this.entries.length;i++)t=this.entries[i].write(e,t);return n.writeSize(t),t}}]),r}(ge);Le.type="dref",C.define(Le.type,Le);var Ce=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"stbl",e,n)}return c()(r,[{key:"parse",value:function(e,t){l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=n.writeSubBoxes(e,t),n.writeSize(t),t}}]),r}(ye);Ce.type="stbl",C.define(Ce.type,Ce);var Pe=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"stsd",e,n)).events=["SUB_BOX"],i.entries=[],i}return c()(r,[{key:"parse",value:function(e,t){t=l()(y()(r.prototype),"parse",this).call(this,e,t);var n=X(e,t,!0),i=n.value;t=n.position;for(var o=0;o<i;o++){var s=this.trigger("SUB_BOX",{position:t});s&&(t=s.position,this.entries.push(s.box))}}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);t=n.position,t=ae(e,t,this.entries.length);for(var i=0;i<this.entries.length;i++)t=this.entries[i].write(e,t);return n.writeSize(t),t}}]),r}(ge);Pe.type="stsd",C.define(Pe.type,Pe);var Ae=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n,i){return s()(this,r),t.call(this,e,n,i)}return c()(r,[{key:"parse",value:function(e,t){if(r.skippable){var n=te(e,t,78);this.data=n.value,t=n.position}else{t=J(t,6);var i=V(e,t);this.dataReferenceIndex=i.value,t=i.position,t=J(t,16),i=V(e,t),this.width=i.value,t=i.position,i=V(e,t),this.height=i.value,t=i.position,i=X(e,t,!0),this.hResolution=i.value,t=i.position,i=X(e,t,!0),this.vResolution=i.value,t=i.position,t=(i=X(e,t,!0)).position,i=V(e,t),this.frameCount=i.value,t=i.position,i=K(e,t);var o=Math.min(31,i.value);t=i.position,i=ee(e,t,o),this.compressorName=i.value,t=i.position,o<31&&(t=(i=ee(e,t,31-o)).position),i=V(e,t),this.depth=i.value,t=i.position,t=J(t,2)}l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,this.data?t=le(e,t,this.data):(t=J(t,6),t=ie(e,t,this.dataReferenceIndex),t=J(t,16),t=ie(e,t,this.width),t=ie(e,t,this.height),t=ae(e,t,this.hResolution),t=ae(e,t,this.vResolution),t=J(t,4),t=ie(e,t,this.frameCount),t=re(e,t,Math.min(31,this.compressorName.length)),t=ue(e,t,this.compressorName,31),t=ie(e,t,this.depth),t=ne(e,t,-1)),t=n.writeSubBoxes(e,t),n.writeSize(t),t}},{key:"getCodec",value:function(){return this.type.replace(".","")}}]),r}(ye);Ae.skippable=!0;var ze=Ae;var Be=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"avc1",e,n)}return c()(r,[{key:"parse",value:function(e,t){l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"getCodec",value:function(){var e=l()(y()(r.prototype),"getCodec",this).call(this);if(this.avcC)return e+"."+pe(this.avcC.AVCProfileIndication)+pe(this.avcC.profileCompatibility)+pe(this.avcC.AVCLevelIndication)}}]),r}(ze);Be.type="avc1",C.define(Be.type,Be);var Ie=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"avcC",e,n)}return c()(r,[{key:"parse",value:function(e,t){if(r.skippable){var n,i=te(e,t,this.size-8);return this.data=i.value,n=i.position,t=J(t,1),i=K(e,t),this.AVCProfileIndication=i.value,t=i.position,i=K(e,t),this.profileCompatibility=i.value,t=i.position,i=K(e,t),this.AVCLevelIndication=i.value,t=i.position,t=J(t,1),n}var o=K(e,t);this.configurationVersion=o.value,t=o.position,o=K(e,t),this.AVCProfileIndication=o.value,t=o.position,o=K(e,t),this.profileCompatibility=o.value,t=o.position,o=K(e,t),this.AVCLevelIndication=o.value,t=o.position,o=K(e,t),this.lengthSizeMinusOne=3&o.value,t=o.position,o=K(e,t),this.SPSNalusCount=31&o.value,t=o.position;var s=this.size-8-6;this.SPS=[];for(var a=0;a<this.SPSNalusCount;a++){this.SPS[a]={};var c=V(e,t);this.SPS[a].length=c.value,t=c.position,c=te(e,t,this.SPS[a].length),this.SPS[a].nalu=c.value,t=c.position,s-=2+this.SPS[a].length}o=K(e,t),this.PPSNalusCount=o.value,t=o.position,s--,this.PPS=[];for(var u=0;u<this.PPSNalusCount;u++){this.PPS[u]={};var l=V(e,t);this.PPS[u].length=l.value,t=l.position,l=te(e,t,this.PPS[u].length),this.PPS[u].nalu=l.value,t=l.position,s-=2+this.PPS[u].length}if(s>0){var f=te(e,t,s);this.ext=f.value,t=f.position}return t}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);if(t=n.position,this.data)t=le(e,t,this.data);else{t=re(e,t,this.configurationVersion),t=re(e,t,this.AVCProfileIndication),t=re(e,t,this.profileCompatibility),t=re(e,t,this.AVCLevelIndication),t=re(e,t,this.lengthSizeMinusOne+252),t=re(e,t,this.SPS.length+224);for(var i=0;i<this.SPS.length;i++)t=ie(e,t,this.SPS[i].length),t=le(e,t,this.SPS[i].nalu);t=re(e,t,this.PPS.length);for(var o=0;o<this.PPS.length;o++)t=ie(e,t,this.PPS[o].length),t=le(e,t,this.PPS[o].nalu);this.ext&&(t=le(e,t,this.ext))}return n.writeSize(t),t}}]),r}(de);Ie.type="avcC",Ie.skippable=!0,C.define(Ie.type,Ie);var je=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"pasp",e,n)).unwritable=!0,i}return c()(r,[{key:"parse",value:function(e,t){if(r.keepData){var n=te(e,t,this.size-8);this.data=n.value}var i=X(e,t,!0);this.hSpacing=i.value,t=i.position,i=X(e,t,!0),this.vSpacing=i.value,t=i.position}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,this.data&&(t=le(e,t,this.data)),n.writeSize(t),t}}]),r}(de);je.type="pasp",je.keepData=!0,C.define(je.type,je);var He=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"btrt",e,n)).unwritable=!0,i}return c()(r,[{key:"parse",value:function(e,t){if(r.keepData){var n=te(e,t,this.size-8);this.data=n.value}var i=$(e,t,!0);this.bufferSize=i.value,t=i.position,i=$(e,t,!0),this.maxBitrate=i.value,t=i.position,i=$(e,t,!0),this.avgBitrate=i.value,t=i.position}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,this.data&&(t=le(e,t,this.data)),n.writeSize(t),t}}]),r}(de);He.type="btrt",He.keepData=!0,C.define(He.type,He);var Ue=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"stts",e,n)).sampleCounts=[],i.sampleDeltas=[],i}return c()(r,[{key:"parse",value:function(e,t){t=l()(y()(r.prototype),"parse",this).call(this,e,t);var n=X(e,t,!0),i=n.value;if(t=n.position,0===this.version)for(var o=0;o<i;o++){var s=X(e,t,!0);this.sampleCounts.push(s.value),t=s.position;var a=(s=$(e,t,!0)).value;t=s.position,a<0&&(a=1),this.sampleDeltas.push(a)}}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);t=n.position,t=ae(e,t,this.sampleCounts.length);for(var i=0;i<this.sampleCounts.length;i++)t=ae(e,t,this.sampleCounts[i]),t=ae(e,t,this.sampleDeltas[i]);return n.writeSize(t),t}}]),r}(ge);Ue.type="stts",C.define(Ue.type,Ue);var Ne=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"stss",e,n)).sampleNumbers=[],i}return c()(r,[{key:"parse",value:function(e,t){t=l()(y()(r.prototype),"parse",this).call(this,e,t);var n=X(e,t,!0),i=n.value;if(t=n.position,0===this.version)for(var o=0;o<i;o++){var s=X(e,t,!0);this.sampleNumbers.push(s.value),t=s.position}}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=ae(e,t,this.sampleNumbers.length),t=fe(e,t,this.sampleNumbers),n.writeSize(t),t}}]),r}(ge);Ne.type="stss",C.define(Ne.type,Ne);var Fe=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"ctts",e,n)).sampleCounts=[],i.sampleOffsets=[],i.unwritable=!0,i}return c()(r,[{key:"parse",value:function(e,t){t=l()(y()(r.prototype),"parse",this).call(this,e,t);var n=X(e,t,!0),i=n.value;t=n.position;for(var o=0;o<i;o++){var s=X(e,t,!0);this.sampleCounts.push(s.value),t=s.position,s=$(e,t,!0),this.sampleOffsets.push(s.value),t=s.position}}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);t=n.position,t=ae(e,t,this.sampleCounts.length);for(var i=0;i<this.sampleCounts.length;i++)t=ae(e,t,this.sampleCounts[i]),t=1===this.version?se(e,t,this.sampleOffsets[i]):ae(e,t,this.sampleOffsets[i]);return n.writeSize(t),t}}]),r}(ge);Fe.type="ctts",C.define(Fe.type,Fe);var Ge=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"stsc",e,n)).firstChunk=[],i.samplesPerChunk=[],i.sampleDescriptionIndex=[],i}return c()(r,[{key:"parse",value:function(e,t){t=l()(y()(r.prototype),"parse",this).call(this,e,t);var n=X(e,t,!0),i=n.value;if(t=n.position,0===this.version)for(var o=0;o<i;o++){var s=X(e,t,!0);this.firstChunk.push(s.value),t=s.position,s=X(e,t,!0),this.samplesPerChunk.push(s.value),t=s.position,s=X(e,t,!0),this.sampleDescriptionIndex.push(s.value),t=s.position}}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);t=n.position,t=ae(e,t,this.firstChunk.length);for(var i=0;i<this.firstChunk.length;i++)t=ae(e,t,this.firstChunk[i]),t=ae(e,t,this.samplesPerChunk[i]),t=ae(e,t,this.sampleDescriptionIndex[i]);return n.writeSize(t),t}}]),r}(ge);Ge.type="stsc",C.define(Ge.type,Ge);var Je=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"stsz",e,n)).sampleSizes=[],i.sampleSize=0,i.sampleCount=0,i}return c()(r,[{key:"parse",value:function(e,t){if(t=l()(y()(r.prototype),"parse",this).call(this,e,t),0===this.version){var n=X(e,t,!0);this.sampleSize=n.value,t=n.position,n=X(e,t,!0),this.sampleCount=n.value,t=n.position;for(var i=0;i<this.sampleCount;i++)if(0===this.sampleSize){var o=X(e,t,!0);this.sampleSizes.push(o.value),t=o.position}else this.sampleSizes[i]=this.sampleSize}}},{key:"write",value:function(e,t){var n=!0;if(this.sampleSizes.length>0)for(var i=0;i+1<this.sampleSizes.length;){if(this.sampleSizes[i+1]!==this.sampleSizes[0]){n=!1;break}i++}else n=!1;var o=l()(y()(r.prototype),"write",this).call(this,e,t);return t=o.position,t=n?ae(e,t,this.sampleSizes[0]):J(t,4),t=ae(e,t,this.sampleSizes.length),n||(t=fe(e,t,this.sampleSizes)),o.writeSize(t),t}}]),r}(ge);Je.type="stsz",C.define(Je.type,Je);var Ke=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"stco",e,n)).chunkOffsets=[],i}return c()(r,[{key:"parse",value:function(e,t){t=l()(y()(r.prototype),"parse",this).call(this,e,t);var n=X(e,t,!0),i=n.value;if(t=n.position,0===this.version)for(var o=0;o<i;o++){var s=X(e,t,!0);this.chunkOffsets.push(s.value),t=s.position}}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=ae(e,t,this.chunkOffsets.length),t=fe(e,t,this.chunkOffsets),n.writeSize(t),t}}]),r}(ge);Ke.type="stco",C.define(Ke.type,Ke);var Ve=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"udta",e,n)}return c()(r,[{key:"parse",value:function(e,t){l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=n.writeSubBoxes(e,t),n.writeSize(t),t}}]),r}(ye);Ve.type="udta",C.define(Ve.type,Ve);var qe=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"meta",e,n)).events=["SUB_BOX"],i.boxes=[],i.lastPosition=-1,i}return c()(r,[{key:"parse",value:function(e,t){for(t=l()(y()(r.prototype),"parse",this).call(this,e,t);t<this.offset+this.size;){this.lastPosition=t;var n=this.trigger("SUB_BOX",{position:t});if(n&&(t=n.position,this[n.type]=n.box,this.boxes.push(n.type)),t==this.lastPosition)break}}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,n.writeSize(t),t}}]),r}(ge);qe.type="meta",C.define(qe.type,qe);var We=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"ilst",e,n)}return c()(r,[{key:"parse",value:function(e,t){}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,n.writeSize(t),t}}]),r}(de);We.type="ilst",C.define(We.type,We);var Xe=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"free",e,n)}return c()(r,[{key:"parse",value:function(e,t){}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,n.writeSize(t),t}}]),r}(de);Xe.type="free",C.define(Xe.type,Xe);var $e=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"mdat",e,n)).data=null,i}return c()(r,[{key:"parse",value:function(e,t){}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,this.data&&(t=le(e,t,this.data)),n.writeSize(t),t}}]),r}(de);$e.type="mdat",C.define($e.type,$e);var Qe=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"mvex",e,n)).listBoxes=[],i}return c()(r,[{key:"parse",value:function(e,t){l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=n.writeSubBoxes(e,t),n.writeSize(t),t}}]),r}(ye);Qe.type="mvex",C.define(Qe.type,Qe);var Ze=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"mehd",e,n)}return c()(r,[{key:"parse",value:function(e,t){if(t=l()(y()(r.prototype),"parse",this).call(this,e,t),1&this.flags&&(this.version=1),1==this.version){var n=Q(e,t,!0);this.fragmentDuration=n.value,t=n.position}else{var i=X(e,t,!0);this.fragmentDuration=i.value,t=i.position}return t}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,n.writeSize(t),t}}]),r}(ge);Ze.type="mehd",C.define(Ze.type,Ze);var et=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"trex",e,n)).trackId=null,i.defaultSampleDescriptionIndex=null,i.defaultSampleDuration=null,i.defaultSampleSize=null,i.defaultSampleFlags=null,i}return c()(r,[{key:"parse",value:function(e,t){t=l()(y()(r.prototype),"parse",this).call(this,e,t);var n=X(e,t,!0);return this.trackId=n.value,t=n.position,n=X(e,t,!0),this.defaultSampleDescriptionIndex=n.value,t=n.position,n=X(e,t,!0),this.defaultSampleDuration=n.value,t=n.position,n=X(e,t,!0),this.defaultSampleSize=n.value,t=n.position,n=X(e,t,!0),this.defaultSampleFlags=n.value,n.position}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=ae(e,t,this.trackId),t=ae(e,t,this.defaultSampleDescriptionIndex),t=ae(e,t,this.defaultSampleDuration),t=ae(e,t,this.defaultSampleSize),t=ae(e,t,this.defaultSampleFlags),n.writeSize(t),t}}]),r}(ge);et.type="trex",C.define(et.type,et);var tt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"moof",e,n)).listBoxes=[],i}return c()(r,[{key:"parse",value:function(e,t){l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=n.writeSubBoxes(e,t),n.writeSize(t),t}},{key:"adjustDataOffset",value:function(e){this.traf&&this.traf.trun&&(this.traf.trun.dataOffset=this.size+8),ae(e,this.dataOffsetPosition,this.dataOffset)}},{key:"dataOffset",get:function(){return this.traf&&this.traf.trun?this.traf.trun.dataOffset:0}},{key:"dataOffsetPosition",get:function(){return this.traf&&this.traf.trun?this.traf.trun.dataOffsetPosition:0}}]),r}(ye);tt.type="moof",C.define(tt.type,tt);var rt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"mfhd",e,n)).sequenceNumber=0,i}return c()(r,[{key:"parse",value:function(e,t){t=l()(y()(r.prototype),"parse",this).call(this,e,t);var n=X(e,t,!0);return this.sequenceNumber=n.value,n.position}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=ae(e,t,this.sequenceNumber),n.writeSize(t),t}}]),r}(ge);rt.type="mfhd",C.define(rt.type,rt);var nt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"traf",e,n)).listBoxes=[],i}return c()(r,[{key:"parse",value:function(e,t){l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=n.writeSubBoxes(e,t),n.writeSize(t),t}}]),r}(ye);nt.type="traf",C.define(nt.type,nt);var it=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"tfhd",e,n)).trackId=0,i}return c()(r,[{key:"parse",value:function(e,t){}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=ae(e,t,this.trackId),1&this.flags&&(t=ce(e,t,this.baseDataOffset)),2&this.flags&&(t=ae(e,t,this.defaultSampleDescriptionIndex)),8&this.flags&&(t=ae(e,t,this.defaultSampleDuration)),16&this.flags&&(t=ae(e,t,this.defaultSampleSize)),32&this.flags&&(t=ae(e,t,this.defaultSampleFlags)),n.writeSize(t),t}}]),r}(ge);it.type="tfhd",C.define(it.type,it);var ot=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"tfdt",e,n)}return c()(r,[{key:"parse",value:function(e,t){}},{key:"write",value:function(e,t){this.version=this.baseMediaDecodeTime>Math.pow(2,32)-1?1:0;var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=1===this.version?ce(e,t,this.baseMediaDecodeTime):ae(e,t,this.baseMediaDecodeTime),n.writeSize(t),t}}]),r}(ge);ot.type="tfdt",C.define(ot.type,ot);var st=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"trun",e,n)).flags=0,i}return c()(r,[{key:"parse",value:function(e,t){}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);t=n.position,t=ae(e,t,this.sampleCount),1&this.flags&&(this.dataOffsetPosition=t,t=se(e,t,this.dataOffset)),4&this.flags&&(t=ae(e,t,this.firstSampleFlags));for(var i=0;i<this.sampleCount;i++)256&this.flags&&(t=ae(e,t,this.sampleDuration[i])),512&this.flags&&(t=ae(e,t,this.sampleSize[i])),1024&this.flags&&(t=ae(e,t,this.sampleFlags[i])),2048&this.flags&&(t=0===this.version?ae(e,t,this.sampleCompositionTimeOffset[i]):se(e,t,this.sampleCompositionTimeOffset[i]));return n.writeSize(t),t}}]),r}(ge);st.type="trun",C.define(st.type,st);var at=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"smhd",e,n)}return c()(r,[{key:"parse",value:function(e,t){if(r.skippable){var n=t;t=l()(y()(r.prototype),"parse",this).call(this,e,t);var i=te(e,t,this.size-8-(t-n));return this.data=i.value,i.position}t=l()(y()(r.prototype),"parse",this).call(this,e,t);var o=V(e,t);return this.balance=o.value,o.position}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,this.data?t=le(e,t,this.data):(t=ie(e,t,this.balance),t=J(t,2)),n.writeSize(t),t}}]),r}(ge);at.type="smhd",at.skippable=!0,C.define(at.type,at);var ct=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n,i){var o;return s()(this,r),(o=t.call(this)).type=e,o.size=n,o.offset=i,o}return c()(r,[{key:"parse",value:function(e,t){}},{key:"write",value:function(e,t){return t}}]),r}(Y);var ut=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,r.type,e,n)}return c()(r,[{key:"parse",value:function(e,t){var r=V(e,t);if(this.esId=r.value,t=r.position,r=K(e,t),this.flags=r.value,t=r.position,this.size-=3,128&this.flags?(r=V(e,t),this.depEsId=r.value,t=r.position,this.size-=2):this.depEsId=0,64&this.flags){var n=K(e,t),i=n.value;t=n.position,n=ee(e,t,i),this.URL=n.value,t=n.position,this.size-=i+1}else this.URL="";if(32&this.flags){var o=V(e,t);this.ocrEsId=o.value,t=o.position,this.size-=2}else this.ocrEsId=0;return t}},{key:"write",value:function(e,t){return t}}]),r}(ct);ut.type=3..toString();var lt=ut;var ft=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,r.type,e,n)}return c()(r,[{key:"parse",value:function(e,t){var r=te(e,t,this.size);return this.data=r.value,r.position}},{key:"write",value:function(e,t){return t}}]),r}(ct);ft.type=5..toString();var ht=ft;var pt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,r.type,e,n)}return c()(r,[{key:"parse",value:function(e,t){var r=K(e,t);return this.oti=r.value,t=r.position,r=K(e,t),this.streamType=r.value,t=r.position,r=W(e,t),this.bufferSize=r.value,t=r.position,r=X(e,t,!0),this.maxBitrate=r.value,t=r.position,r=X(e,t,!0),this.avgBitrate=r.value,t=r.position,this.size-=13,t}},{key:"write",value:function(e,t){return t}}]),r}(ct);pt.type=4..toString();var dt=pt;var mt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,r.type,e,n)}return c()(r,[{key:"parse",value:function(e,t){var r=te(e,t,this.size);return this.data=r.value,r.position}},{key:"write",value:function(e,t){return t}}]),r}(ct);mt.type=6..toString();var yt=mt;var vt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"esds",e,n)).lastPosition=-1,i.boxes=[],i.boxDef={},i.boxDef[lt.type]=lt,i.boxDef[dt.type]=dt,i.boxDef[ht.type]=ht,i.boxDef[yt.type]=yt,i}return c()(r,[{key:"parseDesc",value:function(e,t){var r=0,n=K(e,t),i=n.value;t=n.position;var o=(n=K(e,t)).value;for(t=n.position;128&o;){r=(127&o)<<7;var s=K(e,t);o=s.value,t=s.position}return{size:r+=127&o,position:t,type:i+""}}},{key:"parse",value:function(e,t){t=l()(y()(r.prototype),"parse",this).call(this,e,t);var n=te(e,t,this.size-12);this.data=n.value,t=n.position;for(var i=new DataView(this.data.buffer),o=0;o<this.size-12;){var s=this.parseDesc(i,o);if(s){o=s.position;var a=s.type;if(!this.boxDef[a])break;var c=new this.boxDef[a](s.size,o);o=c.parse(i,o),this[a]=c,this.boxes.push(a)}}return t}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,this.data&&(t=le(e,t,this.data)),n.writeSize(t),t}},{key:"getCodec",value:function(){var e=this[dt.type],t=this[ht.type],r=e?e.oti:0,n="";return t&&t.data&&31==(n=(248&t.data[0])>>3)&&t.data.length>=2&&(n=32+((7&t.data[0])<<3)+((224&t.data[1])>>5)),function(e,t){var r=Number(e).toString(16);for(t=null==t?t=2:t;r.length<t;)r="0"+r;return r}(r)+(n?"."+n:"")}}]),r}(ge);vt.type="esds",C.define(vt.type,vt);var gt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"mp4a",e,n)}return c()(r,[{key:"parse",value:function(e,t){return l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){return l()(y()(r.prototype),"write",this).call(this,e,t)}},{key:"getCodec",value:function(){var e=l()(y()(r.prototype),"getCodec",this).call(this);return this.esds?e+"."+this.esds.getCodec():e}}]),r}(function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n,i){return s()(this,r),t.call(this,e,n,i)}return c()(r,[{key:"parse",value:function(e,t){t=J(t,6);var n=V(e,t);this.dataReferenceIndex=n.value,t=n.position,t=J(t,8),n=V(e,t),this.channelCount=n.value,t=n.position,n=V(e,t),this.sampleSize=n.value,t=n.position,t=J(t,4),n=X(e,t,!0),this.samplerate=n.value/65536,t=n.position,l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=J(t,6),t=ie(e,t,this.dataReferenceIndex),t=J(t,8),t=ie(e,t,this.channelCount),t=ie(e,t,this.sampleSize),t=J(t,4),t=ae(e,t,this.samplerate<<16),t=n.writeSubBoxes(e,t),n.writeSize(t),t}},{key:"getCodec",value:function(){return this.type.replace(".","")}}]),r}(ye));gt.type="mp4a",C.define(gt.type,gt);var bt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"keys",e,n)}return c()(r,[{key:"parse",value:function(e,t){if(r.keepData){var n=te(e,t,this.size-8);this.data=n.value}}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,n.writeSize(t),t}}]),r}(de);bt.type="keys",bt.keepData=!0,C.define(bt.type,bt);var _t=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"hvc1",e,n)}return c()(r,[{key:"parse",value:function(e,t){l()(y()(r.prototype),"parse",this).call(this,e,t)}},{key:"getCodec",value:function(){var e=l()(y()(r.prototype),"getCodec",this).call(this);if(this.hvcC){switch(e+=".",this.hvcC.generalProfileSpace){case 0:e+="";break;case 1:e+="A";break;case 2:e+="B";break;case 3:e+="C"}e+=this.hvcC.generalProfileIdc,e+=".";for(var t=this.hvcC.generalProfileCompatibility,n=0,i=0;i<32&&(n|=1&t,31!=i);i++)n<<=1,t>>=1;e+=pe(n,0),e+=".",0===this.hvcC.generalTierFlag?e+="L":e+="H",e+=this.hvcC.generalLevelIdc;for(var o=!1,s="",a=5;a>=0;a--)(this.hvcC.generalConstraintIndicator[a]||o)&&(s="."+pe(this.hvcC.generalConstraintIndicator[a],0)+s,o=!0);e+=s}return e}}]),r}(ze);_t.type="hvc1",C.define(_t.type,_t);var St=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"hvcC",e,n)}return c()(r,[{key:"parse",value:function(e,t){if(r.skippable){var n,i=te(e,t,this.size-8);this.data=i.value,n=i.position,t=J(t,1);var o=(i=K(e,t)).value;return t=i.position,this.generalProfileSpace=o>>6,this.generalTierFlag=(32&o)>>5,this.generalProfileIdc=31&o,i=X(e,t,!0),this.generalProfileCompatibility=i.value,t=i.position,i=te(e,t,6),this.generalConstraintIndicator=i.value,t=i.position,i=K(e,t),this.generalLevelIdc=i.value,t=i.position,n}var s=K(e,t);this.configurationVersion=s.value,t=s.position;var a=(s=K(e,t)).value;t=s.position,this.generalProfileSpace=a>>6,this.generalTierFlag=(32&a)>>5,this.generalProfileIdc=31&a,s=X(e,t,!0),this.generalProfileCompatibility=s.value,t=s.position,s=te(e,t,6),this.generalConstraintIndicator=s.value,t=s.position,s=K(e,t),this.generalLevelIdc=s.value,t=s.position,s=V(e,t),this.minSpatialSegmentationIdc=4095&s.value,t=s.position,s=K(e,t),this.parallelismType=3&s.value,t=s.position,s=K(e,t),this.chromaFormatIdc=3&s.value,t=s.position,s=K(e,t),this.bitDepthLumaMinus8=7&s.value,t=s.position,s=K(e,t),this.bitDepthChromaMinus8=7&s.value,t=s.position,s=V(e,t),this.avgFrameRate=s.value,t=s.position,a=(s=K(e,t)).value,t=s.position,this.constantFrameRate=a>>6,this.numTemporalLayers=1&a,this.temporalIdNested=1&a,this.lengthSizeMinusOne=3&a,this.naluArrays=[];var c=(s=K(e,t)).value;t=s.position;for(var u=0;u<c;u++){var l=[];this.naluArrays.push(l),a=(s=K(e,t)).value,t=s.position,l.completeness=(128&a)>>7,l.naluType=63&a;var f=(s=V(e,t)).value;t=s.position;for(var h=0;h<f;h++){var p={};l.push(p);var d=(s=V(e,t)).value;t=s.position,s=te(e,t,d),p.data=s.value,t=s.position}}}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);if(t=n.position,this.data)t=le(e,t,this.data);else{t=re(e,t,this.configurationVersion),t=re(e,t,this.generalProfileSpace<<6|this.generalTierFlag<<5|this.generalProfileIdc),t=ae(e,t,this.generalProfileCompatibility),t=le(e,t,this.generalConstraintIndicator),t=re(e,t,this.generalLevelIdc),t=ie(e,t,this.minSpatialSegmentationIdc+(15<<24)),t=re(e,t,this.parallelismType+252),t=re(e,t,this.chromaFormatIdc+252),t=re(e,t,this.bitDepthLumaMinus8+248),t=re(e,t,this.bitDepthChromaMinus8+248),t=ie(e,t,this.avgFrameRate),t=re(e,t,(this.constantFrameRate<<6)+(this.numTemporalLayers<<3)+(this.temporalIdNested<<2)+this.lengthSizeMinusOne),t=re(e,t,this.naluArrays.length);for(var i=0;i<this.naluArrays.length;i++){t=re(e,t,(this.naluArrays[i].completeness<<7)+this.naluArrays[i].naluType),t=ie(e,t,this.naluArrays[i].length);for(var o=0;o<this.naluArrays[i].length;o++)t=ie(e,t,this.naluArrays[i][o].data.length),t=le(e,t,this.naluArrays[i][o].data)}}return n.writeSize(t),t}}]),r}(de);St.type="hvcC",St.skippable=!0,C.define(St.type,St);var Mt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){var i;return s()(this,r),(i=t.call(this,"colr",e,n)).unwritable=!0,i}return c()(r,[{key:"parse",value:function(e,t){var r=ee(e,t,4);if(this.colourType=r.value,t=r.position,"nclx"===this.colourType){r=V(e,t),this.colourPrimaries=r.value,t=r.position,r=V(e,t),this.transferCharacteristics=r.value,t=r.position,r=V(e,t),this.matrixCoefficients=r.value,t=r.position;var n=(r=K(e,t)).value;t=r.position,this.fullRangeFlag=n>>7}else"rICC"!==this.colourType&&"prof"!==this.colourType||(r=te(this.size-4),this.ICCProfile=r.value,t=r.position)}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,n.writeSize(t),t}}]),r}(de);Mt.type="colr",Mt.keepData=!1,C.define(Mt.type,Mt);var kt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e,n){return s()(this,r),t.call(this,"fiel",e,n)}return c()(r,[{key:"parse",value:function(e,t){var r=K(e,t);this.fieldCount=r.value,t=r.position,r=K(e,t),this.fieldOrdering=r.value,t=r.position}},{key:"write",value:function(e,t){var n=l()(y()(r.prototype),"write",this).call(this,e,t);return t=n.position,t=re(e,t,this.fieldCount),t=re(e,t,this.fieldOrdering),n.writeSize(t),t}}]),r}(de);kt.type="fiel",kt.keepData=!1,C.define(kt.type,kt);var wt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(){var e;return s()(this,r),e=t.call(this),x()(k()(e),"setPosition",(function(t){e.position=t})),x()(k()(e),"setEndPosition",(function(t){e.endPosition=t})),x()(k()(e),"_isEnoughForSize",(function(){return e.endPosition-e.position>=4})),x()(k()(e),"_isEnoughForType",(function(){return e.endPosition-e.position>=4})),x()(k()(e),"_isEnoughForBox",(function(t){return e.endPosition-e.position>=t})),x()(k()(e),"start",(function(){for(e.paused=!1;e.position<e.endPosition&&!e.moovReady&&(e.lastPosition=e.position,e._parse(),e.lastPosition!=e.position&&!e.paused););})),x()(k()(e),"updateBuffer",(function(t){e.dataView=new DataView(t),e.trigger("UPDATED",null)})),x()(k()(e),"_parse",(function(){var t=e.position;if(!e._isEnoughForSize())return e.paused=!0,e.trigger("PAUSED",{type:null,size:null,position:e.position}),!1;var r=X(e.dataView,e.position,!0),n=r.value;if(e.position=r.position,!e._isEnoughForType())return e.paused=!0,e.position=t,e.trigger("PAUSED",{type:null,size:n,position:e.position}),!1;var i=(r=ee(e.dataView,e.position,4)).value;if(!e._isEnoughForBox(n))return e.paused=!0,e.position=t,e.trigger("PAUSED",{type:i,size:n,position:e.position}),!1;if(e.position=r.position,!C.isSupported(i))return e.position=t+n,{type:i,box:null,position:e.position};e.trigger("STARTED",{type:i,offset:t,size:n});var o=C.create(i,n,t);return o.on("SUB_BOX",(function(t){return e.position=t.position,e._parse()})),o.parse(e.dataView,e.position),e.position=t+n,e.trigger("ENDED",{type:i,offset:t,size:n,box:o}),"moov"==i?(e.moovReady=!0,!1):{type:i,box:o,position:e.position}})),x()(k()(e),"release",(function(){e.dataView=null,e.position=0,e.endPosition=0,e.lastPosition=-1,e.paused=!0,e.moovReady=!1})),e.dataView=null,e.position=0,e.endPosition=0,e.lastPosition=-1,e.paused=!0,e.moovReady=!1,e.events=["STARTED","PAUSED","ENDED","UPDATED"],e}return c()(r)}(Y);var xt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e){var n;return s()(this,r),n=t.call(this),x()(k()(n),"inputBuffer",(function(e){n.memory.inputBuffer(e)})),x()(k()(n),"release",(function(){n.boxParser.release()})),n.boxParser=new wt,n.boxParser.on("STARTED",(function(e){})),n.boxParser.on("PAUSED",(function(e){})),n.boxParser.on("ENDED",(function(e){var t=(e.type+"_READY").toUpperCase();n.trigger(t,e)})),n.boxParser.on("UPDATED",(function(e){n.boxParser.start()})),n.memory=e,n.memory.on("UPDATED",(function(e){n.boxParser.moovReady||(n.boxParser.setEndPosition(n.memory.endPosition),n.boxParser.updateBuffer(e))})),n.events=["MOOV_READY","FTYP_READY"],n}return c()(r,[{key:"moovReady",get:function(){return this.boxParser.moovReady}}]),r}(Y);var Yt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e){var n;return s()(this,r),n=t.call(this),x()(k()(n),"initFromConf",(function(e){n.conf=e;var t=n.conf.getTracks(),r=n.conf.moov.mvhd;n.conf.moov.mvhd.duration=0;for(var i=n.conf.ftyp,o=0;o<t.length;o++){var s=t[o];s.resetForFMP4();var a=C.create("moov",0,0);a.addSubBox("mvhd",r),a.addSubBox("trak",[s]);var c=C.create("mvex",0,0),u=C.create("trex",0,0);u.trackId=s.id,u.defaultSampleDescriptionIndex=1,u.defaultSampleDuration=s.sampleDuration,u.defaultSampleSize=0,u.defaultSampleFlags=65536,c.addSubBox("trex",u),a.addSubBox("mvex",c),n.trigger("META_READY",{trackId:s.idString,buffer:n.createFmp4MoovBuffer(i,a),startSampleIndex:-1,stopSampleIndex:-1,eos:!1})}n.ready=!0})),x()(k()(n),"createFmp4MoovBuffer",(function(e,t){var r=n.memory.createBuffer(n.conf.fileSize),i=new DataView(r),o=0;return o=e.write(i,o),t.write(i,o),he(i.buffer,e.size+t.size)})),x()(k()(n),"getSample",(function(e,t){var r=e.samples[t];r.data||(r.data=new Uint8Array(r.size));var i=n.memory.findNextBufferEndPos(r.offset)-r.offset;return r.size>i?null:(G(r.data.buffer,0,n.memory.buffer,r.offset-n.memory.startPosition,r.size),n.readLength+=r.size,e.samples[t].read=!0,r)})),x()(k()(n),"createMoof",(function(e){var t=C.create("moof",0,0),r=C.create("mfhd",0,0);t.addSubBox("mfhd",r),r.sequenceNumber=n.nextMoofIndex,n.nextMoofIndex++;var i=C.create("traf",0,0);t.addSubBox("traf",i);var o=C.create("tfhd",0,0);i.addSubBox("tfhd",o),o.trackId=e.trackId,o.flags=131072;var s=C.create("tfdt",0,0);i.addSubBox("tfdt",s),s.baseMediaDecodeTime=e.dts-0;var a=C.create("trun",0,0);return i.addSubBox("trun",a),a.flags=3841,a.dataOffset=0,a.firstSampleFlags=0,a.sampleCount=1,a.sampleDuration=[e.duration],a.sampleSize=[e.size],a.sampleFlags=[e.iFrame?1<<25:65536],a.sampleCompositionTimeOffset=[e.cts-e.dts],t})),x()(k()(n),"createFragment",(function(e,t,r,i){var o=n.getSample(e,t);if(!o)return i;var s=n.createMoof(o);i=s.write(r,i),n.moofSize=s.size,s.adjustDataOffset(r);var a=C.create("mdat",0,0);return a.data=o.data,a.write(r,i)})),x()(k()(n),"createFMP4",(function(e){for(var t=e.idString,r=e.name,i=0,o=n.memory.createBuffer(n.fragmentBufferSize),s=new DataView(o),a=!1,c=e.sampleIndex;e.sampleIndex<e.samples.length;){0==n.moofSize&&(n.moofSize=e.samples[e.sampleIndex].size);var u=i+e.samples[e.sampleIndex].size+n.moofSize+n.mdatHeaderSize;if(u>=n.fragmentBufferSize){0==i&&(n.fragmentBufferSize=u),a=!0;break}var l=n.createFragment(e,e.sampleIndex,s,i);if((e.isVideo?n.videoPaused:n.audioPaused)||l==i){e.isVideo?n.videoPaused=!0:n.audioPaused=!0,n.trigger("PAUSED",{trackId:t,trackName:r,index:e.sampleIndex,timestamp:e.samples[e.sampleIndex].timestamp,offset:e.samples[e.sampleIndex].offset});break}i=l,e.sampleIndex++}if(0!=i&&!n.paused){var f=he(s.buffer,i);n.trigger("DATA_READY",{trackId:t,startSampleIndex:c,stopSampleIndex:e.sampleIndex,buffer:f,eos:e.sampleIndex==e.samples.length})}a&&n.createFMP4(e)})),x()(k()(n),"createVideoFMP4",(function(){return new Promise((function(e,t){var r=n.conf.getVideoTrack();setTimeout((function(){n.createFMP4(r),e()}))}))})),x()(k()(n),"createAudioFMP4",(function(){return new Promise((function(e,t){var r=n.conf.getAudioTrack();setTimeout((function(){n.createFMP4(r),e()}))}))})),x()(k()(n),"start",(function(){if(n.ready){var e=[];return n.paused=!1,n.videoPaused&&(n.videoPaused=!1,e.push(n.createVideoFMP4())),n.audioPaused&&(n.audioPaused=!1,e.push(n.createAudioFMP4())),Promise.all(e)}})),x()(k()(n),"pause",(function(){n.videoPaused=!0,n.audioPaused=!0,n.paused=!0})),x()(k()(n),"release",(function(){n.ready=!1,n.readLength=0,n.nextMoofIndex=0,n.moofSize=0,n.paused=!0,n.shouldStart=!1,n.videoPaused=!0,n.audioPaused=!0})),n.ready=!1,n.readLength=0,n.nextMoofIndex=0,n.paused=!0,n.shouldStart=!1,n.fragmentBufferSize=1048576,n.memory=e,n.moofSize=0,n.mdatHeaderSize=8,n.videoPaused=!0,n.audioPaused=!0,n.events=["META_READY","DATA_READY","PAUSED"],n}return c()(r)}(Y);var Dt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e){var n;return s()(this,r),n=t.call(this),x()(k()(n),"_initMediaSource",(function(){n.mediaSource=new MediaSource,n.el.src=window.URL.createObjectURL(n.mediaSource);var e=function(){window.URL.revokeObjectURL(n.el.src),n.shouldEos=!1,n.ready=!0,n.initSourceBuffer(),n.trigger("OPENED",null)};return n.mediaSource.addEventListener("sourceopen",e),n.mediaSource.addEventListener("sourceended",(function e(){n.ready=!1,n.trigger("ENDED",null),n.mediaSource.removeEventListener("sourceended",e)})),n.mediaSource.addEventListener("sourceclose",(function e(){n.ready=!1,n.trigger("CLOSED",null),n.mediaSource.removeEventListener("sourceclose",e)})),function(){n.el.pause(),n.checkSourceBufferReady()?n.mediaSource.endOfStream():n.shouldEos=!0,n.mediaSource.removeEventListener("sourceopen",e)}})),x()(k()(n),"init",(function(e){e&&(n.conf=e,n.initSourceBuffer())})),x()(k()(n),"initSourceBuffer",(function(){n.conf&&n.ready&&(n.mediaSource.duration=n.conf.duration,n.conf.getTracks().forEach((function(e,t){var r='video/mp4; codecs="'+e.codec+'"',i=e.idString;if(MediaSource.isTypeSupported(r)){var o=n.mediaSource.addSourceBuffer(r);o.addEventListener("abort",(function(e){})),o.addEventListener("update",(function(e){})),o.addEventListener("updatestart",(function(e){})),o.addEventListener("error",(function(e){})),o.addEventListener("updateend",(function(e){n.feedBuffer(i),n.trigger("UPDATED",{trackId:i}),o.bufferCompleteCount++,o.eosBufferIndex>=0&&o.eosBufferIndex==o.bufferCompleteCount&&(o.eos=!0,n.checkEndOfStream(i)),n.shouldEos&&n.checkSourceBufferReady()&&(n.mediaSource.endOfStream(),n.shouldEos=!1)})),o.bufferInputCount=0,o.bufferCompleteCount=0,o.eosBufferIndex=-1,o.eos=!1,n.sourceBuffers[i]=o,n.inputBuffers[i]||(n.inputBuffers[i]=[]),n.feedBuffer(i)}})))})),x()(k()(n),"checkEndOfStream",(function(){var e=!0;for(var t in n.sourceBuffers)e=e&&n.sourceBuffers[t].eos;e&&n.checkSourceBufferReady()&&n.mediaSource.endOfStream()})),x()(k()(n),"feedBuffer",(function(e){if(n.checkSourceBufferReady(e)&&n.hasPendingBuffer(e)){var t=n.inputBuffers[e].shift();n.sourceBuffers[e].appendBuffer(t.buffer),n.sourceBuffers[e].bufferInputCount++,t.eos&&(n.sourceBuffers[e].eosBufferIndex=n.sourceBuffers[e].bufferInputCount)}})),x()(k()(n),"hasPendingBuffer",(function(e){return!!n.inputBuffers[e]&&0!=n.inputBuffers[e].length})),x()(k()(n),"clearPendingBuffers",(function(){for(var e in n.inputBuffers)n.inputBuffers[e]=[]})),x()(k()(n),"checkSourceBufferReady",(function(e){var t=!0;if(e)t=!!n.sourceBuffers[e]&&!n.sourceBuffers[e].updating;else for(var r in n.sourceBuffers)t=t&&!n.sourceBuffers[r].updating;return n.msAvailable&&t})),x()(k()(n),"inputBuffer",(function(e,t){n.inputBuffers[e]||(n.inputBuffers[e]=[]),n.inputBuffers[e].push(t),n.feedBuffer(e)})),x()(k()(n),"start",(function(){return n.el.play()})),x()(k()(n),"stop",(function(){n.el.pause()})),x()(k()(n),"release",(function(){n._releaseMediaSource&&n._releaseMediaSource(),n._releaseMediaSource=n._initMediaSource(),n.conf=null,n.ready=!1,n.sourceBuffers={},n.inputBuffers={},n.bufferInputCount=0,n.bufferCompleteCount=0,n.eosBufferIndex=-1})),n.el=e,n.conf=null,n.ready=!1,n.sourceBuffers={},n.inputBuffers={},n.bufferInputCount=0,n.bufferCompleteCount=0,n.eosBufferIndex=-1,n.shouldEos=!1,n._releaseMediaSource=n._initMediaSource(),n.events=["OPENED","CLOSED","UPDATED"],n}return c()(r,[{key:"msAvailable",get:function(){return this.mediaSource&&"open"===this.mediaSource.readyState}}]),r}(Y);var Ot=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(){var e;return s()(this,r),e=t.call(this),x()(k()(e),"inputFTYP",(function(t){t&&t.box&&(e.ftyp=t.box)})),x()(k()(e),"inputMOOV",(function(t){t&&t.box&&(e.moov=t.box,e.getTracks().forEach((function(e){e.buildSamples()})),e.moov.timescale&&(e.duration=e.moov.duration/e.moov.timescale),e.fileSize&&e.duration&&(e.durationPerUnitSize=e.duration/(e.fileSize-e.metadataSize)),e.trigger("CONF_READY",k()(e)))})),x()(k()(e),"getTracks",(function(){return e.moov.trak})),x()(k()(e),"getTrack",(function(t){var r=e.moov.trak.filter((function(e){return e.name==t}));return r.length?r[0]:null})),x()(k()(e),"getVideoTrack",(function(){return e.getTrack("vide")})),x()(k()(e),"getAudioTrack",(function(){return e.getTrack("soun")})),x()(k()(e),"getISamples",(function(e){return e.samples.filter((function(e){return e.iFrame}))})),x()(k()(e),"getVideoISamples",(function(){var t=e.getVideoTrack();return e.getISamples(t)})),x()(k()(e),"getAudioISamples",(function(){var t=e.getAudioTrack();return e.getISamples(t)})),x()(k()(e),"getGopSize",(function(){var t=e.getGopOffsets();return t.length>=2?t[1]-t[0]:0})),x()(k()(e),"getGopOffsets",(function(){e.iVideoSamples.length||(e.iVideoSamples=e.getVideoISamples());for(var t=e.getAudioISamples(),r=e.iVideoSamples.map((function(e){return e.offset})),n=-1,i=[],o=1;o<e.iVideoSamples.length;o++){for(var s=e.iVideoSamples[o-1],a=e.iVideoSamples[o],c=s.dts/s.timescale,u=(a.dts+a.duration)/a.timescale,l=n,f=-1,h=n+1;h<t.length;h++){var p=t[h];l<0&&(p.dts/p.timescale<=c&&(l=h),l>=0&&i.push(t[l].offset)),(p.dts+p.duration)/p.timescale<=u&&(f=h)}f>=0&&(i.push(t[f].offset),n=f)}return r.map((function(e,t){return 0==t?Math.min(e,i[t]):Math.max(e,i[t])}))})),x()(k()(e),"getDataOffsetWithTime",(function(t){for(var r=e.getTracks(),n=1/0,i=0;i<r.length;i++){var o=r[i];if(!(t>o.calculatedDuration)){var s=o.getSampleOffsetWithTime(t);s<n&&(n=s)}}return n})),x()(k()(e),"release",(function(){e.ftyp=null,e.moov=null,e.fileSize=0,e.iVideoSamples=[]})),e.ftyp=null,e.moov=null,e.fileSize=0,e.duration=0,e.durationPerUnitSize=0,e.iVideoSamples=[],e.events=["CONF_READY"],e}return c()(r,[{key:"metadataSize",get:function(){return this.moov?this.moov.size:0}}]),r}(Y);var Et=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(){var e;return s()(this,r),e=t.call(this),x()(k()(e),"inputBuffer",(function(t){e.buffer?e.buffer=function(e,t,r){if(e+t.byteLength<r.byteLength){var n=new ArrayBuffer(r.byteLength),i=new Uint8Array(n);return i.set(new Uint8Array(r),0),i.set(new Uint8Array(t),e),n}var o=new ArrayBuffer(e+t.byteLength),s=new Uint8Array(o);return s.set(new Uint8Array(r),0),s.set(new Uint8Array(t),e),o}(t.chunkOffset,t.data,e.buffer):(e.buffer=t.data,e.offset=t.chunkOffset),e.chunkInfo.push({offset:t.chunkOffset,size:t.chunkSize}),e.chunkInfo=function(e,t,r){if(0===e.length)return[];e.sort((function(e,r){return e[t]-r[t]}));for(var n=[e[0]],i=1;i<e.length;i++){var o=e[i],s=n[n.length-1];o[t]>s[t]+s[r]?n.push(o):o[t]+o[r]>s[t]+s[r]&&(s[r]+=o[t]+o[r]-(s[t]+s[r]))}return n}(e.chunkInfo,"offset","size"),e.trigger("UPDATED",e.buffer)})),x()(k()(e),"createBuffer",(function(e){return e=e||S.memory.defaultBufferSize,new ArrayBuffer(e)})),x()(k()(e),"findNextBufferEndPos",(function(t){for(var r=0;r<e.chunkInfo.length;r++){var n=e.chunkInfo[r];if(n.offset<=t&&n.offset+n.size>=t)return n.offset+n.size}return t})),x()(k()(e),"release",(function(){e.buffer=null,e.chunkInfo=[],e.offset=0})),e.buffer=null,e.offset=0,e.chunkInfo=[],e.events=["UPDATED"],e}return c()(r,[{key:"startPosition",get:function(){return this.buffer?this.offset:0}},{key:"endPosition",get:function(){return this.buffer?this.offset+this.buffer.byteLength:0}}]),r}(Y);var Tt,Rt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e){var n;return s()(this,r),n=t.call(this),x()(k()(n),"_stopBufferChecking",(function(){n.timeoutId&&(window.clearTimeout(n.timeoutId),n.timeoutId=null)})),x()(k()(n),"_startBufferChecking",(function(){n._eof||n.paused?n._stopBufferChecking():(n.isEnough?n.trigger("BUFFER_ENOUGH",null):n.trigger("BUFFER_UNENOUGH",null),n.timeoutId=window.setTimeout((function(){n._startBufferChecking()}),n._checkingInterval))})),n.el=e,n.timeoutId=null,n.paused=!0,n._eof=!1,n.rebufferCount=0,n._initEnoughTime=S.playback.bufferEnoughTime,n._enoughTime=S.playback.bufferEnoughTime,n._maxTime=S.playback.bufferMaxTime,n._checkingInterval=S.playback.bufferCheckingInterval,n.events=["BUFFER_ENOUGH","BUFFER_UNENOUGH"],n}return c()(r,[{key:"start",value:function(){this.paused=!1,this._startBufferChecking()}},{key:"stop",value:function(){this.paused=!0}},{key:"release",value:function(){this.stop(),this._stopBufferChecking(),this._eof=!1,this._enoughTime=this._initEnoughTime,this.rebufferCount=0}},{key:"countRebuffer",value:function(){this.rebufferCount++,this._enoughTime<this._maxTime&&(this._enoughTime+=.5)}},{key:"checkAvailable",value:function(e){for(var t=this.isEnough,r=0;r<this.el.buffered.length;r++){var n=this.el.buffered.start(r),i=this.el.buffered.end(r);if(e>=n&&e<=i)return{requestTime:t?e:i,isEnough:t}}return{requestTime:e,isEnough:!1}}},{key:"enoughTime",set:function(e){e&&(this._initEnoughTime=e,this._enoughTime=e)}},{key:"maxTime",set:function(e){e&&(this._maxTime=e)}},{key:"checkingInterval",set:function(e){e&&(this._checkingInterval=e)}},{key:"eof",set:function(e){this._eof=e,e&&this._stopBufferChecking()}},{key:"ranges",get:function(){for(var e=[],t=0;t<this.el.buffered.length;t++){var r=this.el.buffered.start(t),n=this.el.buffered.end(t);e.push([r,n])}return e}},{key:"pendingBufferDuration",get:function(){for(var e=-1,t=0;t<this.el.buffered.length;t++){var r=this.el.buffered.start(t),n=this.el.buffered.end(t);if(this.el.currentTime>=r&&this.el.currentTime<n){e=n;break}}return e<0?0:e-this.el.currentTime}},{key:"isEnough",get:function(){return!!this._eof||this.pendingBufferDuration>=this._enoughTime}}]),r}(Y),Lt=["loadstart","DOWNLOADER_ERROR","DOWNLOADER_CHUNK_READY","MEMORY_COMPLETED"],Ct=new Uint8Array(16);function Pt(){if(!Tt&&!(Tt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Tt(Ct)}for(var At=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,zt=[],Bt=0;Bt<256;++Bt)zt.push((Bt+256).toString(16).substr(1));var It=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(zt[e[t+0]]+zt[e[t+1]]+zt[e[t+2]]+zt[e[t+3]]+"-"+zt[e[t+4]]+zt[e[t+5]]+"-"+zt[e[t+6]]+zt[e[t+7]]+"-"+zt[e[t+8]]+zt[e[t+9]]+"-"+zt[e[t+10]]+zt[e[t+11]]+zt[e[t+12]]+zt[e[t+13]]+zt[e[t+14]]+zt[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&At.test(e)}(r))throw TypeError("Stringified UUID is invalid");return r},jt=function(e,t,r){var n=(e=e||{}).random||(e.rng||Pt)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return It(n)};var Ht=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(){var e,n,i,o,a,c;return s()(this,r),(c=t.call(this)).indexedDB="undefined"==typeof window?null:(null===(e=window)||void 0===e?void 0:e.indexedDB)||(null===(n=window)||void 0===n?void 0:n.webkitIndexedDB)||(null===(i=window)||void 0===i?void 0:i.mozIndexedDB)||(null===(o=window)||void 0===o?void 0:o.OIndexedDB)||(null===(a=window)||void 0===a?void 0:a.msIndexedDB),c.request=null,c.db=null,c.store=null,c}return c()(r,[{key:"init",value:function(){var e=this;return this.indexedDB?new Promise((function(t,r){var n=e.indexedDB.open(e.dbName,e.dbVersion);n.onsuccess=function(r){e.db=r.target.result,t()},n.onerror=function(e){r()},n.onupgradeneeded=function(t){e.store=t.currentTarget.result.createObjectStore(e.dbStoreName)}})):null}},{key:"setData",value:function(e,t){var r=this;return new Promise((function(n,i){r.db||i();var o=r.db.transaction(r.dbStoreName,"readwrite").objectStore(r.dbStoreName).put(t,e);o.onsuccess=function(){n()},o.onerror=function(){i()}}))}},{key:"getData",value:function(e){var t=this;return new Promise((function(r,n){t.db||n();var i=t.db.transaction(t.dbStoreName,"readonly").objectStore(t.dbStoreName).get(e);i.onsuccess=function(e){var t=e.target.result;r(t)},i.onerror=function(){n()}}))}},{key:"hasData",value:function(e){var t=this;return new Promise((function(r,n){t.db||n();var i=t.db.transaction(t.dbStoreName,"readonly").objectStore(t.dbStoreName).getKey(e);i.onsuccess=function(e){var t=e.target.result;r(t)},i.onerror=function(){n()}}))}},{key:"clearData",value:function(){var e=this;return new Promise((function(t,r){e.db||r();var n=e.db.transaction(e.dbStoreName,"readwrite").objectStore(e.dbStoreName).clear();n.onsuccess=function(e){t()},n.onerror=function(){r()}}))}}]),r}(function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(){var e;return s()(this,r),(e=t.call(this)).dbName="tiktok",e.dbVersion=1,e.dbStoreName="playback",e}return c()(r,[{key:"init",value:function(){}},{key:"setData",value:function(e,t){}},{key:"getData",value:function(e){}},{key:"clearData",value:function(){}}]),r}(Y));var Ut=new(function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(){var e;return s()(this,r),(e=t.call(this)).impl=new Ht,e.readyPromise=e.impl.init(),e}return c()(r,[{key:"save",value:function(e,t){var r=this;if(this.readyPromise)return this.readyPromise.then((function(){return r.impl.setData(e,t)}))}},{key:"export",value:function(e){var t=this;if(this.readyPromise)return this.readyPromise.then((function(){return t.impl.getData(e)}))}},{key:"check",value:function(e){var t=this;if(this.readyPromise)return this.readyPromise.then((function(){return t.impl.hasData(e)}))}},{key:"clear",value:function(){var e=this;if(this.readyPromise)return this.readyPromise.then((function(){return e.impl.clearData()}))}}]),r}(Y));var Nt=function(e){h()(u,e);var t,r,n,o,a=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(u);function u(e){var t;return s()(this,u),(t=a.call(this,"Stream",e,Lt)).id=jt(),t._initMemory(),t._initEvents(),t._initConf(),t._initDownloader(),t._initDemuxer(),t._initRemuxer(),t._initBuffer(),t._initMSE(),t}return c()(u,[{key:"_initMemory",value:function(){var e=this;this.memory=new Et,this.memory.on("UPDATED",function(){var t=i()(g.a.mark((function t(r){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.downloader.eof&&e.eventManager.trigger("MEMORY_COMPLETED",r);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"_initEvents",value:function(){var e=this;l()(y()(u.prototype),"_initEvents",this).call(this),this.eventManager.proxy("canplay",(function(e){})),this.eventManager.proxy("waiting",(function(t){e.buffer.countRebuffer(),e.downloader.loading||e.downloader.eof||e.downloader.resume()})),this.eventManager.proxy("play",(function(t){e.buffer.start()})),this.eventManager.proxy("pause",(function(t){e.buffer.stop()})),this.eventManager.proxy("seeking",(function(e){}))}},{key:"_initMSE",value:function(){var e=this;this.mse=new Dt(this.el),this.mse.on("OPENED",(function(){})),this.mse.on("CLOSED",(function(){})),this.mse.on("UPDATED",(function(t){e.buffer.isEnough&&e.downloader.pause()}))}},{key:"_initConf",value:function(){var e=this;this.conf=new Ot,this.conf.on("CONF_READY",(function(t){e.mse.init(t),e.remuxer.initFromConf(t)}))}},{key:"_initBuffer",value:function(){var e=this;this.buffer=new Rt(this.el),this.config.bufferEnoughTime&&(this.bufferEnoughTime=this.config.bufferEnoughTime),this.config.bufferMaxTime&&(this.buffer.maxTime=this.config.bufferMaxTime),this.config.bufferCheckingInterval&&(this.buffer.checkingInterval=this.config.bufferCheckingInterval),this.buffer.on("BUFFER_UNENOUGH",(function(){e.el.playbackRate=.9,e.downloader.resume()})),this.buffer.on("BUFFER_ENOUGH",(function(){e.el.playbackRate=1,e.downloader.pause()}))}},{key:"_initDemuxer",value:function(){var e=this;this.demuxer=new xt(this.memory),this.demuxer.on("FTYP_READY",(function(t){e.conf.inputFTYP(t)})),this.demuxer.on("MOOV_READY",(function(t){e.conf.inputMOOV(t),e.downloader.switchToCommonSize()}))}},{key:"_initRemuxer",value:function(){var e=this;this.remuxer=new Yt(this.memory),this.remuxer.on("META_READY",(function(t){e.mse.inputBuffer(t.trackId,t),e.remuxer.start()})),this.remuxer.on("DATA_READY",(function(t){e.mse.inputBuffer(t.trackId,t)})),this.remuxer.on("PAUSED",(function(e){}))}},{key:"_initDownloader",value:function(){var e=this;this.downloader=new L({withCredentials:this.config.withCredentials}),this.metaChunkSize=Math.ceil(this.config.metaChunkSize||S.playback.metaChunkSize),this.dataChunkSize=Math.ceil(this.config.dataChunkSize||S.playback.dataChunkSize),this.downloader.on("FILE_SIZE",(function(t){e.conf.fileSize=t})),this.downloader.on("CHUNK_READY",(function(t){e.demuxer.inputBuffer(t),e.remuxer.start(),e.eventManager.trigger("DOWNLOADER_CHUNK_READY",{chunkSize:t.chunkSize,networkDuration:t.networkDuration})})),this.downloader.on("EOF",(function(){e.buffer.eof=!0})),this.downloader.on("ERROR",(function(t){e.eventManager.trigger("DOWNLOADER_ERROR",t)}))}},{key:"loadFromLocal",value:(o=i()(g.a.mark((function e(t){var r,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ut.check(t);case 2:if(!(r=e.sent)){e.next=8;break}return e.next=6,Ut.export(t);case 6:n=e.sent,this.loadFromBuffer(n);case 8:return e.abrupt("return",!!r);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"loadFromBuffer",value:function(e){this.release(),this.demuxer.inputBuffer({chunkOffset:0,data:e}),this.remuxer.start(),this.eventManager.trigger("loadstart",{target:this.el,type:"loadstart"})}},{key:"saveToLocal",value:(n=i()(g.a.mark((function e(t,r){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ut.save(t,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})},{key:"exportFromLocal",value:(r=i()(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ut.export(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"load",value:(t=i()(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.downloader){e.next=2;break}return e.abrupt("return");case 2:if(this.downloader.url!=t){e.next=4;break}return e.abrupt("return");case 4:this.release(),this.downloader.url=t,this.eventManager.trigger("loadstart",{target:this.el,type:"loadstart"}),this.downloader.start();case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"pause",value:function(){this.mse.stop()}},{key:"seek",value:function(e){if(this.demuxer.moovReady){this.element.currentTime=e,this.remuxer.pause();var t=this.buffer.checkAvailable(e);if(!t.isEnough){e=t.requestTime,this.pause(),this.downloader.pause(),this.mse.clearPendingBuffers();var r=this.conf.getDataOffsetWithTime(e);r=this.memory.findNextBufferEndPos(r),this.downloader.resume(r)}}}},{key:"release",value:function(){l()(y()(u.prototype),"release",this).call(this),this.downloader.release(),this.demuxer.release(),this.remuxer.release(),this.mse.release(),this.conf.release(),this.memory.release(),this.buffer.release()}},{key:"metaChunkSize",set:function(e){this.downloader.initChunkSize=e}},{key:"dataChunkSize",set:function(e){this.downloader.commonChunkSize=e}},{key:"bufferEnoughTime",set:function(e){this.buffer.enoughTime=e}},{key:"element",get:function(){return this.el}},{key:"data",get:function(){return this.memory.buffer}}]),u}(R);Nt.storage=Ut;var Ft=Nt,Gt=[];var Jt=function(e){h()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var i=y()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return d()(this,r)}}(r);function r(e){var n;return s()(this,r),(n=t.call(this,"Basic",e,Gt))._initEvents(),n}return c()(r,[{key:"_initEvents",value:function(){l()(y()(r.prototype),"_initEvents",this).call(this)}}]),r}(R)}])},62742:e=>{"use strict";e.exports=JSON.parse('{"name":"af","months":["Januarie","Februarie","Maart","April","Mei","Junie","Julie","Augustus","September","Oktober","November","Desember"],"monthsShort":["Jan","Feb","Mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Des"],"weekdays":["Sondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrydag","Saterdag"],"weekdaysShort":["So","Ma","Di","Wo","Do","Vr","Sa"],"weekdaysMin":["So","Ma","Di","Wo","Do","Vr","Sa"],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"YYYY-MM-DD","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"YYYY-M-D","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"vm.","pm":"nm.","AM":"vm.","PM":"nm."}}')},10069:e=>{"use strict";e.exports=JSON.parse('{"name":"ar","months":["","","","","","","","","","","",""],"monthsShort":["","","","","","","","","","","",""],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"","pm":"","AM":"","PM":""}}')},66096:e=>{"use strict";e.exports=JSON.parse('{"name":"bn","months":["","","","","","","","","","","",""],"monthsShort":["","","","","","","","","","","",""],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},88:e=>{"use strict";e.exports=JSON.parse('{"name":"cs","months":["Leden","nor","Bezen","Duben","Kvten","erven","ervenec","Srpen","Z","jen","Listopad","Prosinec"],"monthsShort":["Leden","nor","Bezen","Duben","Kvten","erven","ervenec","Srpen","Z","jen","Listopad","Prosinec"],"weekdays":["Nedle","Pondl","ter","Steda","tvrtek","Ptek","Sobota"],"weekdaysShort":["ne","po","t","st","t","p","so"],"weekdaysMin":["Ne","Po","t","St","t","P","So"],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"D.M.YYYY","LL":"D. MMMM YYYY","LLL":"D. MMMM YYYY HH:mm","LLLL":"D. MMMM YYYY HH:mm","l":"D.M.YYYY","ll":"D. MMM YYYY","lll":"D. MMM YYYY h:mm A","llll":"D. MMM YYYY h:mm A","LL-Y":"D. MMMM"},"meridiem":{"am":"dop.","pm":"odp.","AM":"dop.","PM":"odp."}}')},87274:e=>{"use strict";e.exports=JSON.parse('{"name":"de","months":["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],"monthsShort":["Jan.","Feb.","Mrz","Apr.","Mai","Juni","Juli","Aug.","Sept.","Okt.","Nov.","Dez."],"weekdays":["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],"weekdaysShort":["So","Mo","Di","Mi","Do","Fr","Sa"],"weekdaysMin":["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],"longDateFormat":{"LT":"HH:mm","LTS":"HH:mm:ss","L":"DD.MM.YYYY","LL":"D. MMMM YYYY","LLL":"D. MMMM YYYY HH:mm","LLLL":"dddd, D. MMMM YYYY HH:mm","l":"D.M.YYYY","ll":"D. MMM YYYY","lll":"D. MMM YYYY HH:mm","llll":"ddd, D. MMM YYYY HH:mm","LL-Y":"D. MMMM"}}')},5573:e=>{"use strict";e.exports=JSON.parse('{"name":"el","months":["","","","","","","","","","","",""],"monthsShort":[".",".",".",".","",".",".",".",".",".",".","."],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":[".",".",".",".",".",".","."],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"D/M/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"","pm":"","AM":"","PM":""}}')},20351:e=>{"use strict";e.exports=JSON.parse('{"name":"en","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"monthsShort":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"weekdaysShort":["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"],"weekdaysMin":["Su","Mo","Tu","We","Th","Fr","Sa"],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"MM/DD/YYYY","LL":"MMMM D, YYYY","LLL":"MMMM D, YYYY HH:mm","LLLL":"dddd MMMM D, YYYY HH:mm","l":"M/D/YYYY","ll":"MMM D, YYYY","lll":"MMM D, YYYY h:mm A","llll":"ddd MMM D, YYYY h:mm A","LL-Y":"MMMM D"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},12382:e=>{"use strict";e.exports=JSON.parse('{"name":"es","months":["Enero","Febrero","Marzo","Abril","May","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],"monthsShort":["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],"weekdays":["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado"],"weekdaysShort":["Dom","Lun","Mar","Mi","Jue","Vie","Sb"],"weekdaysMin":["D","L","M","X","J","V","S"],"longDateFormat":{"LT":"HH:mm","LTS":"HH:mm:ss","L":"DD/MM/YYYY","LL":"D [de] MMMM [de] YYYY","LLL":"D [de] MMMM [de] YYYY HH:mm","LLLL":"dddd, D [de] MMMM [de] YYYY HH:mm","l":"D/M/YYYY","ll":"D [de] MMM [de] YYYY","lll":"D [de] MMM [de] YYYY HH:mm","llll":"ddd, D [de] MMM [de] YYYY HH:mm","LL-Y":"D [de] MMMM"}}')},3406:e=>{"use strict";e.exports=JSON.parse('{"name":"fi","months":["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Touko","Keskuu","Heinkuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],"monthsShort":["Tammi","Helmi","Maalis","Huhti","Toukokuu","Kes","Hein","Elo","Syys","Loka","Marras","Joulu"],"weekdays":["Sunnuntai","Maanantai","Tiistai","Keskiviikko","Torstai","Perjantai","Lauantai"],"weekdaysShort":["su","ma","ti","ke","to","pe","la"],"weekdaysMin":["Su","Ma","Ti","Ke","To","Pe","La"],"longDateFormat":{"LT":"HH:mm","LTS":"HH:mm:ss","L":"D.M.YYYY","LL":"D. MMMM YYYY","LLL":"D. MMMM YYYY HH:mm","LLLL":"D. MMMM YYYY HH:mm","l":"D.M.YYYY","ll":"D. MMM YYYY","lll":"D. MMM YYYY HH:mm","llll":"D. MMM YYYY HH:mm","LL-Y":"D. MMMM"}}')},53685:e=>{"use strict";e.exports=JSON.parse('{"name":"fil","months":["Enero","Pebrero","Marso","Abril","Mayo","Hunyo","Hulyo","Agosto","Setyembre","Oktubre","Nobyembre","Disyembre"],"monthsShort":["Enero","Peb","Marso","Abril","Mayo","Hunyo","Hulyo","Agosto","Set","Okt","Nob","Dis"],"weekdays":["Linggo","Lunes","Martes","Miyerkules","Huwebes","Biyernes","Sabado"],"weekdaysShort":["Linggo","Lunes","Martes","Miyerkules","Huwebes","Biyernes","Sabado"],"weekdaysMin":["Li","Lu","Ma","Mi","Hu","Bi","Sa"],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},20490:e=>{"use strict";e.exports=JSON.parse('{"name":"fr","months":["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],"monthsShort":["Jan","Fv","Mar","Avr","Mai","Juin","Jui","Aot","Sep","Oct","Nov","Dc"],"weekdays":["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],"weekdaysShort":["dim","lun","mar","mer","jeu","ven","sam"],"weekdaysMin":["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],"longDateFormat":{"LT":"HH:mm","LTS":"HH:mm:ss","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY HH:mm","llll":"ddd, D MMM YYYY HH:mm","LL-Y":"D MMMM"}}')},40618:e=>{"use strict";e.exports=JSON.parse('{"name":"gu","months":["","","","","","","","","","","",""],"monthsShort":["","","","","","","","","","","",""],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},12347:e=>{"use strict";e.exports=JSON.parse('{"name":"he","months":["","","","","","","","","","","",""],"monthsShort":["","\'","","","","","","\'","\'","\'","\'","\'"],"weekdays":[" "," "," "," "," "," ",""],"weekdaysShort":[" "," "," "," "," "," ",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"HH:mm","LTS":"HH:mm:ss","L":"DD/MM/YYYY","LL":"D []MMMM YYYY","LLL":"D []MMMM YYYY HH:mm","LLLL":"dddd, D []MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY HH:mm","llll":"ddd, D MMM YYYY HH:mm","LL-Y":"D []MMMM"},"meridiem":{"am":"","pm":"","AM":"","PM":""}}')},27590:e=>{"use strict";e.exports=JSON.parse('{"name":"hi","months":["","","","","","","","","","","",""],"monthsShort":["","","","","","","","","","","",""],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},79396:e=>{"use strict";e.exports=JSON.parse('{"name":"hu","months":["Janur","Februr","Mrcius","prilis","Mj","Jnius","Jlius","Augusztus","Szeptember","Oktber","November","December"],"monthsShort":["Jan","Feb","Mr","pr","Mj","Jn","Jl","Aug","Szep","Okt","Nov","Dec"],"weekdays":["Vasrnap","Htf","Kedd","Szerda","Cstrtk","Pntek","Szombat"],"weekdaysShort":["V","H","K","Sze","Cs","P","Szo"],"weekdaysMin":["Va","H","Ke","Sze","Cs","P","Szo"],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"YYYY. MM. DD.","LL":"YYYY. MMMM D.","LLL":"YYYY. MMMM D. HH:mm","LLLL":"YYYY. MMMM D. HH:mm","l":"YYYY.M.D","ll":"YYYY. MMM D.","lll":"YYYY. MMM D. h:mm A","llll":"YYYY. MMM D. h:mm A","LL-Y":"MMMM D."},"meridiem":{"am":"de.","pm":"du.","AM":"DE.","PM":"DU."}}')},87310:e=>{"use strict";e.exports=JSON.parse('{"name":"id","months":["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],"monthsShort":["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],"weekdays":["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],"weekdaysShort":["Min","Sen","Sel","Rab","Kam","Jum","Sab"],"weekdaysMin":["Mi","Sn","Sl","Rb","Km","Ju","Sb"],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},36281:e=>{"use strict";e.exports=JSON.parse('{"name":"it","months":["Gennaio","Febbraio","Marzo","Aprile","Mag","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],"monthsShort":["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],"weekdays":["Domenica","Luned","Marted","Mercoled","Gioved","Venerd","Sabato"],"weekdaysShort":["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],"weekdaysMin":["Do","Lu","Ma","Me","Gi","Ve","Sa"],"longDateFormat":{"LT":"HH:mm","LTS":"HH:mm:ss","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY HH:mm","llll":"ddd D MMM YYYY HH:mm","LL-Y":"D MMMM"}}')},93595:e=>{"use strict";e.exports=JSON.parse('{"name":"ja","months":["1","2","3","4","5","6","7","8","9","10","11","12"],"monthsShort":["1","2","3","4","5","6","7","8","9","10","11","12"],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"YYYY/MM/DD","LL":"YYYY [] M [] D []","LLL":"YYYY [] M [] D [] HH:mm","LLLL":"YYYY [] M [] D [] HH:mm","l":"YYYY/M/D","ll":"YYYY [] M []D []","lll":"YYYY [] M []D [] h:mm A","llll":"YYYY [] M []D [] h:mm A","LL-Y":"M [] D []"},"meridiem":{"am":"","pm":"","AM":"","PM":""}}')},27549:e=>{"use strict";e.exports=JSON.parse('{"name":"jv","months":["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],"monthsShort":["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],"weekdays":["Minggu","Senen","Selasa","Rebo","Kemis","Jemuwah","Setu"],"weekdaysShort":["Ming","Sen","Sel","Reb","Kem","Jem","Set"],"weekdaysMin":["Min","Sen","Sel","Re","Ke","Je","Se"],"longDateFormat":{"LT":"HH.mm","LTS":"HH.mm.ss","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY [pukul] HH.mm","LLLL":"dddd, D MMMM YYYY [pukul] HH.mm","LL-Y":"D MMMM"}}')},43106:e=>{"use strict";e.exports=JSON.parse('{"name":"kn","months":["","","","","","","","","","","",""],"monthsShort":["","","","","","","","","","","",""],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},68979:e=>{"use strict";e.exports=JSON.parse('{"name":"ko","months":["1","2","3","4","5","6","7","8","9","10","11","12"],"monthsShort":["1","2","3","4","5","6","7","8","9","10","11","12"],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"YYYY-MM-DD","LL":"YYYY[] M[] D[]","LLL":"YYYY [] M[] D[] HH:mm","LLLL":"YYYY[] M[] D[] dddd HH:mm","l":"YYYY-M-D","ll":"YYYY[] M[] D[]","lll":"YYYY[] M[] D[] h:mm A","llll":"YYYY[] M[] D[] ddd h:mm A","LL-Y":"M[] D[]"},"meridiem":{"am":"","pm":"","AM":"","PM":""}}')},3421:e=>{"use strict";e.exports=JSON.parse('{"name":"ml","months":["","","","","","","","","","","",""],"monthsShort":["","","","","","","","","","","",""],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},47631:e=>{"use strict";e.exports=JSON.parse('{"name":"mr","months":["","","","","","","","","","","",""],"monthsShort":["","","","","","","","","","","",""],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},64879:e=>{"use strict";e.exports=JSON.parse('{"name":"my","months":["","","","","","","","","","","",""],"monthsShort":["","","","","","","","","","","",""],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},62183:e=>{"use strict";e.exports=JSON.parse('{"name":"nl","months":["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],"monthsShort":["Jan","Feb","Mrt","Apr","Mei","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],"weekdays":["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag"],"weekdaysShort":["Zo","Ma","Di","Wo","Do","Vr","Za"],"weekdaysMin":["Zo","Ma","Di","Wo","Do","Vr","Za"],"longDateFormat":{"LT":"HH:mm","LTS":"HH:mm:ss","L":"D-M-YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd D MMMM YYYY HH:mm","l":"D-M-YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY HH:mm","llll":"ddd D MMM YYYY HH:mm","LL-Y":"D MMMM"}}')},53219:e=>{"use strict";e.exports=JSON.parse('{"name":"or","months":["","","","","","","","","","","",""],"monthsShort":["","","","","","","","","","","",""],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},49720:e=>{"use strict";e.exports=JSON.parse('{"name":"pa","months":["","","","","","","","","","","",""],"monthsShort":["","","","","","","","","","","",""],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"","pm":"","AM":"","PM":""}}')},41958:e=>{"use strict";e.exports=JSON.parse('{"name":"pl","months":["Stycze","Luty","Marzec","Kwiecie","Maj","Czerwiec","Lipiec","Sierpie","Wrzesie","Padziernik","Listopad","Grudzie"],"monthsShort":["Sty","Lut","Mar","Kwi","Maj","Cze","Lip","Sie","Wrz","Pa","Lis","Gru"],"weekdays":["Niedziela","Poniedziaek","Wtorek","roda","Czwartek","Pitek","Sobota"],"weekdaysShort":["niedz.","pon.","wt.","r.","czw.","pit.","sob."],"weekdaysMin":["Nied","Pon","Wt","r","Czw","Pi","Sob"],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"D-MM-YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"D MMMM YYYY HH:mm","l":"D.M.YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},37691:e=>{"use strict";e.exports=JSON.parse('{"name":"pt","months":["Janeiro","Fevereiro","Maro","Abril","Mai","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],"monthsShort":["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],"weekdays":["Domingo","Segunda-feira","Tera-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sbado"],"weekdaysShort":["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],"weekdaysMin":["Dom.","Seg.","Ter.","Qua.","Qui.","Sex.","Sb."],"longDateFormat":{"LT":"HH:mm","LTS":"HH:mm:ss","L":"DD-MM-YYYY","LL":"D [de] MMMM [de] YYYY","LLL":"D [de] MMMM [de] YYYY HH:mm","LLLL":"dddd, D [de] MMMM [de] YYYY HH:mm","l":"D-M-YYYY","ll":"D [de] MMM [de] YYYY","lll":"D [de] MMM [de] YYYY HH:mm","llll":"ddd, D [de] MMM [de] YYYY HH:mm","LL-Y":"D [de] MMMM"}}')},19395:e=>{"use strict";e.exports=JSON.parse('{"name":"ro","months":["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],"monthsShort":["Ian","Feb","Mar","Apr","Mai","Iun","Iul","Aug","Sep","Oct","Noi","Dec"],"weekdays":["Duminic","Luni","Mari","Miercuri","Joi","Vineri","Smbt"],"weekdaysShort":["Dum","Lu","Ma","Mi","Joi","Vi","Sm"],"weekdaysMin":["Du","Lu","Ma","Mi","Jo","Vi","S"],"longDateFormat":{"LT":"HH:mm","LTS":"HH:mm:ss","L":"DD.MM.YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"D MMMM YYYY HH:mm","l":"D.M.YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY HH:mm","llll":"D MMM YYYY HH:mm","LL-Y":"D MMMM"}}')},40802:e=>{"use strict";e.exports=JSON.parse('{"name":"ru","months":["","","","","","","","","","","",""],"monthsShort":["","","","","","","","","","","",""],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"HH:mm","LTS":"HH:mm:ss","L":"DD.MM.YYYY","LL":"D MMMM YYYY [.]","LLL":"D MMMM YYYY [.] HH:mm","LLLL":"D MMMM YYYY [.] HH:mm","l":"D.M.YYYY","ll":"D MMM YYYY [.]","lll":"D MMM YYYY [.] HH:mm","llll":"D MMM YYYY [.] HH:mm","LL-Y":"D MMMM"}}')},63540:e=>{"use strict";e.exports=JSON.parse('{"name":"sv","months":["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],"monthsShort":["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],"weekdays":["Sndag","mndag","Tisdag","Onsdag","Torsdag","Fredag","Lrdag"],"weekdaysShort":["sn","mn","tis","ons","tor","fre","lr"],"weekdaysMin":["Sn","Mn","Tis","Ons","Tors","Fre","Lr"],"longDateFormat":{"LT":"HH:mm","LTS":"HH:mm:ss","L":"YYYY-MM-DD","LL":"[den] D MMMM YYYY","LLL":"[den] D MMMM YYYY HH:mm","LLLL":"[den] D MMMM YYYY HH:mm","l":"YYYY-M-D","ll":"[den] D MMM YYYY","lll":"[den] D MMM YYYY HH:mm","llll":"[den] D MMM YYYY HH:mm","LL-Y":"[den] D MMMM"}}')},93106:e=>{"use strict";e.exports=JSON.parse('{"name":"sw","months":["Januari","Februari","Machi","Aprili","Mei","Juni","Julai","Agosti","Septemba","Oktoba","Novemba","Desemba"],"monthsShort":["Jan","Feb","Machi","Apr","Mei","Juni","Jul","Ago","Sep","Okt","Nov","Des"],"weekdays":["Jumapili","Jumatatu","Jumanne","Jumatano","Alhamisi","Ijumaa","Jumamosi"],"weekdaysShort":["Jumapili","Jumatatu","Jumanne","Jumatano","Alhamisi","Ijumaa","Jumamosi"],"weekdaysMin":["Jpl","Jtt","Jnn","Jtn","Alh","Ijm","Jms"],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},19041:e=>{"use strict";e.exports=JSON.parse('{"name":"ta","months":["","","","","","","","","","","",""],"monthsShort":["","","","","","","","","","","",""],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},29735:e=>{"use strict";e.exports=JSON.parse('{"name":"ro","months":["","","","","","","","","","","",""],"monthsShort":["","","","","","","","","","","",""],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":[".",".",".",".",".",".","."],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"ddd, D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},7597:e=>{"use strict";e.exports=JSON.parse('{"name":"th","months":["","","","","..","","","","","","",""],"monthsShort":["..","..","..","..","..","..","..","..","..","..","..",".."],"weekdays":["","","","","","",""],"weekdaysShort":[".",".",".",".",".",".","."],"weekdaysMin":[".",".",".",".",".",".","."],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"D/M/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},99034:e=>{"use strict";e.exports=JSON.parse('{"name":"tr","months":["Ocak","ubat","Mart","Nisan","May","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],"monthsShort":["Oca","ub","Mar","Nis","May","Haz","Tem","Au","Eyl","Eki","Kas","Ara"],"weekdays":["Pazar","Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi"],"weekdaysShort":["Pzr","Pzt","Sal","r","Pr","Cum","Cts"],"weekdaysMin":["Pz","Pt","Sa","a","Pe","Cu","Ct"],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD.MM.YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"D MMMM YYYY dddd HH:mm","l":"D.M.YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"","pm":"s","AM":"","PM":"S"}}')},39986:e=>{"use strict";e.exports=JSON.parse('{"name":"uk","months":["","","","",".","","","","","","",""],"monthsShort":[".",".",".",".","",".",".",".",".",".",".","."],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"HH:mm","LTS":"HH:mm:ss","L":"DD.MM.YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"dddd, D MMMM YYYY HH:mm","l":"D.M.YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY HH:mm","llll":"ddd, D MMM YYYY HH:mm","LL-Y":"D MMMM"}}')},53126:e=>{"use strict";e.exports=JSON.parse('{"name":"vi","months":["Thng Mt","Thng Hai","Thng Ba","Thng T","Thng 5","Thng Su","Thng By","Thng Tm","Thng Chn","Thng Mi","Thng Mi Mt","Thng Mi Hai"],"monthsShort":["Thng 1","Thng 2","Thng 3","Thng 4","Thng 5","Thng 6","Thng 7","Thng 8","Thng 9","Thng 10","Thng 11","Thng 12"],"weekdays":["Ch Nht","Th Hai","Th Ba","Th T","Th Nm","Th Su","Th By"],"weekdaysShort":["CN","T2","T3","T4","T5","T6","T7"],"weekdaysMin":["CN","T2","T3","T4","T5","T6","T7"],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"DD/MM/YYYY","LL":"D MMMM YYYY","LLL":"D MMMM YYYY HH:mm","LLLL":"D MMMM YYYY HH:mm","l":"D/M/YYYY","ll":"D MMM YYYY","lll":"D MMM YYYY h:mm A","llll":"D MMM YYYY h:mm A","LL-Y":"D MMMM"},"meridiem":{"am":"am","pm":"pm","AM":"AM","PM":"PM"}}')},72016:e=>{"use strict";e.exports=JSON.parse('{"name":"zh-Hant","months":["","","","","","","","","","","",""],"monthsShort":["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],"weekdays":["","","","","","",""],"weekdaysShort":["","","","","","",""],"weekdaysMin":["","","","","","",""],"longDateFormat":{"LT":"h:mm A","LTS":"h:mm:ss A","L":"YYYY-M-D","LL":"YYYY [] M [] D []","LLL":"YYYY [] M [] D [] HH:mm","LLLL":"YYYY [] M [] D [] HH:mm","l":"YYYY-M-D","ll":"YYYY [] M [] D []","lll":"YYYY [] M [] D [] h:mm A","llll":"YYYY [] M [] D [] ddd h:mm A","LL-Y":"M [] D []"},"meridiem":{"am":"","pm":"","AM":"","PM":""}}')}}]);